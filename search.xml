<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>LaTeX语法</title>
      <link href="/2024/06/21/LaTeX.html"/>
      <url>/2024/06/21/LaTeX.html</url>
      
        <content type="html"><![CDATA[<h3 id="butterfly主题配置katex">Butterfly主题配置KaTeX</h3><p>参考<a href="https://butterfly.js.org/posts/ceeb73f/">Butterfly 安裝文檔(四) 主題配置-2 | Butterfly</a></p><p>在配置过程中可能出现一些问题，比如正确配置了KaTeX却没有在正确显示公式。比如配置了<code>per_page: true</code>却似乎没有，即便手动为md文件元数据添加<code>katex: true</code>也没用。奇怪的是，当我为用到数学公式的md文件添加<code>mathjax: true</code>后，使用<code>hexo cl, hexo g, hexo s</code>一套命令，公式未渲染时，我再将最新md文件中的这部分<code>mathjax: true</code>变为<code>katex: true</code>，其它用到数学公式的md文件中这部分则删除，重新执行一套命令，竟然公式生效了。</p><p>猜测是需要一个<code>mathjax: true</code>变为<code>katex: true</code>的过程，才能使得 KaTeX 配置生效。</p><p>现有两个 md 文件，分别记作AB，A是最新的 md 文件， B是第二个 md 文件。关于<code>katex: true</code>的生效条件，下面分别测试了几种渲染情况。</p><p>butterfly配置文件选项：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">katex:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hide_scrollbar:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><ol><li>AB都没有，AB都渲染失败</li><li>A有B没有，AB都成功渲染</li><li>A没有B有，AB都渲染失败</li><li>AB都有，但AB都渲染失败</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">katex:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">hide_scrollbar:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><ol><li>AB都没有，？</li><li>A有B没有，AB都渲染失败</li><li>A没有B有，AB都渲染失败</li><li>AB都有，但AB都渲染失败</li></ol><h3 id="分数">分数</h3><p>frac ：fraction，分数。</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\frac</span>&#123;son&#125;&#123;mother&#125;</span><br></pre></td></tr></table></figure><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>s</mi><mi>o</mi><mi>n</mi></mrow><mrow><mi>m</mi><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{son}{mother}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">so</span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h3 id="偏导">偏导</h3><p>partial ：偏爱的。</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span> f&#125;&#123;<span class="keyword">\partial</span> x&#125;</span><br></pre></td></tr></table></figure><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h3 id="向量">向量</h3><p>vec ：vector，向量。</p><p>overrightarrow：上方右箭头。</p><p>overleftarrow：上方左箭头。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mspace width="1em"/><mover accent="true"><mi>x</mi><mo stretchy="true">→</mo></mover><mspace width="1em"/><mover accent="true"><mi>y</mi><mo stretchy="true">←</mo></mover></mrow><annotation encoding="application/x-tex">\vec x \quad \overrightarrow x \quad \overleftarrow y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.147em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9526em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span class="svg-align" style="top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9526em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span class="svg-align" style="top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span></p><h3 id="点乘">点乘</h3><p>cdot：circle dot，圆点。</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\vec</span> x <span class="keyword">\cdot</span> <span class="keyword">\vec</span> y</span><br></pre></td></tr></table></figure><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>y</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec x \cdot \vec y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9084em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1799em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> latex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器学习</title>
      <link href="/2024/06/21/MachineLearning.html"/>
      <url>/2024/06/21/MachineLearning.html</url>
      
        <content type="html"><![CDATA[<h3 id="机器学习分类">机器学习分类</h3><p>机器学习分为监督学习和非监督学习。</p><p>监督学习：输入数据得到“正确的”输出，输入与输出是映射关系。回归算法（Regression），比如用线性回归来预测房价；分类算法（Classification），比如输入肿瘤信息将其分类为良性、恶性等类别。</p><p>非监督学习：输入数据得到的输出没有“正确”的概念，常用于寻找数据中的结构。聚类算法（Clustering），将相似的数据归类在一起；异常检测（Anomaly Detection），找出不寻常的数据；降维（Dimensionality Reduction），将大数据集压缩成小数据集并尽可能减少信息丢失。</p><h3 id="线性回归">线性回归</h3><p>x -&gt; f -&gt; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 。</p><ul><li>x 是输入变量（input variable），又称特征（feature）。</li><li>y 是输出变量（output variable），又称目标变量（target variable），是训练集（training set）中的实际真实值。</li><li>m 是训练样本数，数据集的大小。number of training examples。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 是模型（model）预测值</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi><mspace width="1em"/><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="1em"/><mi>e</mi><mi>x</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><mspace width="1em"/><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="1em"/><mi>e</mi><mi>x</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">(x,y) = single \quad  training \quad example \\(x^{(i)},y^{(i)}) = i^{th} \quad training \quad example</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">ainin</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">ainin</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span></span></span></span></span></p><p>通过训练集训练模型（model），然后给模型输入x，模型输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 作为预测值。</p><h4 id="单输入线性回归-linear-regression-with-one-variable">单输入线性回归（Linear regression with one variable）</h4><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi><mo>:</mo><msub><mi>f</mi><mrow><mi>w</mi><mo separator="true">,</mo><mi>b</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">model : f_{w,b}(x) = wx + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>​</p><p>w 代表权重（weight），b 代表基础值（base value）。</p><h5 id="代价函数">代价函数</h5><p>Cost function : Squared error cost function.</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy="false">(</mo><msub><mi>f</mi><mrow><mi>w</mi><mo separator="true">,</mo><mi>b</mi></mrow></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">J(w,b) = \frac{1}{2m} \sum\limits_{i=1}^{m}(\hat{y}^{(i)} - y^{(i)})^2 = \frac1{2m} \sum\limits_{i=1}^m(f_{w,b}(x^{(i)}) - y^{(i)})^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3291em;vertical-align:-0.9777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3291em;vertical-align:-0.9777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p><p>训练集的代价越小，模型越符合预期。代价函数中的 2 是为了梯度下降中求偏导时使公式更加简洁，因为 J 求偏导时外函数的导数会产生乘 2 ，正好抵消。</p><h5 id="梯度下降-gradient-descent-algorithm">梯度下降（Gradient descent algorithm）</h5><p>用于最小化代价函数的一种算法。参考<a href="https://www.bilibili.com/video/BV19f421Q7CL/?spm_id_from=333.337.search-card.all.click&amp;vd_source=c1d0ac10ebe4bb4e8cf6648904e6ed40">不至于吧，梯度下降简单得有点离谱了啊</a>。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>w</mi><mo>=</mo><mi>w</mi><mo>−</mo><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>b</mi><mo>=</mo><mi>b</mi><mo>−</mo><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w = w - \alpha \frac{\partial}{\partial w} J(w,b) \\b = b - \alpha \frac{\partial}{\partial b} J(w,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">b</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p><p>其中，α 代表学习率，用于控制步长，防止步长过大导致 J 在最小值附近反复横跳而无法收敛。因此学习率的合适取值很重要。</p><p>偏导则作为方向以及基本步长。梯度是偏导数构成的向量。</p><h4 id="多元线性回归-multiple-linear-regression">多元线性回归（Multiple linear regression）</h4><p>注：不是多元回归（Multivariate regression）。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub><mo>=</mo><msup><mi>j</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mspace linebreak="newline"></mspace><mi>n</mi><mo>=</mo><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mspace width="1em"/><mi>o</mi><mi>f</mi><mspace width="1em"/><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi><mspace linebreak="newline"></mspace><msup><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>s</mi><mspace width="1em"/><mi>o</mi><mi>f</mi><mspace width="1em"/><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><mspace width="1em"/><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="1em"/><mi>e</mi><mi>x</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mspace linebreak="newline"></mspace><msubsup><mi>x</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mspace width="1em"/><mi>o</mi><mi>f</mi><mspace width="1em"/><mi>f</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mspace width="1em"/><mi>j</mi><mspace width="1em"/><mi>i</mi><mi>n</mi><mspace width="1em"/><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><mspace width="1em"/><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="1em"/><mi>e</mi><mi>x</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">x_j = j^{th}feature \\n = number \quad of \quad features \\\vec x^{(i)} = features \quad of \quad i^{th} \quad training \quad example \\x^{(i)}_j = value \quad of \quad feature \quad j \quad in \quad i^{th} \quad training \quad example</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">mb</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">res</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.938em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">res</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">ainin</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">ainin</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span></span></span></span></span></p><p>现引入多个特征值x，每个x的下标不同。每个特征值都有对应的权重。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>f</mi><mrow><mover accent="true"><mi>w</mi><mo>⃗</mo></mover><mo separator="true">,</mo><mi>b</mi></mrow></msub><mo stretchy="false">(</mo><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo stretchy="false">)</mo><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>w</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><mi>b</mi><mo>=</mo><mover accent="true"><mi>w</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>+</mo><mi>b</mi><mspace linebreak="newline"></mspace><mover accent="true"><mi>w</mi><mo>⃗</mo></mover><mo>=</mo><mo stretchy="false">[</mo><msub><mi>w</mi><mn>1</mn></msub><mspace width="1em"/><msub><mi>w</mi><mn>2</mn></msub><mspace width="1em"/><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mspace width="1em"/><msub><mi>w</mi><mi>n</mi></msub><mo stretchy="false">]</mo><mspace linebreak="newline"></mspace><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mspace width="1em"/><msub><mi>x</mi><mn>2</mn></msub><mspace width="1em"/><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mspace width="1em"/><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f_{\vec w,b}(\vec x) = w_1x_1 + w_2x_2 + ... + w_nx_n + b = \vec w \cdot \vec x + b \\\vec w = [w_1 \quad w_2 \quad ... \quad w_n] \\\vec x = [x_1 \quad x_2 \quad ... \quad x_n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0411em;vertical-align:-0.2911em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.545em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-2.714em;"><span class="pstrut" style="height:2.714em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span><span style="top:-2.714em;"><span class="pstrut" style="height:2.714em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay mtight" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2911em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7973em;vertical-align:-0.0833em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MachineLeaning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Anaconda</title>
      <link href="/2024/06/05/Anaconda.html"/>
      <url>/2024/06/05/Anaconda.html</url>
      
        <content type="html"><![CDATA[<h3 id="删除conda源">删除conda源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --remove-key channels</span><br></pre></td></tr></table></figure><h3 id="conda配置">conda配置</h3><p><a href="https://mirrors4.tuna.tsinghua.edu.cn/help/anaconda/">anaconda | 镜像站使用帮助 | 清华大学开源软件镜像站</a></p><p>修改<code>C:\Users\用户名\.condarc</code>文件内容为下面内容。其中envs_dirs是指定conda环境的安装位置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">channels:</span><br><span class="line">  - defaults</span><br><span class="line">show_channel_urls: <span class="literal">true</span></span><br><span class="line">default_channels:</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2</span><br><span class="line">custom_channels:</span><br><span class="line">  conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  pytorch-lts: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">  deepmodeling: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/</span><br><span class="line">envs_dirs:</span><br><span class="line">  - D://Anaconda//envs</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>通过<code>conda info</code>查看conda信息。看到D:\Anaconda\envs在envs directories的第一位，就代表虚拟环境默认安装位置设置好了。通过channel URLs也可以看见清华镜像源也设置好了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">(adong) PS C:\WINDOWS\system32&gt; conda info</span><br><span class="line"></span><br><span class="line">     active environment : adong</span><br><span class="line">    active <span class="built_in">env</span> location : D:\Anaconda\envs\adong</span><br><span class="line">            shell level : 2</span><br><span class="line">       user config file : C:\Users\91430\.condarc</span><br><span class="line"> populated config files : C:\Users\91430\.condarc</span><br><span class="line">          conda version : 24.1.2</span><br><span class="line">    conda-build version : 24.1.2</span><br><span class="line">         python version : 3.11.7.final.0</span><br><span class="line">                 solver : libmamba (default)</span><br><span class="line">       virtual packages : __archspec=1=x86_64</span><br><span class="line">                          __conda=24.1.2=0</span><br><span class="line">                          __cuda=12.3=0</span><br><span class="line">                          __win=0=0</span><br><span class="line">       base environment : D:\Anaconda  (writable)</span><br><span class="line">      conda av data <span class="built_in">dir</span> : D:\Anaconda\etc\conda</span><br><span class="line">  conda av metadata url : None</span><br><span class="line">           channel URLs : https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/win-64</span><br><span class="line">                          https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/noarch</span><br><span class="line">                          https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r/win-64</span><br><span class="line">                          https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r/noarch</span><br><span class="line">                          https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2/win-64</span><br><span class="line">                          https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2/noarch</span><br><span class="line">          package cache : D:\Anaconda\pkgs</span><br><span class="line">                          C:\Users\91430\.conda\pkgs</span><br><span class="line">                          C:\Users\91430\AppData\Local\conda\conda\pkgs</span><br><span class="line">       envs directories : D:\Anaconda\envs</span><br><span class="line">                          C:\Users\91430\.conda\envs</span><br><span class="line">                          C:\Users\91430\AppData\Local\conda\conda\envs</span><br><span class="line">               platform : win-64</span><br><span class="line">             user-agent : conda/24.1.2 requests/2.31.0 CPython/3.11.7 Windows/10 Windows/10.0.22000 solver/libmamba conda-libmamba-solver/24.1.0 libmambapy/1.5.6 aau/0.4.3 c/2cby9s0faIgGPUHiAZNUZA s/l8VpJfZM5eNDkpX7Ia9NMQ e/678Mj-yGtTUNyUgyuxwmKw</span><br><span class="line">          administrator : True</span><br><span class="line">             netrc file : None</span><br><span class="line">           offline mode : False</span><br></pre></td></tr></table></figure><h3 id="吴恩达机器学习optional-labs环境配置">吴恩达机器学习Optional Labs环境配置</h3><p>采用的是JupyterNotebook、JupyterLab，以及lab的一些插件。</p><p>由于安装的anaconda的base环境自带一套Jupyter，在Jupyter以及lab插件的版本上，或许存在兼容问题，比如我在base环境下查看拓展。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(base) C:\Users\91430&gt;jupyter labextension list</span><br><span class="line">JupyterLab v4.0.13</span><br><span class="line">D:\Anaconda\share\jupyter\labextensions</span><br><span class="line">        jupyter-matplotlib v0.11.4 enabled ok</span><br><span class="line">        jupyterlab-plotly v5.15.0 enabled  X</span><br><span class="line">        @jupyter-notebook/lab-extension v7.0.8 enabled ok</span><br><span class="line">        @jupyter-widgets/jupyterlab-manager v5.0.11 enabled ok (python, jupyterlab_widgets)</span><br><span class="line">        @lckr/jupyterlab_variableinspector v3.1.0 enabled ok (python, lckr_jupyterlab_variableinspector)</span><br><span class="line">        @pyviz/jupyterlab_pyviz v3.0.0 enabled ok</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   The following extensions are outdated:</span><br><span class="line">        jupyterlab-plotly</span><br><span class="line"></span><br><span class="line">   Consider checking <span class="keyword">if</span> an update is available <span class="keyword">for</span> these packages.</span><br></pre></td></tr></table></figure><p>可以看到 plotly 的版本是有问题的。刚安装anaconda的时候，Lab的版本和plotly的版本比现在还高，后来，我参考了<a href="https://github.com/jupyterlab/jupyterlab/issues/14590">这个Issue</a>，将 Lab 和 plotly 进行降级，期望能兼容，然而并没有，结果如上所示。</p><p>所以我新建了一个conda环境<code>conda create -n adong python=3.7</code>，其中n代表name，adong则是我取的环境名，后面可以接环境要安装的包，这里安装的python3.7。</p><p>安装完成后，通过<code>conda activate adong</code>切换到新环境，输入<code>conda install &quot;jupyterlab&gt;=3&quot; &quot;ipywidgets&gt;=7.6&quot;</code>安装 jupyterlab 和插件ipywidgets。此后，缺啥装啥就行了，通过<code>conda install xxx</code>进行安装即可。</p><p>有一些必要的，比如<code>numpy matplotlib ipympl</code>。安装完成后，在该环境下通过输入命令<code>jupyter notebook</code>，即可正常使用相关功能，效果如下所示。</p><p><img src="https://pics.kahvia.cn/img/jupyterlab%E5%B1%95%E7%A4%BA.gif" alt="效果展示"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Anaconda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSH连接问题</title>
      <link href="/2024/06/02/SshProblems.html"/>
      <url>/2024/06/02/SshProblems.html</url>
      
        <content type="html"><![CDATA[<h3 id="问题描述">问题描述</h3><p>不知从哪一天开始，xshell突然无法连接我的云服务器。在那一天之前，一切正常。</p><h3 id="故障原因">故障原因</h3><p>在参考其他人博客内容进行故障排错无果后，我突发奇想，将校园网换成热点试了一下，结果成功了。所以故障原因大概率是校园网。去网上搜了一下，可能是校园网设置了ssh拦截，所以校园网不管连接哪个服务器的22端口都不行。解决方法参考<a href="https://blog.csdn.net/Gaowumao/article/details/118272547">该博客文章</a>。</p><h3 id="解决方法">解决方法</h3><ol><li><code>vim /etc/ssh/sshd_config</code>打开配置修改页面</li><li>添加自定义端口<code>Port 1022</code></li><li><code>systemctl restart sshd</code>重启sshd服务(centos7写法)</li><li><code>firewall-cmd --zone=public --add-port=1022/tcp --permanent</code>为防火墙打开对应的端口（未开启防火墙则省略这一步）</li><li><code>firewall-cmd --reload</code>防火墙重新加载配置（未开启防火墙则省略这一步）</li><li><code>firewall-cmd --list-all</code>查看已开放端口列表（未开启防火墙则省略这一步），出现1022则成功</li><li>去服务器服务商设置安全策略（或者有的地方叫安全组），入口规则添加1022，即允许外部访问服务器1022端口</li></ol><p>这样一套小连招下来，我的Xshell就能通过1022端口正常连接服务器了。</p><h3 id="参考博客">参考博客</h3><p><a href="https://blog.csdn.net/qq_45782768/article/details/130174381">校园网SSH连接不上阿里云_校园网 用不了ssh-CSDN博客</a></p><p><a href="https://www.cnblogs.com/yizhipanghu/p/11171211.html">Centos7 防火墙开放端口，查看状态，查看开放端口 - 香菜哥哥 - 博客园 (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/Gaowumao/article/details/118272547">XShell 无法连接云服务器的那些坑_为什么连校园网无法用xshell-CSDN博客</a></p><p><a href="https://blog.csdn.net/qq_50956771/article/details/136628785?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-136628785-blog-118272547.235%5Ev43%5Epc_blog_bottom_relevance_base6&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">踩坑：xshell连接阿里云失败 “Could not connect to ‘xxxxxxxxx‘: Connection failed.“,校园网_could not connect to ‘116.63.168.95’ (port 2673): -CSDN博客</a></p>]]></content>
      
      
      <categories>
          
          <category> 小问题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssh centos7 xshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DaisyUI指南</title>
      <link href="/2024/04/19/DaisyUI.html"/>
      <url>/2024/04/19/DaisyUI.html</url>
      
        <content type="html"><![CDATA[<h3 id="主题切换">主题切换</h3><p>参考<a href="https://daisyui.com/components/theme-controller/">主题控制器</a>。以下甄选了几个好看的主题。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">import(&#x27;tailwindcss&#x27;).Config</span>&#125; */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">content</span>: [<span class="string">&quot;./src/**/*.&#123;html,js,vue&#125;&quot;</span>],</span><br><span class="line">  <span class="attr">theme</span>: &#123;</span><br><span class="line">    <span class="attr">extend</span>: &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="built_in">require</span>(<span class="string">&quot;daisyui&quot;</span>)],</span><br><span class="line">  <span class="attr">daisyui</span>: &#123;</span><br><span class="line">    <span class="attr">themes</span>: [</span><br><span class="line">      <span class="string">&quot;light&quot;</span>,</span><br><span class="line">      <span class="string">&quot;dark&quot;</span>,</span><br><span class="line">      <span class="string">&quot;halloween&quot;</span>,</span><br><span class="line">      <span class="string">&quot;garden&quot;</span>,</span><br><span class="line">      <span class="string">&quot;forest&quot;</span>,</span><br><span class="line">      <span class="string">&quot;lofi&quot;</span>,</span><br><span class="line">      <span class="string">&quot;pastel&quot;</span>,</span><br><span class="line">      <span class="string">&quot;fantasy&quot;</span>,</span><br><span class="line">      <span class="string">&quot;wireframe&quot;</span>,</span><br><span class="line">      <span class="string">&quot;dracula&quot;</span>,</span><br><span class="line">      <span class="string">&quot;cmyk&quot;</span>,</span><br><span class="line">      <span class="string">&quot;autumn&quot;</span>,</span><br><span class="line">    ], <span class="comment">// false: only light + dark | true: all themes | array: specific themes like this [&quot;light&quot;, &quot;dark&quot;, &quot;cupcake&quot;]</span></span><br><span class="line">    <span class="attr">darkTheme</span>: <span class="string">&quot;dark&quot;</span>, <span class="comment">// name of one of the included themes for dark mode</span></span><br><span class="line">    <span class="attr">base</span>: <span class="literal">true</span>, <span class="comment">// applies background color and foreground color for root element by default</span></span><br><span class="line">    <span class="attr">styled</span>: <span class="literal">true</span>, <span class="comment">// include daisyUI colors and design decisions for all components</span></span><br><span class="line">    <span class="attr">utils</span>: <span class="literal">true</span>, <span class="comment">// adds responsive and modifier utility classes</span></span><br><span class="line">    <span class="attr">prefix</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// prefix for daisyUI classnames (components, modifiers and responsive class names. Not colors)</span></span><br><span class="line">    <span class="attr">logs</span>: <span class="literal">true</span>, <span class="comment">// Shows info about daisyUI version and used config in the console when building your CSS</span></span><br><span class="line">    <span class="attr">themeRoot</span>: <span class="string">&quot;:root&quot;</span>, <span class="comment">// The element that receives theme color CSS variables</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="我的主题切换器">我的主题切换器</h4><p>其中 tabindex=“0” 代表元素能否通过进行聚焦（用点的或者Tab键），此处第一个tabindex=&quot;0&quot;不能省略，因为下面的ul的dropdown-content的底层css样式写的就是：上面那个Theme div聚焦了，下面这个列表才显示。至于第二个ul的聚焦，没啥用，可以删掉，因为input能直接聚焦。</p><p>通过 <strong>:checked=&quot;index == themeIndex&quot;</strong>来初始化主题选择器的<strong>radio</strong>的选项默认选中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;dropdown&quot;&gt;</span><br><span class="line">        &lt;div tabindex=&quot;0&quot; role=&quot;button&quot; class=&quot;btn m-1&quot;&gt;</span><br><span class="line">            Theme</span><br><span class="line">            &lt;svg width=&quot;12px&quot; height=&quot;12px&quot; class=&quot;h-2 w-2 fill-current opacity-60 inline-block&quot;</span><br><span class="line">                xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 2048 2048&quot;&gt;</span><br><span class="line">                &lt;path d=&quot;M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z&quot;&gt;&lt;/path&gt;</span><br><span class="line">            &lt;/svg&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;ul tabindex=&quot;0&quot; class=&quot;dropdown-content z-[1] p-2 shadow-2xl bg-base-300 rounded-box w-52&quot;&gt;</span><br><span class="line">            &lt;li v-for=&quot;(theme, index) in themeList&quot; @click=&quot;changeTheme(index, theme)&quot;&gt;</span><br><span class="line">                &lt;input type=&quot;radio&quot; name=&quot;theme-dropdown&quot;</span><br><span class="line">                    class=&quot;theme-controller btn btn-sm btn-block btn-ghost justify-start&quot; :aria-label=&quot;theme&quot;</span><br><span class="line">                    :value=&quot;theme&quot; :checked=&quot;index == themeIndex&quot; /&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; useThemeStore &#125; from &#x27;@/stores/themeStore&#x27;;</span><br><span class="line"></span><br><span class="line">const &#123; changeThemeTo, getCurrentThemeIndex &#125; = useThemeStore();</span><br><span class="line"></span><br><span class="line">const themeIndex = ref(0);</span><br><span class="line">const themeList = ref([</span><br><span class="line">    &quot;light&quot;,</span><br><span class="line">    &quot;dark&quot;,</span><br><span class="line">    &quot;halloween&quot;,</span><br><span class="line">    &quot;garden&quot;,</span><br><span class="line">    &quot;forest&quot;,</span><br><span class="line">    &quot;lofi&quot;,</span><br><span class="line">    &quot;pastel&quot;,</span><br><span class="line">    &quot;fantasy&quot;,</span><br><span class="line">    &quot;wireframe&quot;,</span><br><span class="line">    &quot;black&quot;,</span><br><span class="line">    &quot;luxury&quot;,</span><br><span class="line">    &quot;dracula&quot;,</span><br><span class="line">    &quot;cmyk&quot;,</span><br><span class="line">    &quot;autumn&quot;,</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">function changeTheme(index, themeName) &#123;</span><br><span class="line">    themeIndex.value = index;</span><br><span class="line">    changeThemeTo(index, themeName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">    themeIndex.value = getCurrentThemeIndex();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>以下是pinia持久化的内容。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//themeStore.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useThemeStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> theme = <span class="title function_">ref</span>(<span class="string">&#x27;light&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> themeIndex = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">initialTheme</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> html = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;html&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">        html.<span class="title function_">setAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>, theme.<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">changeThemeTo</span>(<span class="params">index, themeName</span>) &#123;</span><br><span class="line">        themeIndex.<span class="property">value</span> = index;</span><br><span class="line">        theme.<span class="property">value</span> = themeName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getCurrentThemeIndex</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> themeIndex.<span class="property">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; theme, themeIndex, initialTheme, changeThemeTo, getCurrentThemeIndex &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    <span class="attr">persist</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>即便在控制器中初始化了默认<strong>radio</strong>的默认选中，但是在App.vue的onMounted函数中调用初始化主题仍然是必要的。因为主题控制器大多在导航栏中，而有的登陆界面中没有导航栏，意味着主题控制器未生效，此时需要根据本地数据主动初始化主题。</p><h3 id="封装好的popingalert">封装好的PopingAlert</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;alert&quot;</span> <span class="attr">role</span>=<span class="string">&quot;alert&quot;</span> <span class="attr">class</span>=<span class="string">&quot;alert w-fit absolute left-1/2 -translate-x-1/2 transition-all duration-1000&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:class</span>=<span class="string">&quot;&#123; &#x27;opacity-0 invisible -top-3&#x27;: !visible, &#x27;opacity-100 top-3&#x27;: visible, [alertTypeClass]: true &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">v-if</span>=<span class="string">&quot;type == &#x27;default&#x27;&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;stroke-info shrink-0 w-6 h-6&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">d</span>=<span class="string">&quot;M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">v-if</span>=<span class="string">&quot;type == &#x27;info&#x27;&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;stroke-current shrink-0 w-6 h-6&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">d</span>=<span class="string">&quot;M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">v-if</span>=<span class="string">&quot;type == &#x27;success&#x27;&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;stroke-current shrink-0 h-6 w-6&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">d</span>=<span class="string">&quot;M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">v-if</span>=<span class="string">&quot;type == &#x27;warning&#x27;&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;stroke-current shrink-0 h-6 w-6&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">d</span>=<span class="string">&quot;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">v-if</span>=<span class="string">&quot;type == &#x27;error&#x27;&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;stroke-current shrink-0 h-6 w-6&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">d</span>=<span class="string">&quot;M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; messgae &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> alert = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> type = <span class="title function_">ref</span>(<span class="string">&quot;default&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> messgae = <span class="title function_">ref</span>(<span class="string">&quot;Hello world.&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> visible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showAlert</span>(<span class="params">msg, typeName = <span class="string">&quot;default&quot;</span></span>) &#123;</span><br><span class="line">    messgae.<span class="property">value</span> = msg;</span><br><span class="line">    type.<span class="property">value</span> = typeName;</span><br><span class="line">    visible.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> visible.<span class="property">value</span> = <span class="literal">false</span>, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">defineExpose</span>(&#123; showAlert &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> alertTypeClass = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> typeClass = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    <span class="keyword">switch</span> (type.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;info&#x27;</span>:</span><br><span class="line">            typeClass = <span class="string">&#x27;alert-info&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;success&#x27;</span>:</span><br><span class="line">            typeClass = <span class="string">&#x27;alert-success&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;warning&#x27;</span>:</span><br><span class="line">            typeClass = <span class="string">&#x27;alert-warning&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;error&#x27;</span>:</span><br><span class="line">            typeClass = <span class="string">&#x27;alert-error&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> typeClass;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DaisyUI Tailwind </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VueUse</title>
      <link href="/2024/03/16/Vue-use.html"/>
      <url>/2024/03/16/Vue-use.html</url>
      
        <content type="html"><![CDATA[<p>这是 Vue 的一个第三方库，提供了许多意想不到的功能。比如异步 computed 。</p><h3 id="computedasync"><a href="https://vueuse.org/core/computedAsync/#computedasync">computedAsync</a></h3><p>Vue 官方的 computed 是同步的，有时并不能满足开发需求。比如我根据“县名”异步查询行政区下的“乡镇”，在 resolve 之前，我希望有个默认值。当然了，我可以定义一个 ref 变量来存放默认值，异步查询后更改 ref 的值。这意味着，我要在选择县之后的回调函数中，手动调用异步函数，然后等待异步函数 resolve ，再修改 ref 的值。这显然很麻烦。</p><p>但是这个库函数，直接传入异步函数和默认值，组件直接使用 computed 的结果即可，自然是方便很多。</p><p>比如。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> towns = <span class="title function_">computedAsync</span>(</span><br><span class="line">    <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (country.<span class="property">value</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> towns = <span class="keyword">await</span> <span class="title function_">getTowns</span>((country.<span class="property">value</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">name</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">addIdToDistinct</span>(towns <span class="keyword">as</span> <span class="built_in">any</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> [&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span> &#125;];</span><br><span class="line">    &#125;,</span><br><span class="line">    [&#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span> &#125;],</span><br><span class="line">    &#123; <span class="attr">lazy</span>: <span class="literal">true</span> &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> uniapp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>项目过程中积累的css技巧</title>
      <link href="/2024/03/11/css-skills.html"/>
      <url>/2024/03/11/css-skills.html</url>
      
        <content type="html"><![CDATA[<h3 id="flex布局设置多行首对齐且整体居中">Flex布局设置多行首对齐且整体居中</h3><p>假定项目中的待展示元素宽高固定，每一行要求左对齐，一行最多五个，在此基础上，依据设备的不同，每一行多余的屏幕空间不同。如何将每行排满后多余的屏幕空间分配给该行的每个元素？</p><p>答：采用一个空盒子对展示元素进行包裹。对于空盒子，采用<strong> flex-bias </strong>设置一行内所占空间为 20% ，同时空盒子也进行 flex 布局，对展示元素进行水平和垂直的居中处理。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;categories&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;wrapper&quot; v-for=&quot;category in categories&quot;&gt;</span><br><span class="line">            &lt;navigator class=&quot;navigator-item&quot; url=&quot;/pages/index/index&quot; open-type=&quot;navigate&quot;</span><br><span class="line">                hover-class=&quot;navigator-hover&quot;&gt;</span><br><span class="line">                &lt;image class=&quot;icon&quot; :src=&quot;category.icon_data&quot; /&gt;</span><br><span class="line">                &lt;text&gt;&#123;&#123; category.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">            &lt;/navigator&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; getCats &#125; from &#x27;@/services/product&#x27;;</span><br><span class="line">import &#123; useProductStore &#125; from &#x27;@/stores/piniaStores&#x27;;</span><br><span class="line">import &#123; storeToRefs &#125; from &#x27;pinia&#x27;;</span><br><span class="line"></span><br><span class="line">const &#123; categories &#125; = storeToRefs(useProductStore());</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">    getCats();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.categories &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: wrap;</span><br><span class="line">    justify-content: flex-start;</span><br><span class="line">    margin-top: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.wrapper &#123;</span><br><span class="line">    flex-basis: 20%;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.navigator-item &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    margin-bottom: 25px;</span><br><span class="line">    background-color: #6196A6;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.navigator-item text &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    bottom: -20px;</span><br><span class="line">    font-size: x-small;</span><br><span class="line">    font-weight: 500;</span><br><span class="line">    color: black;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">image &#123;</span><br><span class="line">    width: 30px;</span><br><span class="line">    height: 30px;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><img src="https://pics.kahvia.cn/img/20240311193512.png" alt="效果图"></p><h3 id="淡入淡出动画">淡入淡出动画</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;alert&quot;</span> <span class="attr">role</span>=<span class="string">&quot;alert&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;alert w-fit absolute top-0 left-1/2 -translate-x-1/2 transition-all duration-1000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:class</span>=<span class="string">&quot;&#123; &#x27;opacity-0 invisible&#x27;: !visible, &#x27;opacity-100&#x27;: visible &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span> <span class="attr">class</span>=<span class="string">&quot;stroke-info shrink-0 w-6 h-6&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">path</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">d</span>=<span class="string">&quot;M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; messgae &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在添加 transition 的情况下，<strong>visibility</strong> 的 visible 到 hidden 是 duration 结束后的突变，并不会有过渡效果，而 hidden 到 visible 是 duration 刚开始就突变的。</p><p>这意味着元素在获得 hidden 的时候是会因为 duration 而延迟，延迟期间仍然可以进行交互（包括看见、点击、拖拽等等），直到 visibility : hidden被添加。</p><p>同样意味着元素在获得 visible 的时候是瞬间生效的，不会因为 duration 有任何的延迟。</p><p>这样一来，当我们点击按钮让它显示的时候，它是瞬间出现的。再次点击按钮让它消失的时候，它会等待 duration 度过，然后瞬间消失。</p><p>我们只需要添加 opacity 不透明度的变化，让元素在 duration 期间淡入淡出，即可实现视觉和交互层面的淡入淡出。</p><p><img src="https://pics.kahvia.cn/img/MS%E6%B8%90%E5%85%A5%E6%B8%90%E5%87%BA.gif" alt="渐入渐出"></p><h3 id="flex布局未溢出时居中-溢出时start">Flex布局未溢出时居中，溢出时start</h3><p><a href="https://stackoverflow.com/questions/34184535/change-justify-content-value-when-flex-items-overflow-container">参考问答</a></p><p>问题描述：通过 <code>justify-content:center</code>，可以设置 Flex 布局主轴居中，但是溢出设置滚动时，会导致滚动内容异常（居中导致的）。期望效果：未溢出时主轴居中，溢出时 flex-start 的效果。</p><p>解决方法：为 flex 盒子添加 before 和 after 伪元素，分别设置外边距 <code>margin:auto</code>。在未溢出的时候，自动外边距会占据剩余的空间，将元素居中。在溢出的时候，该属性会被忽略，正常溢出，无不良效果，即普通的靠左的从左到右依次排列，溢出滚动。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.iconSelector</span><span class="selector-pseudo">::before</span>,</span><br><span class="line"><span class="selector-class">.iconSelector</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">/* Insert pseudo-element */</span></span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">    <span class="comment">/* Make it push flex items to the center */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 经验 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue3知识点</title>
      <link href="/2024/03/09/vue3Knowledge.html"/>
      <url>/2024/03/09/vue3Knowledge.html</url>
      
        <content type="html"><![CDATA[<h3 id="样式穿透">样式穿透</h3><p>使用样式穿透，可以穿透子组件影响到下面的类的样式，做到对第三方组件的样式自定义。</p><h4 id="采用">采用&gt;&gt;&gt;</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uni-data-picker&gt;&gt;&gt;<span class="selector-class">.input-value-border</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="采用-deep">采用 /deep/</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uni-data-picker /deep/ <span class="selector-class">.input-value-border</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="采用-v-deep">采用 ::v-deep</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uni-data-picker::v-deep .input-value-border &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">3px</span> solid orange;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="父组件获取子组件属性">父组件获取子组件属性</h3><p>根据<a href="https://cn.vuejs.org/api/sfc-script-setup.html#defineexpose">官方文档</a>，采用组合式 api 编写的组件，内部定义的属性、方法，都是不对外开放的。可以调用 defineExpose() 方法，暴露需要的属性和方法。外部通过 ref 进行模板引用，即可访问暴露出来的属性和方法。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;uni-popup ref=&quot;popPage&quot; type=&quot;bottom&quot; background-color=&quot;#f7f7f7&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;boxBack&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">                &lt;input type=&quot;nickname&quot; placeholder=&quot;请输入分类名称&quot; v-model=&quot;catName&quot;&gt;</span><br><span class="line">                &lt;button ref=&quot;nickBtn&quot; @click=&quot;&quot;&gt;确认&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/uni-popup&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">const popPage = ref(null);</span><br><span class="line">const catName = ref(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">function popUp() &#123;</span><br><span class="line">    console.log(popPage.value);</span><br><span class="line">    (popPage.value as any).open();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defineExpose(&#123;</span><br><span class="line">    popUp</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 弹出层样式 --&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h3 id="props设置默认值">props设置默认值</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Boolean 类型的未传递 prop 将被转换为 false。————官方文档</span></span><br><span class="line"><span class="keyword">let</span> props = <span class="title function_">defineProps</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">showBack</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="watch-props的值">watch props的值</h3><p>要使用 getter 函数。此处的 props.catName 是一个外部传入常量，如果给 watch 这个东西，那么 watch 调用，生成监视的时候，收到的参数是一个常量，这不对。要给 watch 一个getter 函数，让它自己调用函数去看，这样监视器看到返回值跟之前不一样了，才知道发生了变化。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(<span class="function">() =&gt;</span> props.<span class="property">catName</span>, <span class="keyword">async</span> (oldCatName, newCatName) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> ((productsMap.<span class="property">value</span> <span class="keyword">as</span> <span class="built_in">any</span>)[props.<span class="property">catName</span>].<span class="property">length</span> == <span class="number">0</span>)</span><br><span class="line">        <span class="title function_">getProsByCatName</span>();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://cn.vuejs.org/guide/essentials/watchers.html#watch-source-types">侦听器 | Vue.js (vuejs.org)</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MemFireDb</title>
      <link href="/2024/03/06/MemFireDb.html"/>
      <url>/2024/03/06/MemFireDb.html</url>
      
        <content type="html"><![CDATA[<h3 id="安装">安装</h3><p>以最近的 uniapp 开发微信小程序为例。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install @supabase/supabase-js</span><br><span class="line">npm install supabase-wechat-stable-v2</span><br></pre></td></tr></table></figure><h3 id="配置数据库连接">配置数据库连接</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fireDb.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createClient &#125; <span class="keyword">from</span> <span class="string">&quot;supabase-wechat-stable-v2&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//这两个常量可以在MemFireDb官网数据库的api中找到</span></span><br><span class="line"><span class="keyword">const</span> supabaseUrl = <span class="string">&quot;https://xxxx.baseapi.memfiredb.com&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> publicAnonKey = <span class="string">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>;</span><br><span class="line"><span class="comment">// Create a single supabase client for interacting with your database</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> supabase = <span class="title function_">createClient</span>(supabaseUrl, publicAnonKey);</span><br></pre></td></tr></table></figure><h3 id="微信授权手机号一键登陆">微信授权手机号一键登陆</h3><p>在 uniapp 中，设置 button 的 open-type 为 getPhoneNumber，并监听事件getPhoneNumber。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;button class=&quot;btn&quot; open-type=&quot;getPhoneNumber&quot; @getphonenumber=&quot;wxLogin&quot;&gt;</span><br><span class="line">            &lt;image</span><br><span class="line">                src=&quot;data:image/svg+xml;base64,xxx&quot; /&gt;</span><br><span class="line">            &lt;text&gt;微信快捷登录&lt;/text&gt;</span><br><span class="line">    &lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>监听事件发生时，调用 wxLogin 函数，传入一个事件对象，根据 code 值判断是否获取到电话号码。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">wxLogin</span> = <span class="keyword">async</span> (<span class="params">e: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">    wx.<span class="title function_">login</span>(&#123;</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">async</span> res =&gt; &#123;</span><br><span class="line">            <span class="comment">//在getPhoneNumber事件中,如果code为undefined，则用户未授权，否则用户已经授权，获取到手机号码</span></span><br><span class="line">            <span class="keyword">if</span> (!e.<span class="property">detail</span>.<span class="property">code</span>) &#123;</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&quot;授权失败&quot;</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2000</span></span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//微信登录，新用户则自动注册</span></span><br><span class="line">            <span class="keyword">const</span> &#123; data, error &#125; = <span class="keyword">await</span> supabase.<span class="property">auth</span>.<span class="title function_">signInWithWechat</span>(&#123; <span class="attr">code</span>: res.<span class="property">code</span> &#125;)</span><br><span class="line">            <span class="keyword">let</span> &#123; <span class="attr">user</span>: &#123; <span class="attr">data</span>: &#123; user &#125; &#125; &#125; = data <span class="keyword">as</span> <span class="built_in">any</span>;</span><br><span class="line">            <span class="title function_">setProfile</span>(user);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                    <span class="attr">title</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(error) || error?.<span class="property">message</span>,</span><br><span class="line">                    <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    <span class="attr">duration</span>: <span class="number">2000</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data) &#123;</span><br><span class="line">                <span class="comment">//获取到用户信息后，绑定电话号码到小程序用户上</span></span><br><span class="line">                <span class="keyword">const</span> &#123; data, error &#125; = <span class="keyword">await</span> supabase.<span class="property">auth</span>.<span class="title function_">wechatBindPhone</span>(&#123;</span><br><span class="line">                    <span class="attr">code</span>: e.<span class="property">detail</span>.<span class="property">code</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                    wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(error) || error?.<span class="property">message</span>,</span><br><span class="line">                        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">2000</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data) &#123;</span><br><span class="line">                    wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">                        <span class="attr">title</span>: <span class="string">&#x27;登录成功！&#x27;</span>,</span><br><span class="line">                        <span class="attr">icon</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                        <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                    wx.<span class="title function_">switchTab</span>(&#123;</span><br><span class="line">                        <span class="attr">url</span>: <span class="string">&#x27;/pages/index/index&#x27;</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="获取微信头像">获取微信头像</h3><p>操作与获取手机号码类似。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;button class=&quot;avatarCoverBtn&quot; open-type=&quot;chooseAvatar&quot; @chooseavatar=&quot;chooseAvatar&quot;&gt;</span><br><span class="line">&lt;image class=&quot;avatar&quot; :src=&quot;profile.avatar&quot; mode=&quot;scaleToFill&quot; /&gt;</span><br><span class="line">&lt;/button&gt;</span><br></pre></td></tr></table></figure><p>在获取到头像的本地路径后，需要转存到对象存储的存储桶中，获取对应的网络地址，然后更新数据库中的头像信息和小程序本地的头像信息。我采用 Pinia 进行状态管理，因此在 updateAvatar 函数中，对 userStore 里的头像信息进行了更新。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">chooseAvatar</span> = (<span class="params">e: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; avatarUrl &#125; = e.<span class="property">detail</span></span><br><span class="line">    wx.<span class="title function_">getImageInfo</span>(&#123;</span><br><span class="line">        <span class="attr">src</span>: avatarUrl, <span class="comment">// 图片路径，必须是本地路径，可以相对路径或绝对路径</span></span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> file = &#123; <span class="attr">fileType</span>: <span class="string">&quot;image&quot;</span>, <span class="attr">width</span>: res.<span class="property">width</span>, <span class="attr">height</span>: res.<span class="property">height</span>, <span class="attr">tempFilePath</span>: avatarUrl &#125;</span><br><span class="line">            <span class="keyword">const</span> fileExt = avatarUrl.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="title function_">pop</span>()</span><br><span class="line">            <span class="keyword">const</span> fileName = <span class="string">`<span class="subst">$&#123;<span class="built_in">Math</span>.random()&#125;</span>.<span class="subst">$&#123;fileExt&#125;</span>`</span></span><br><span class="line">            <span class="keyword">const</span> filePath = <span class="string">`<span class="subst">$&#123;profile.value.id&#125;</span>/<span class="subst">$&#123;fileName&#125;</span>`</span></span><br><span class="line">            <span class="keyword">let</span> &#123; <span class="attr">error</span>: uploadError &#125; = <span class="keyword">await</span> supabase.<span class="property">storage</span></span><br><span class="line">                .<span class="title function_">from</span>(<span class="string">&#x27;avatars&#x27;</span>)</span><br><span class="line">                .<span class="title function_">upload</span>(filePath, file <span class="keyword">as</span> <span class="built_in">any</span>)</span><br><span class="line">            <span class="keyword">if</span> (uploadError) &#123;</span><br><span class="line">                <span class="keyword">throw</span> uploadError</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获取具有一年期限的头像url</span></span><br><span class="line">            <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">await</span> supabase</span><br><span class="line">                .<span class="property">storage</span></span><br><span class="line">                .<span class="title function_">from</span>(<span class="string">&#x27;avatars&#x27;</span>)</span><br><span class="line">                .<span class="title function_">createSignedUrl</span>(filePath, <span class="number">31556952</span>);</span><br><span class="line">            <span class="comment">//更新头像</span></span><br><span class="line">            <span class="title function_">updateAvatar</span>(data!.<span class="property">signedUrl</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>注：存储桶我设置为私有，且设置了行级安全策略，因此在存储头像的时候，需要存入对应 uid 文件夹下，否则没有权限。</p><blockquote><p><a href="https://document.memfiredb.com/docs/guides/storage#%E5%85%B1%E6%9C%89%E6%A1%B6%E5%92%8C%E7%A7%81%E6%9C%89%E6%A1%B6">存储桶的私有和共有</a>，详细描述了二者的区别，以及对应的获取资源 url 的方式。</p></blockquote><h3 id="自己维护users的信息">自己维护users的信息</h3><p>在 public 中新建 users 表。为其创建两个触发器，分别在 auth.users 插入和更新时触发，用以同步 users 中的变化。</p><figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> USERS (</span><br><span class="line">  id <span class="type">uuid</span> <span class="keyword">references</span> auth.users <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">primary key</span>,</span><br><span class="line">  <span class="keyword">role</span> <span class="type">text</span>,</span><br><span class="line">  email <span class="type">text</span>,</span><br><span class="line">  last_sign_in_at <span class="type">text</span>,</span><br><span class="line">  raw_app_meta_data <span class="type">jsonb</span>,</span><br><span class="line">  raw_user_meta_data <span class="type">jsonb</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or replace</span> <span class="keyword">function</span> <span class="built_in">public</span>.handle_new_user()</span><br><span class="line"><span class="keyword">returns</span> <span class="type">trigger</span> <span class="keyword">as</span> $$<span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">begin</span></span></span><br><span class="line"><span class="language-pgsql">  <span class="keyword">insert</span> <span class="keyword">into</span> <span class="built_in">public</span>.users (id, <span class="keyword">role</span>, email,last_sign_in_at,raw_app_meta_data,raw_user_meta_data)</span></span><br><span class="line"><span class="language-pgsql">  <span class="keyword">values</span> (<span class="built_in">new</span>.id,<span class="built_in">new</span>.<span class="keyword">role</span>, <span class="built_in">new</span>.email,<span class="built_in">new</span>.last_sign_in_at,<span class="built_in">new</span>.raw_app_meta_data,<span class="built_in">new</span>.raw_user_meta_data);</span></span><br><span class="line"><span class="language-pgsql">  <span class="keyword">return</span> <span class="built_in">new</span>;</span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">end</span>;</span></span><br><span class="line"><span class="language-pgsql">$$</span> <span class="keyword">language</span> plpgsql <span class="keyword">security</span> <span class="keyword">definer</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> on_new_user</span><br><span class="line"><span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">on</span> auth.users <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">execute</span> <span class="keyword">procedure</span> <span class="built_in">public</span>.handle_new_user ();</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or replace</span> <span class="keyword">function</span> <span class="built_in">public</span>.update_user()</span><br><span class="line"><span class="keyword">returns</span> <span class="type">trigger</span> <span class="keyword">as</span> $$<span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">begin</span></span></span><br><span class="line"><span class="language-pgsql">  <span class="keyword">UPDATE</span> <span class="built_in">public</span>.users</span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">SET</span> <span class="keyword">role</span> = <span class="built_in">new</span>.<span class="keyword">role</span>, </span></span><br><span class="line"><span class="language-pgsql">    email = <span class="built_in">new</span>.email,</span></span><br><span class="line"><span class="language-pgsql">    last_sign_in_at = <span class="built_in">new</span>.last_sign_in_at,</span></span><br><span class="line"><span class="language-pgsql">    raw_app_meta_data = <span class="built_in">new</span>.raw_app_meta_data,</span></span><br><span class="line"><span class="language-pgsql">    raw_user_meta_data = <span class="built_in">new</span>.raw_user_meta_data</span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">WHERE</span> id = <span class="built_in">new</span>.id;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">  <span class="keyword">return</span> <span class="built_in">new</span>;</span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">end</span>;</span></span><br><span class="line"><span class="language-pgsql">$$</span> <span class="keyword">language</span> plpgsql <span class="keyword">security</span> <span class="keyword">definer</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> on_update_user</span><br><span class="line"><span class="keyword">after</span> <span class="keyword">update</span> <span class="keyword">on</span> auth.users <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">execute</span> <span class="keyword">procedure</span> <span class="built_in">public</span>.update_user ();</span><br></pre></td></tr></table></figure><p>为其设定行级安全策略，仅超级管理员可以访问。</p><figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(get_my_claim(<span class="string">&#x27;role&#x27;</span>::<span class="type">text</span>) = <span class="string">&#x27;&quot;super_admin&quot;&#x27;</span>::<span class="type">jsonb</span>)</span><br></pre></td></tr></table></figure><h3 id="查询行数">查询行数</h3><p>其中 head 表示是否只获取每一行的开头，而不获取具体数据。设置为 true 时，返回的 data 为 null 。estimated 是指在行数小的时候返回具体值，行数多的时候返回估计值。注意不能使用 range ，不然 count 的结果就是 range 的范围了。</p><figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">export const getUsersNum = () =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">new</span> Promise(async (resolve, reject) =&gt; &#123;</span><br><span class="line">        const &#123; data, count, error &#125; = await supabase</span><br><span class="line">            .<span class="keyword">from</span>(<span class="string">&#x27;users&#x27;</span>)</span><br><span class="line">            .<span class="keyword">select</span>(<span class="string">&#x27;*&#x27;</span>, &#123; count: <span class="string">&#x27;estimated&#x27;</span>, head: <span class="keyword">true</span> &#125;)</span><br><span class="line">        <span class="keyword">if</span> (count)</span><br><span class="line">            resolve(count);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            reject();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="input失焦空查询">input失焦空查询</h3><p>当为一个input输入框添加失去焦点时的事件函数 blur 时，如果是调用的异步查询函数，比如 supabase 的 select 时，会在查询时添加奇怪的参数，导致查询结果为空数组。</p><p><img src="https://pics.kahvia.cn/img/supabase%E7%9A%84input%E5%A4%B1%E7%84%A6%E7%A9%BA%E6%9F%A5%E8%AF%A21.png" alt="不正常的参数"></p><p>为了正常查询，在 blur 触发的时候去调用同步函数，通过同步函数去调用异步查询函数即可，就像这样：<code>@blur=&quot;()=&gt;getOrders()&quot;</code></p><p><img src="https://pics.kahvia.cn/img/supabase%E7%9A%84input%E5%A4%B1%E7%84%A6%E7%A9%BA%E6%9F%A5%E8%AF%A22.png" alt="正常查询"></p><p>可以看见奇怪的事件参数消失了，数据正常查询。</p><h3 id="请求未发送">请求未发送</h3><p>在对数据库进行一个字段更新的异步操作时，发现请求未成功发送。<code>supabase.from('address').update(&#123; 'default': false &#125;).eq('id', *fromAid*);</code></p><p>经过查阅<a href="https://www.reddit.com/r/Supabase/comments/13jsbv1/comment/jkilyj5/?utm_source=reddit&amp;utm_medium=web2x&amp;context=3">资料</a>得知，supabase <strong>自己封装的链式调用</strong>，在不需 await 的情况下，需要用 .then() 来表示请求的构造完成。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">supabase.<span class="title function_">from</span>(<span class="string">&#x27;address&#x27;</span>).<span class="title function_">update</span>(&#123; <span class="string">&#x27;default&#x27;</span>: <span class="literal">true</span> &#125;).<span class="title function_">eq</span>(<span class="string">&#x27;id&#x27;</span>, fromAid).<span class="title function_">then</span>();</span><br></pre></td></tr></table></figure><p>这样就可以在使用其自定义链式调用的情况下，正常发送无需等待的异步请求。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PostgreSQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScript</title>
      <link href="/2024/02/29/TypeScript.html"/>
      <url>/2024/02/29/TypeScript.html</url>
      
        <content type="html"><![CDATA[<h3 id="安装">安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g typescript</span><br></pre></td></tr></table></figure><h3 id="编译ts文件">编译ts文件</h3><p>使用该命令可以将 ts 文件转换成可执行的 js 文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc xxx.ts</span><br></pre></td></tr></table></figure><p>通过 node 命令执行相应的 js 文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node xxx.js</span><br></pre></td></tr></table></figure><h3 id="直接运行ts文件">直接运行ts文件</h3><p>先安装所需工具包。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g ts-node</span><br></pre></td></tr></table></figure><p>使用该工具包直接执行 ts 文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ts-node xxx.ts</span><br></pre></td></tr></table></figure><h3 id="使用时的一些小问题">使用时的一些小问题</h3><h4 id="类型本身定义是错误的">类型本身定义是错误的</h4><p>比如，在使用 MemFireDB 的微信SDK开发小程序的时候，我使用了一个方法用于获取用户信息。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="attr">data</span>: &#123; user &#125; &#125; = <span class="keyword">await</span> supabase.<span class="property">auth</span>.<span class="title function_">getUser</span>();</span><br></pre></td></tr></table></figure><p>对于 user 对应的官方 type 是 User，如下所示。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">app_metadata</span>: <span class="title class_">UserAppMetadata</span></span><br><span class="line">  <span class="attr">user_metadata</span>: <span class="title class_">UserMetadata</span></span><br><span class="line">  <span class="attr">aud</span>: <span class="built_in">string</span></span><br><span class="line">  confirmation_sent_at?: <span class="built_in">string</span></span><br><span class="line">  recovery_sent_at?: <span class="built_in">string</span></span><br><span class="line">  email_change_sent_at?: <span class="built_in">string</span></span><br><span class="line">  new_email?: <span class="built_in">string</span></span><br><span class="line">  new_phone?: <span class="built_in">string</span></span><br><span class="line">  invited_at?: <span class="built_in">string</span></span><br><span class="line">  action_link?: <span class="built_in">string</span></span><br><span class="line">  email?: <span class="built_in">string</span></span><br><span class="line">  phone?: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">created_at</span>: <span class="built_in">string</span></span><br><span class="line">  confirmed_at?: <span class="built_in">string</span></span><br><span class="line">  email_confirmed_at?: <span class="built_in">string</span></span><br><span class="line">  phone_confirmed_at?: <span class="built_in">string</span></span><br><span class="line">  last_sign_in_at?: <span class="built_in">string</span></span><br><span class="line">  role?: <span class="built_in">string</span></span><br><span class="line">  updated_at?: <span class="built_in">string</span></span><br><span class="line">  identities?: <span class="title class_">UserIdentity</span>[]</span><br><span class="line">  factors?: <span class="title class_">Factor</span>[]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然而经过实际打印输出我发现，这个 user 的数据结构如下所示。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;app_metadata&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;xxx&quot;</span><span class="punctuation">:</span><span class="string">&quot;xxxx&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>所以正确的的 User 定义应该是下面这样的。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="attr">data</span>:&#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">      <span class="attr">app_metadata</span>: <span class="title class_">UserAppMetadata</span></span><br><span class="line">      <span class="attr">xxx</span>:xxxx</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>虽然我发现了错误，但我业务做一半，也不能不用这个了吧。所以我自己定义了一个 type ，如下所示。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">MyUser</span> &#123;</span><br><span class="line">    <span class="attr">data</span>: <span class="title class_">User</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后使用断言 as 进行强制类型转换，先取消原有的类型声明，再声明为新的类型。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myUser = user <span class="keyword">as</span> <span class="built_in">unknown</span> <span class="keyword">as</span> <span class="title class_">MyUser</span>;</span><br></pre></td></tr></table></figure><p>这样一来，我就可以通过 <a href="http://myUser.data.id">myUser.data.id</a> 这种形式，正常使用数据。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ts </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>uniapp知识点</title>
      <link href="/2024/02/29/Uniapp.html"/>
      <url>/2024/02/29/Uniapp.html</url>
      
        <content type="html"><![CDATA[<h3 id="在vscode中开发uniapp">在vscode中开发uniapp</h3><h4 id="使用命令行创建uniapp项目">使用命令行创建uniapp项目</h4><p>此处是vue3+ts。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx degit dcloudio/uni-preset-vue<span class="comment">#vite-ts my-vue3-project</span></span><br></pre></td></tr></table></figure><h4 id="安装插件">安装插件</h4><ul><li>uni-create-view</li><li>uni-helper</li><li>uniapp小程序扩展</li></ul><h4 id="ts相关">TS相关</h4><p>在根目录创建 <code>tsconfig.json</code> 文件，并进行个性化配置，个性化配置是可选的，没有<code>tsconfig.json</code>时会自动使用默认配置运行。推荐配置如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;preserve&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sourceMap&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;skipLibCheck&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;importHelpers&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;allowSyntheticDefaultImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;useDefineForClassFields&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;resolveJsonModule&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;dom&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@dcloudio/types&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@types/wechat-miniprogram&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@uni-helper/uni-app-types&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;@uni-helper/uni-ui-types&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;src/*&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;vueCompilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;nativeTags&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;block&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;component&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;template&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;slot&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;node_modules&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;unpackage&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.nvue&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>vueCompilerOptions以及nativeTags的配置是必须的。否则uniapp的标签比如view会出现<strong><a href="https://blog.csdn.net/weixin_41844140/article/details/134901640?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-134901640-blog-134186772.235%5Ev43%5Epc_blog_bottom_relevance_base3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-134901640-blog-134186772.235%5Ev43%5Epc_blog_bottom_relevance_base3&amp;utm_relevant_index=2">类型错误</a></strong>。</p><p>baseUrl 和 paths 用于映射@/开头的 import 路径。详情参考<a href="https://www.typescriptlang.org/zh/tsconfig#paths">TypeScript: TSConfig</a>。</p></blockquote><p>安装TS类型支持包。前者是微信小程序组件的TS类型，后者是uniapp组件的TS类型。这些类型已在上方配置文件中的types添加。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @types/wechat-miniprogram @uni-helper/uni-app-types</span><br></pre></td></tr></table></figure><h4 id="json文件相关">json文件相关</h4><p>在 uniapp 项目中，我们可能会在 json 文件中有注释，vscode 识别 json 文件时，不允许有注释在其中，会报错，如下图所示。</p><p><img src="https://pics.kahvia.cn/img/20240301171803.png" alt="json文件内注释报错"></p><p>解决方法：在 vscode 的设置中，搜索 associations ，添加文件关联键值对，即<strong> xxx.json   jsonc </strong>。如下图所示，报错已消失。</p><p>注：.json 文件是标准的 json 格式，除了不允许有注释以外，还有其它的一些严格规则。.jsonc 文件则是拓展的 json 格式，能有注释在其中，以及可以省略 key 的引号等等。像 package.json 这种文件，最好还是不要加注释在里面。</p><p><img src="https://pics.kahvia.cn/img/20240301174049.png" alt="vscode文件关联"></p><h3 id="uni-ui">uni-ui</h3><p><a href="https://uniapp.dcloud.net.cn/component/uniui/uni-ui.html">uni-ui 介绍 | uni-app官网 (dcloud.net.cn)</a></p><h4 id="安装-uni-ui-所需的-sass-预处理器和加载器">安装 uni-ui 所需的 sass 预处理器和加载器</h4><p>安装 sass</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i sass -D   或   yarn add sass -D  </span><br></pre></td></tr></table></figure><p>安装 sass-loader</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i sass-loader@10.1.1 -D   或   yarn add sass-loader@10.1.1 -D</span><br></pre></td></tr></table></figure><h4 id="安装uni-ui">安装uni-ui</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @dcloudio/uni-ui   或   yarn add @dcloudio/uni-ui</span><br></pre></td></tr></table></figure><h4 id="配置uni-ui组件自动导入">配置uni-ui组件自动导入</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pages.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">// uni-ui 规则如下配置</span></span><br><span class="line"><span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他内容</span></span><br><span class="line">pages<span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="安装-uni-ui-的-ts-类型包">安装 uni-ui 的 ts 类型包</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @uni-helper/uni-ui-types</span><br></pre></td></tr></table></figure><p>然后在 tsconfig.json 中的 types 里写上对应的类型。现在就可以在 uni-ui 的组件标签上看到对应的类型了。</p><h3 id="pinia">Pinia</h3><h4 id="pinia本体">pinia本体</h4><p>本人采用 vue 版本 3.4.21, pinia 版本 2.0.36，不会发生依赖冲突以及各种报错。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i pinia@2.0.36</span><br></pre></td></tr></table></figure><p>创建 pinia 实例。</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(pinia)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h5 id="常用操作">常用操作</h5><p>使用 <a href="https://pinia.vuejs.org/zh/core-concepts/#using-the-store">storeToRefs()</a> 取出 store 中的响应式数据。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../../stores/piniaStores&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; storeToRefs &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>();</span><br><span class="line"><span class="keyword">const</span> &#123;nickName&#125; = <span class="title function_">storeToRefs</span>(userStore);</span><br></pre></td></tr></table></figure><h4 id="pinia的持久化插件">pinia的持久化插件</h4><p><a href="https://prazdevs.github.io/pinia-plugin-persistedstate/">Home | pinia-plugin-persistedstate (prazdevs.github.io)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i pinia-plugin-persistedstate</span><br></pre></td></tr></table></figure><p>注意：是 pinia-plugin-persistedstate 这个插件，而非 <a href="https://seb-l.github.io/pinia-plugin-persist/">pinia-plugin-persist</a> 这个坑比插件。后者使用自定义 Storage 的时候，比如我是用的 uni 的storage，会报错说没有sessionStorage，这让我研究了一下午自己的官方文档，怀疑是自己的问题，最后得出结论是插件官方的问题。</p><p>在 main.ts 中配置持久化。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> piniaPluginPersistedstate <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line">pinia.<span class="title function_">use</span>(piniaPluginPersistedstate)</span><br></pre></td></tr></table></figure><p>我配置完成后是如下所示。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSSRApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">Pinia</span> <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> piniaPluginPersistedstate <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createApp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> app = <span class="title function_">createSSRApp</span>(<span class="title class_">App</span>);</span><br><span class="line">  <span class="keyword">const</span> pinia = <span class="title class_">Pinia</span>.<span class="title function_">createPinia</span>();</span><br><span class="line">  pinia.<span class="title function_">use</span>(piniaPluginPersistedstate);</span><br><span class="line">  app.<span class="title function_">use</span>(pinia);</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    app,</span><br><span class="line">    <span class="title class_">Pinia</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>因为是为了 uniapp 采用的 pinia ，而 uniapp 没有 sessionStorage ，所以在定义 store 的时候需要自定义 storage。参考代码如下。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">StorageLike</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia-plugin-persistedstate&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">uniStorege</span>: <span class="title class_">StorageLike</span> = &#123;</span><br><span class="line">    <span class="title function_">setItem</span>(<span class="params">key, value</span>) &#123;</span><br><span class="line">        uni.<span class="title function_">setStorageSync</span>(key, value);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">getItem</span>(<span class="params">key</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> uni.<span class="title function_">getStorageSync</span>(key);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你可以对 `defineStore()` 的返回值进行任意命名，但最好使用 store 的名字，同时以 `use` 开头且以 `Store` 结尾。(比如 `useUserStore`，`useCartStore`，`useProductStore`)</span></span><br><span class="line"><span class="comment">// 第一个参数是你的应用中 Store 的唯一 ID。</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;user&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> nickName = <span class="title function_">ref</span>(<span class="string">&quot;Kahvia&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">setName</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        nickName.<span class="property">value</span> = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; nickName, setName &#125;;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    <span class="attr">persist</span>: &#123;</span><br><span class="line">        <span class="attr">storage</span>: uniStorege,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>关于插件的其它可选配置，可以参照官方文档。</p><h3 id="为-uniapp-的请求添加拦截器">为 uniapp 的请求添加拦截器</h3><p>拦截器的作用是，在请求发送前拦截请求，或收到请求结果后拦截结果，对请求或结果作一定的处理后，再放行。常用于简化操作，比如发送请求前统一添加域名前缀，或收到请求结果后提取关键数据、展示错误信息等。减少了代码的冗余。ps：比如我以前做项目的时候，都是在一个 js 文件中定义常量 baseUrl，在有请求的页面引入该 js 文件，采用 baseUrl + ‘/user/upload’ 这种形式的代码，这意味着我有多少个请求，我就写了多少个这样的拼接代码，的确写了很多无用代码。</p><p>以下代码块则展示了如何添加请求发送前的拦截器。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//utils/http.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/piniaStores&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">baseUrl</span>: <span class="built_in">string</span> = <span class="string">&quot;https://www.kahvia.cn&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> httpInterceptor = &#123;</span><br><span class="line">    <span class="title function_">invoke</span>(<span class="params">options: UniApp.RequestOptions</span>) &#123;</span><br><span class="line">        <span class="comment">//请求添加前缀</span></span><br><span class="line">        <span class="keyword">if</span> (!options.<span class="property">url</span>.<span class="title function_">startsWith</span>(<span class="string">&quot;http&quot;</span>))</span><br><span class="line">            options.<span class="property">url</span> = baseUrl + options.<span class="property">url</span>;</span><br><span class="line">        <span class="comment">//设置超时时间</span></span><br><span class="line">        options.<span class="property">timeout</span> = <span class="number">10000</span>;</span><br><span class="line">        <span class="comment">//设置请求头</span></span><br><span class="line">        options.<span class="property">header</span> = &#123;</span><br><span class="line">            <span class="comment">//保留原有请求头</span></span><br><span class="line">            ...options.<span class="property">header</span>,</span><br><span class="line">            <span class="comment">//添加请求来源</span></span><br><span class="line">            <span class="string">&#x27;source-client&#x27;</span>: <span class="string">&#x27;miniapp&#x27;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>();</span><br><span class="line">        <span class="keyword">const</span> token = userStore.<span class="property">profile</span>?.<span class="property">token</span>;</span><br><span class="line">        <span class="keyword">if</span> (token)</span><br><span class="line">            options.<span class="property">header</span>.<span class="property">Authorization</span> = token;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&quot;request&quot;</span>, httpInterceptor);</span><br><span class="line">uni.<span class="title function_">addInterceptor</span>(<span class="string">&quot;uploadFile&quot;</span>, httpInterceptor);</span><br></pre></td></tr></table></figure><p>uniapp 中没有关于请求结果的拦截器，得用 Promise 手动封装。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//utils/http.ts</span></span><br><span class="line"><span class="comment">//接上个拦截器代码块</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//自己封装的数据类型</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Data</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="attr">code</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">msg</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">data</span>: T</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//封装uni-request，对数据结果进行统一处理，即拦截请求结果。上面的interceptor是请求发送前拦截。</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> http = &lt;T&gt;<span class="function">(<span class="params">options: UniApp.RequestOptions</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>&lt;<span class="title class_">Data</span>&lt;T&gt;&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        uni.<span class="title function_">request</span>(&#123;</span><br><span class="line">            ...options,</span><br><span class="line">            <span class="comment">//服务器有响应结果，不管状态码是200还是401亦或是500，都会走success函数。</span></span><br><span class="line">            <span class="title function_">success</span>(<span class="params">res</span>) &#123;</span><br><span class="line">                <span class="comment">//状态码正常，则resolve，axios内部也是如此实现的。</span></span><br><span class="line">                <span class="keyword">if</span> (res.<span class="property">statusCode</span> &gt;= <span class="number">200</span> &amp;&amp; res.<span class="property">statusCode</span> &lt; <span class="number">300</span>) &#123;</span><br><span class="line">                    <span class="comment">//用as对返回类型进行断言</span></span><br><span class="line">                    <span class="title function_">resolve</span>(res.<span class="property">data</span> <span class="keyword">as</span> <span class="title class_">Data</span>&lt;T&gt;);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">statusCode</span> == <span class="number">401</span>) &#123;</span><br><span class="line">                    <span class="comment">//401代表token无效，身份验证失败</span></span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Authorization error&quot;</span>);</span><br><span class="line">                    uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;身份验证失效，请重新登录&quot;</span> &#125;);</span><br><span class="line">                    <span class="title function_">reject</span>(res);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;服务器异常&quot;</span> &#125;);</span><br><span class="line">                    <span class="title function_">reject</span>(res);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//服务器没有返回结果，代表请求未成功发送，即网络异常。</span></span><br><span class="line">            <span class="title function_">fail</span>(<span class="params">err</span>) &#123;</span><br><span class="line">                uni.<span class="title function_">showToast</span>(&#123; <span class="attr">title</span>: <span class="string">&quot;网络异常，请检查网络&quot;</span> &#125;)</span><br><span class="line">                <span class="title function_">reject</span>(err);</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样一来，自己封装的网络请求模块就完成了。在需要的地方导入使用即可。</p><p>注：泛型 T 的使用是为了更好地处理数据。每个请求返回的 data 部分都是变化的，有的是字符数组，有的是对象数组，根据选择使用。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;http&#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">clickTest</span>(<span class="params"></span>)&#123;</span><br><span class="line">    userStore.<span class="title function_">setName</span>(<span class="string">&quot;Adong&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> http&lt;<span class="built_in">string</span>[]&gt;(&#123;</span><br><span class="line">      <span class="attr">method</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="attr">url</span>:<span class="string">&quot;/test&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当请求的结果有效，即 resolve 后，该 Promise 对象的状态会变成 fulfilled（已兑现），变量 res 有了有效值，继续执行下面的 log 语句。当请求的结果无效，即 reject 后，该 Promise 对象的状态变为 rejected（已拒绝），此时异步函数直接结束，不会执行下面的 log 语句。</p><p>注：Promise 对象的初始状态为 pending（待定）。</p><h3 id="uniapp知识点">uniapp知识点</h3><h4 id="svg">svg</h4><p>uniapp 中不支持 svg 标签，所以涉及到的 svg 图片可以转换成 base64 进行使用。</p><p><a href="https://www.zhangxinxu.com/sp/svgo/">SVG在线工具</a>。通过这个工具我们可以实现上述操作。我就用这个工具将 iconfont 上面的图标转换成了 base64 ，用 img 标签进行了插入。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;searchIcon&quot;</span>           <span class="attr">src</span>=<span class="string">&quot;data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTEwMjQgOTYzLjdMNzU2LjggNjk2LjVjNjAuMi03My42IDk2LjUtMTY3LjUgOTYuNS0yNjkuOEM4NTMuMyAxOTEuNCA2NjEuOSAwIDQyNi43IDBTMCAxOTEuNCAwIDQyNi43czE5MS40IDQyNi43IDQyNi43IDQyNi43YzEwMi4zIDAgMTk2LjMtMzYuMyAyNjkuOC05Ni41TDk2My43IDEwMjRsNjAuMy02MC4zek00MjYuNyA3NjhDMjM4LjUgNzY4IDg1LjMgNjE0LjkgODUuMyA0MjYuN1MyMzguNSA4NS4zIDQyNi43IDg1LjMgNzY4IDIzOC41IDc2OCA0MjYuNyA2MTQuOSA3NjggNDI2LjcgNzY4eiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg==&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="自定义导航栏">自定义导航栏</h4><p>设置 navigationStyle 为 custom 以取消默认导航栏。然后手写导航栏组件添加到页面中使用即可。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">// uni-ui 规则如下配置</span></span><br><span class="line"><span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="comment">//pages数组中第一项表示应用启动页，参考：https://uniapp.dcloud.io/collocation/pages</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;style&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">//取消默认导航栏</span></span><br><span class="line"><span class="attr">&quot;navigationStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;custom&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;white&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;globalStyle&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;uni-app&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// &quot;navigationBarBackgroundColor&quot;: &quot;#F8F8F8&quot;,</span></span><br><span class="line"><span class="comment">// &quot;backgroundColor&quot;: &quot;#F8F8F8&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="image标签">image标签</h4><p>uniapp 中不能使用 img 标签。使用 img 标签后，会被解析成 image 标签，导致为 img 写的 css 样式失效。</p><h4 id="样式隔离">样式隔离</h4><p>在某些情况下，比如我写了一个组件，里面用到了 uniapp 提供的内置组件，如 uni-file-picker ，当我尝试通过 vue 的样式穿透去修改内置组件的样式时，怎么改都不行，用上 !important 也不行，在调试的时候看穿透的样式根本没修改成功。这时候或许就是 uniapp 自带的样式隔离起了作用。使用以下代码进行样式隔离的取消，可以解决问题。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    options: &#123;</span><br><span class="line">        styleIsolation: &#x27;shared&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>非常傻逼的一个问题。<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/wxml-wxss.html#%E7%BB%84%E4%BB%B6%E6%A0%B7%E5%BC%8F%E9%9A%94%E7%A6%BB">样式隔离。</a>这个文档是微信官方文档，因此推断是微信小程序的特有设定。</p><h4 id="禁止手指滑动">禁止手指滑动</h4><p>在自定义的加载遮罩显示时，需要禁止手指滑动，以防下面的页面被滑动。</p><p>在最外层添加 @touchmove.stop.prevent=&quot;() =&gt; { }&quot; 。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div @touchmove.stop.prevent=&quot;() =&gt; &#123; &#125;&quot; class=&quot;loading&quot; :class=&quot;&#123; alignTop: ifAlignTop, alignBottom: !ifAlignTop &#125;&quot;</span><br><span class="line">        v-if=&quot;isLoading&quot;&gt;</span><br><span class="line">        &lt;uni-load-more icon-type=&quot;circle&quot; color=&quot;white&quot; status=&quot;loading&quot; :icon-size=&quot;30&quot;</span><br><span class="line">            :content-text=&quot;&#123; contentrefresh: content, contentdown: &#x27;&#x27;, contentnomore: &#x27;&#x27; &#125;&quot; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h4 id="自定义遮罩的位置问题">自定义遮罩的位置问题</h4><p>在 uniapp 中，App.vue 文件中并不能写 template ，所以全局遮罩并不方便实现。 所以需要定义一个遮罩组件，在每个页面分别引入使用。</p><p>然而，遮罩放在每个页面的根节点下有时也并不方便。举个例子，遮罩的高度一般是100vh，假设我通过绝对定位对页面进行上左对齐，当页面可以滚动的时候，即页面高度大于100vh的时候，如果我在页面底部触发了遮罩，由于遮罩高度不够，页面底部就是无遮罩状态。如果我对遮罩的高度预设成300vh，可以达到遮住底部的效果，但是遮罩中间的加载用的提示信息又跑到了别处，而不在屏幕中间。想要动态控制遮罩的高度或者其中的文字位置是不现实的，每个页面的高度都不一样，而 uniapp 中又不容易获取滚动高度。</p><p><s>因此，固定遮罩的高度为100vh，尝试调整遮罩的引入位置以及对齐位置才是更合理的做法。比如我在页面底部触发了从底部弹出的弹出层，那么封装一个组件，引入弹出层和遮罩层，将自定义组件标记为相对定位，遮罩层标记为绝对定位，并使遮罩下左对齐。</s></p><h4 id="scroll-view-滚动条问题">scroll-view 滚动条问题</h4><p>在微信小程序中，仅设置 show-scrollbar = “false” 是没用的，同时还要设置 enhanced = “true”。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;scroll-view :scroll-y=&quot;true&quot; class=&quot;cats&quot; :show-scrollbar=&quot;false&quot; :enhanced=&quot;true&quot;&gt;</span><br><span class="line">        &lt;div :key=&quot;index&quot; v-for=&quot;(cat, index) in categories&quot; class=&quot;cat&quot; :class=&quot;&#123; catActive: catIsActive(index) &#125;&quot;</span><br><span class="line">            @click=setActive(index)&gt;</span><br><span class="line">            &lt;text&gt;&#123;&#123; cat.name &#125;&#125;&lt;/text&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">&lt;/scroll-view&gt;</span><br></pre></td></tr></table></figure><p>别用uniapp的这个组件写 flex 布局。因为flex布局中的 align-content 会无效，调了一下午没吊用。🐕都不用。自己写的 flex 布局盒子好用的一批。</p><h4 id="第三方组件引入问题">第三方组件引入问题</h4><p>以 NutUi 为例，配置 easycom 自动导入的代码如下所示。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;easycom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;autoscan&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;custom&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="comment">// uni-ui 规则如下配置</span></span><br><span class="line"><span class="attr">&quot;^uni-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@dcloudio/uni-ui/lib/uni-$1/uni-$1.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;^nut-(.*)?-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nutui-uniapp/components/$1$2/$1$2.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;^nut-(.*)&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nutui-uniapp/components/$1/$1.vue&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>可以看到引入规则中的组件名称是短横线命名法。因此在使用组件时，也应使用短横线命名，因为大驼峰命名会导致自动引入出问题，我甚至曾怀疑是 uniapp 的问题，毕竟是真不太好用。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 有效 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">nut-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span>&gt;</span>TEST<span class="tag">&lt;/<span class="name">nut-button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 无效 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;NutButton type=&quot;danger&quot;&gt;TEST&lt;/NutButton&gt; --&gt;</span></span><br></pre></td></tr></table></figure><p>当然有时也会出现大驼峰名称能用的情况，这种情况通常是短横线名称的组件以意想不到的方式被引入了。比如上面代码中两种写法，如果同时存在，你会发现大驼峰形式的也能正常用，因为短横线写法已经引入了这个组件。至于为什么大驼峰不能正常引入组件，我只能猜测 easycom 就是浅显地凭借所写标签名称进行自动引入的。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> uniapp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用nrm管理npm镜像源</title>
      <link href="/2024/02/04/NpmMirrorManage.html"/>
      <url>/2024/02/04/NpmMirrorManage.html</url>
      
        <content type="html"><![CDATA[<h3 id="安装nrm">安装nrm</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g nrm</span><br></pre></td></tr></table></figure><h3 id="查看镜像源">查看镜像源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><h3 id="选用镜像源">选用镜像源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm use xxx</span><br></pre></td></tr></table></figure><p>比如<strong>nrm use taobao</strong>。当 npm 命令卡进度的时候，请先查看当前源是否是镜像源，因为在2024年6月22日这天突然发现变回了默认源，切换为镜像源后恢复正常。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基础算法</title>
      <link href="/2024/01/15/AlgorithmAcBase1.html"/>
      <url>/2024/01/15/AlgorithmAcBase1.html</url>
      
        <content type="html"><![CDATA[<h3 id="快速排序">快速排序</h3><ol><li>选取基准值（分界值）x，可以是数组的第一个元素，也可以是数组的最后一个元素，中间元素亦可。</li><li>使用双指针<strong> i  </strong>和 <strong>j</strong> 从数组的两端开始扫描，从左端找到一个<strong>&gt;=x</strong>的值a，从右端找到一个<strong>&lt;=x</strong>的值b，交换ab的值，交换后<strong>i以及i之前的元素</strong>都小于等于x，<strong>j以及j之后的元素</strong>都大于等于x。交换后i应递增，j应递减，继续查找可以交换的值，知道ij相遇甚至错开（i &gt; j）。</li><li>当数组成功划分两部分，左部分小于等于x，右部分大于等于x的时候，左右两部分分别递归调用快速排序。</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> t[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quick_sort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> i = l - <span class="number">1</span>, j = r + <span class="number">1</span>, x = t[(l + r) / <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(i &lt; j)&#123;</span><br><span class="line">        <span class="comment">//基准值元素也可以交换，在左区间或者右区间都可以，因此while (t[i] &lt; x);没有等号=。</span></span><br><span class="line">        <span class="comment">//如果是不能交换，即while (t[i] &lt;= x);</span></span><br><span class="line">        <span class="comment">//那么比如6 2 3，基准值为2时。从左边找到了一个比2大的值6，但是从右边找不到比2小的，j--会一直执行，死循环了。</span></span><br><span class="line">        <span class="keyword">do</span> i++; <span class="keyword">while</span> (t[i] &lt; x);</span><br><span class="line">        <span class="keyword">do</span> j--; <span class="keyword">while</span> (t[j] &gt; x);</span><br><span class="line">        <span class="keyword">if</span>(i &lt; j) <span class="built_in">swap</span>(t[i],t[j]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*在划分区间递归调用快排的时候，i==j或者i&gt;j</span></span><br><span class="line"><span class="comment">     ①当i==j时，举例数组为2 1. l==0，r==1。区间为[0,1]。</span></span><br><span class="line"><span class="comment">        x = t[(l + r) / 2];取值为x=2，相当于取数组首元素为基准值，经过循环后i==j==0。</span></span><br><span class="line"><span class="comment">        正确的分法：划分区间应为[0,0]和[1,1]，即[l, j]和[j + 1, r]，或者将j换成i。</span></span><br><span class="line"><span class="comment">        也就是将相遇处的元素划分给右区间。</span></span><br><span class="line"><span class="comment">        错误的分法：如果划分给左区间，即[l, j - 1]和[j, r]的话，区间为[0,-1]和[0,1]。</span></span><br><span class="line"><span class="comment">        右区间的快排与当前快排区间相同，导致右区间递归与当前相同，陷入死循环。</span></span><br><span class="line"><span class="comment">        若想使得该分法正确，应当x = t[(l + r + 1) / 2]，即取数组尾元素为基准值。</span></span><br><span class="line"><span class="comment">     ②当i&gt;j时。举例，在上一轮while中交换ij元素后，进入下一轮while循环前，</span></span><br><span class="line"><span class="comment">        i == 1, j == 2，进入循环后，i++变成2，j--变成1，此时发生i &gt; j的情况。且&lt;2的元素&lt;=x, &gt;1的元素&gt;=x。</span></span><br><span class="line"><span class="comment">        这种情况下划分区间时，根据①的两种分法，为了保证划分的正确性:</span></span><br><span class="line"><span class="comment">        若取数组首元素为基准值，则应采用j,即[l, j]和[j + 1, r]。</span></span><br><span class="line"><span class="comment">        如果采用[l, i]和[i + 1, r]，右区间为[3, r]很显然缺少了下标2对应的&gt;=x的元素，同理左区间会多一个。</span></span><br><span class="line"><span class="comment">        若取数组尾元素为基准值，则应采用i,即[l, i - 1]和[i, r]。原理同上。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     总结：一整个快速排序中包含很多个小快速排序，可能出现i==j和i&gt;j的情况。因此，为了确保两种情况下都正常运行，分类如下。</span></span><br><span class="line"><span class="comment">     ①x = t[(l + r) / 2];或者说取左端点元素为基准值的情况下，递归区间划分[l, j]和[j + 1, r]。</span></span><br><span class="line"><span class="comment">     ②x = t[(l + r + 1) / 2]；或者说取右端点元素为基准值的情况下，递归区间划分[l, i - 1]和[i, r]。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">quick_sort</span>(l,j);</span><br><span class="line">    <span class="built_in">quick_sort</span>(j + <span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;t[i]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">quick_sort</span>(<span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,t[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="归并排序">归并排序</h3><ol><li>数组一分为二，递归调用归并排序。</li><li>利用双指针，合并一分为二的数组，将结果存到额外数组 tmp 中。</li><li>合并完成后，将结果数组覆盖至原数组中。</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/16.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> t[N], tmp[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge_sort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//右移等同除以二</span></span><br><span class="line">    <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从数组中间一分为二，各自归并排序</span></span><br><span class="line">    <span class="built_in">merge_sort</span>(l, mid), <span class="built_in">merge_sort</span>(mid + <span class="number">1</span>, r);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//k是结果数组的下一个放置元素的位置，ij为数组左右两部分的起始指针</span></span><br><span class="line">    <span class="type">int</span> k = <span class="number">0</span>, i = l, j = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//比较ij指针值的大小，择其小存于结果中</span></span><br><span class="line">    <span class="keyword">while</span>(i &lt;= mid &amp;&amp; j &lt;= r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(t[i] &lt;= t[j]) tmp[k++] = t[i++];</span><br><span class="line">        <span class="keyword">else</span> tmp[k++] = t[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//当某一部分已经全部加入结果后，另一部分的剩余元素直接加入结果</span></span><br><span class="line">    <span class="keyword">while</span>(i &lt;= mid) tmp[k++] = t[i++];</span><br><span class="line">    <span class="keyword">while</span>(j &lt;= r) tmp[k++] = t[j++];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用有序的结果覆盖原来无序的数组</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = l, j = <span class="number">0</span>; i &lt;= r; i++,j++)</span><br><span class="line">        t[i] = tmp[j];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t[i]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">merge_sort</span>(<span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="归并排序的应用-求解逆序对数量">归并排序的应用——求解逆序对数量</h4><p>对于任意给定的数字序列，举例如<strong> 4 3 2 1 </strong>，若交换相邻元素，可以减少一个逆序对而不影响这两个元素于其它元素的逆序关系。此处交换<strong> 4 , 3 </strong>会得到<strong> 3 4 2 1 </strong>，可以发现，前半部分元素与后半部分的逆序关系保持不变，前半部分内部消除了一个逆序对。</p><p>因此，我们可以考虑将数组一分为二，左右两部分分别消除内部逆序对，得到两个有序的序列，再消除序列之间的逆序对。若有两个有序序列为<strong> 2 4 6 </strong>和<strong> 1 3 5 </strong>，使用双指针分别指向两个序列开头，将序列2的小元素移到大序列的前面，比如1移到2的前面，越过了2 4 6三个元素，那么就减少了三个逆序对。多次操作，直到大序列整体有序。</p><p>很显然，上述的操作就是归并排序的一种表现。将数组不断地一分为二，当一组只有两个元素的时候，对这一组一分为二成两个序列，每个序列一个元素，使用双指针归并后，表现为逆序的两个元素交换位置。同样长度为2的毗邻序列各自有序，同样可以使用双指针进行逆序对的消除。</p><p>因此，求解逆序对的数量，我们只需要在归并排序中，保存序列2元素越过的序列1元素个数即可。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/17.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//逆序对的数量</span></span><br><span class="line"><span class="comment">//https://www.acwing.com/problem/content/790/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> t[N], tmp[N];</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> counts = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calculate_reverse_pair</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">calculate_reverse_pair</span>(l, mid), <span class="built_in">calculate_reverse_pair</span>(mid + <span class="number">1</span>, r);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> k = <span class="number">0</span>, i = l, j = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= mid &amp;&amp; j &lt;= r)&#123;</span><br><span class="line">        <span class="keyword">if</span>(t[i] &lt;= t[j]) &#123;</span><br><span class="line">            tmp[k++] = t[i++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            tmp[k++] = t[j++];</span><br><span class="line">            <span class="comment">//将后半部分的小元素移到前半部分时，越过的前半部分元素个数即为逆序对个数</span></span><br><span class="line">            counts += (mid - i + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= mid) tmp[k++] = t[i++];</span><br><span class="line">    <span class="keyword">while</span>(j &lt;= r) tmp[k++] = t[j++];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = l, j = <span class="number">0</span>; i &lt;= r; i++, j++)</span><br><span class="line">        t[i] = tmp[j];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;t[i]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">calculate_reverse_pair</span>(<span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, counts);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="二分">二分</h3><p>二分就是寻找一个边界，将整个数组一分为二，一边满足性质，另一边不满足。</p><h4 id="整数二分">整数二分</h4><p><a href="https://www.acwing.com/problem/content/791/">AcWing—数的范围</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/16.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> t[N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line">            <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//查找x1位置时，x1以及其后元素都满足&gt;=x这个性质</span></span><br><span class="line">            <span class="comment">//当mid对应元素满足性质时，x1应在mid或者mid前，更新右区间为mid</span></span><br><span class="line">            <span class="keyword">if</span>(t[mid] &gt;= x) r = mid;</span><br><span class="line">            <span class="comment">//当mid对应元素不满足性质时，x1应在mid后，更新左区间为mid + 1.</span></span><br><span class="line">            <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(t[l] != x) <span class="built_in">printf</span>(<span class="string">&quot;-1 -1\n&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, l);</span><br><span class="line">            <span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line">                <span class="comment">//在l == mid == r - 1时，若是t[mid]满足性质，左区间会更新为mid</span></span><br><span class="line">                <span class="comment">//为防止死循环，mid应上取整</span></span><br><span class="line">                <span class="type">int</span> mid = l + r + <span class="number">1</span> &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="comment">//查找x_last元素位置时，x_last及其前面元素满足&lt;=x的性质</span></span><br><span class="line">                <span class="comment">//当mid对应元素满足该性质时，x_last应在mid或者mid后，更新左区间为mid</span></span><br><span class="line">                <span class="comment">//当mid对应元素不满足时，x_last应在mid前，更新右区间为mid - 1</span></span><br><span class="line">                <span class="keyword">if</span>(t[mid] &lt;= x) l = mid;</span><br><span class="line">                <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, l);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="浮点数二分">浮点数二分</h4><p><a href="https://www.acwing.com/problem/content/792/">AcWing—三次方根</a></p><p>在求解次方根的问题中，需要注意，当x处于(0,1)的区间内时，其n次方根的结果会大于x。比如0.01的平方根是0.1。因此在使用二分求解n次方根的时候，我们需要将右边界加1。</p><p>二分结束的条件设置为一定的精度，比如当结果保留6位小数的时候，我们可以设置精度为1e-8，保留7位则1e-9，以此类推。确保结果的准确性。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/16.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;x);</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> aboveZero = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; <span class="number">0</span>) aboveZero = <span class="literal">false</span>, x = <span class="number">0</span> - x;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> l = <span class="number">0</span>, r = x + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(r - l &gt; <span class="number">1e-8</span>)&#123;</span><br><span class="line">        <span class="type">double</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(mid*mid*mid &gt;= x) r = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lf&quot;</span>, !aboveZero?-l:l);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="高精度">高精度</h3><h4 id="加法">加法</h4><p>利用数组存储两个很长很长的数。数的高位存在数组的后面，地位存在数组的前面。这样一来，加法最高位进位的时候，可以方便地在数的最高位前面补上进位数。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">add</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;A, vector&lt;<span class="type">int</span>&gt; &amp;B)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; C;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; t != <span class="number">0</span> || i &lt; A.<span class="built_in">size</span>() || i &lt; B.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; A.<span class="built_in">size</span>()) t += A[i];</span><br><span class="line">        <span class="keyword">if</span>(i &lt; B.<span class="built_in">size</span>()) t += B[i];</span><br><span class="line">        C.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t = t &gt;= <span class="number">10</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string a, b;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; A, B;</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = a.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) A.<span class="built_in">push_back</span>(a[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = b.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) B.<span class="built_in">push_back</span>(b[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> C = <span class="built_in">add</span>(A, B);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(C.<span class="built_in">size</span>() != <span class="number">0</span>)&#123;</span><br><span class="line">        cout &lt;&lt; C.<span class="built_in">back</span>();</span><br><span class="line">        C.<span class="built_in">pop_back</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="减法-正减正">减法（正减正）</h4><p>类似加法，注意借位即可。为了方便，我们可以提前判断运算数的大小，始终用大的减小的。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//比较两个数的大小</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;A, vector&lt;<span class="type">int</span>&gt; &amp;B)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(A.<span class="built_in">size</span>() != B.<span class="built_in">size</span>()) <span class="keyword">return</span> A.<span class="built_in">size</span>() &gt;= B.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = A.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(A[i] &gt; B[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(A[i] &lt; B[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sub</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;A, vector&lt;<span class="type">int</span>&gt; &amp;B)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; C;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; t != <span class="number">0</span> || i &lt; A.<span class="built_in">size</span>() || i &lt; B.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="comment">//A位减去被借的位</span></span><br><span class="line">        <span class="keyword">if</span>(i &lt; A.<span class="built_in">size</span>()) t = A[i] - t;</span><br><span class="line">        <span class="comment">//再减B位</span></span><br><span class="line">        <span class="keyword">if</span>(i &lt; B.<span class="built_in">size</span>()) t -= B[i];</span><br><span class="line">        <span class="comment">//若位运算结果为负数，代表需要借位。+10取余为借位后的结果。若不需借位也无妨，+10取余为0。</span></span><br><span class="line">        C.<span class="built_in">push_back</span>((t + <span class="number">10</span>) % <span class="number">10</span>);</span><br><span class="line">        <span class="comment">//保存借位</span></span><br><span class="line">        t = t &lt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//去除最高位前面的0.比如运算结果为003，则去掉00，保留结果为3.</span></span><br><span class="line">    <span class="keyword">while</span>(C.<span class="built_in">size</span>() &gt; <span class="number">1</span> &amp;&amp; C.<span class="built_in">back</span>() == <span class="number">0</span>)</span><br><span class="line">        C.<span class="built_in">pop_back</span>();</span><br><span class="line">    <span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string a, b;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; A, B;</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = a.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) A.<span class="built_in">push_back</span>(a[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = b.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) B.<span class="built_in">push_back</span>(b[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将小数-大数转换成-（大数-小数）</span></span><br><span class="line">    <span class="type">bool</span> a_greater = <span class="built_in">cmp</span>(A, B);</span><br><span class="line">    <span class="keyword">auto</span> C = a_greater ? <span class="built_in">sub</span>(A, B) : <span class="built_in">sub</span>(B, A);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果是小数-大数，则在结果前面添加负号</span></span><br><span class="line">    <span class="keyword">if</span>(!a_greater) <span class="built_in">printf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(C.<span class="built_in">size</span>() != <span class="number">0</span>)&#123;</span><br><span class="line">        cout &lt;&lt; C.<span class="built_in">back</span>();</span><br><span class="line">        C.<span class="built_in">pop_back</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="乘法">乘法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/22.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//乘法的实质就是123 * 4 = 100 * 4 + 20 * 4 + 3 * 4.结果的个位诞生于最低位乘以4，十位诞生于十位乘以4加上个位进的位</span></span><br><span class="line"><span class="comment">//以此类推。</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">mul</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;A, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; C;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//大数每一位乘以小数，并加上低位进的位，得到的结果最后一位，为当前位的数，结果的其余位都是进位。</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; A.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        t += A[i] * b;</span><br><span class="line">        C.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t) C.<span class="built_in">push_back</span>(t);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(C.<span class="built_in">size</span>() &gt; <span class="number">1</span> &amp;&amp; C.<span class="built_in">back</span>() == <span class="number">0</span>) C.<span class="built_in">pop_back</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string a;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; A;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = a.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) A.<span class="built_in">push_back</span>(a[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> C = <span class="built_in">mul</span>(A, b);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = C.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, C[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="除法">除法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/22.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">div</span><span class="params">(vector&lt;<span class="type">int</span>&gt; A, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; C;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从大数高位开始除</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = A.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        t = t * <span class="number">10</span> + A[i];</span><br><span class="line">        <span class="comment">//能除就除</span></span><br><span class="line">        <span class="keyword">if</span>(t &gt;= b) C.<span class="built_in">push_back</span>(t / b), t = t % b;</span><br><span class="line">        <span class="comment">//不能除，商就置零</span></span><br><span class="line">        <span class="keyword">else</span> C.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//翻转数组，并去除高位0。</span></span><br><span class="line">    <span class="built_in">reverse</span>(C.<span class="built_in">begin</span>(), C.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">while</span>(C.<span class="built_in">size</span>() &gt; <span class="number">1</span> &amp;&amp; C.<span class="built_in">back</span>() == <span class="number">0</span>) C.<span class="built_in">pop_back</span>();</span><br><span class="line">    <span class="comment">//翻转回来，把最终的余数补在数组最后面</span></span><br><span class="line">    <span class="built_in">reverse</span>(C.<span class="built_in">begin</span>(), C.<span class="built_in">end</span>());</span><br><span class="line">    C.<span class="built_in">push_back</span>(t);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string a;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; A;</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = a.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) A.<span class="built_in">push_back</span>(a[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> C = <span class="built_in">div</span>(A, b);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; C.<span class="built_in">size</span>() - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, C[i]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n%d&quot;</span>, C.<span class="built_in">back</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="前缀与差分">前缀与差分</h3><h4 id="前缀和-一维">前缀和（一维）</h4><p>对于一个普通的一维数组（从 a1 =  a[1] 开始，a[0] = 0），前n项和称为前缀和。通过Sn - S(k-1)可以得到S[k,n]的部分和。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/23.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> a[N], s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) s[i] = s[i - <span class="number">1</span>] + a[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="type">int</span> l, r;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, s[r] - s[l - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="子矩阵的和">子矩阵的和</h4><p><a href="https://www.acwing.com/problem/content/798/">796. 子矩阵的和 - AcWing题库</a></p><p>要求解一个矩阵的子矩阵的元素和，只需要想象一个矩阵，切割成十字形，按需拼凑即可。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/23.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="type">int</span> a[N][N], s[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//n行m列，q个询问</span></span><br><span class="line">    <span class="type">int</span> n, m, q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;=m; j++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             *  a11 a12 | a13</span></span><br><span class="line"><span class="comment">             *  a21 a22 | a23</span></span><br><span class="line"><span class="comment">             *  --------|----</span></span><br><span class="line"><span class="comment">             *  a31 a32 | a33</span></span><br><span class="line"><span class="comment">             * 比如s[3][3] = s[3][2] + s[2][3] - s[2][2]（这是去除重复加的部分）+ a[3][3]</span></span><br><span class="line"><span class="comment">             * */</span></span><br><span class="line">            s[i][j] = s[i][j - <span class="number">1</span>] + s[i - <span class="number">1</span>][j] - s[i - <span class="number">1</span>][j - <span class="number">1</span>] + a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        <span class="type">int</span> x1, y1, x2, y2;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;x1, &amp;y1, &amp;x2, &amp;y2);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         *  a11 a12 a13 | a14 a15</span></span><br><span class="line"><span class="comment">         *  a21 a22 a23 | a24 a25</span></span><br><span class="line"><span class="comment">         *  ------------|--------</span></span><br><span class="line"><span class="comment">         *  a31 a32 a33 | a34 a35</span></span><br><span class="line"><span class="comment">         *  a41 a42 a43 | a44 a45</span></span><br><span class="line"><span class="comment">         * s[[3][4], [4][5]] = s[4][5] - s[4][3] - s[2][5] + s[2][3]（补回多减的重叠部分）</span></span><br><span class="line"><span class="comment">         * 实际上，这里的s[[3][4], [4][5]]整体类似于上一个注释位置中的a[3][3]，都是被夹的一部分，只是包含数据个数不同的区别。</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, s[x2][y2] - s[x2][y1 - <span class="number">1</span>] - s[x1 - <span class="number">1</span>][y2] + s[x1 - <span class="number">1</span>][y1 - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="差分">差分</h3><h4 id="一维差分">一维差分</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/25.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="comment">//a数组为前缀和数组，b为差分数组</span></span><br><span class="line"><span class="type">int</span> a[N], b[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="comment">//对于前缀和数组a而言，要使[l, r]的前缀和+c</span></span><br><span class="line">    <span class="comment">//只需使差分数组b的第l位元素+c，这会让l及其以后的前缀和+c</span></span><br><span class="line">    <span class="comment">//然后第r+1位元素-c，这会让r+1及其以后的前缀和-c，即[r + 1, ?]的前缀和保持不变。</span></span><br><span class="line">    b[l] += c;</span><br><span class="line">    b[r + <span class="number">1</span>] -= c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始时，将a和b都看作全为零的的数组，前缀和和差分都为0。</span></span><br><span class="line">    <span class="comment">//然后输入数组a。</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将输入的数组a看作待添加的元素c，即区间[i,i]上的元素都加上常数c（a[i]）。</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">insert</span>(i, i, a[i]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//同样的执行m次insert即可。</span></span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="type">int</span> l, r, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;c);</span><br><span class="line">        <span class="built_in">insert</span>(l, r, c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//计算前缀和。</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) b[i] += b[i - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, b[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="二维差分">二维差分</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2024/1/27.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="type">int</span> a[N][N], b[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> c)</span></span>&#123;</span><br><span class="line">    b[x1][y1] += c;</span><br><span class="line">    b[x2 + <span class="number">1</span>][y1] -= c;</span><br><span class="line">    b[x1][y2 + <span class="number">1</span>] -= c;</span><br><span class="line">    b[x2 + <span class="number">1</span>][y2 + <span class="number">1</span>] += c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m, q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化差分数组</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">            <span class="built_in">insert</span>(i, j, i, j, a[i][j]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//更新差分数组</span></span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        <span class="type">int</span> x1, y1, x2, y2, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d&quot;</span>, &amp;x1, &amp;y1, &amp;x2, &amp;y2, &amp;c);</span><br><span class="line">        <span class="built_in">insert</span>(x1, y1, x2, y2, c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//更新前缀和数组</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">            a[i][j] = a[i][j - <span class="number">1</span>] + a[i - <span class="number">1</span>][j] - a[i - <span class="number">1</span>][j - <span class="number">1</span>] + b[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[i][j]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据结构——基础问题</title>
      <link href="/2023/11/02/AlgorithmForGraduateTest.html"/>
      <url>/2023/11/02/AlgorithmForGraduateTest.html</url>
      
        <content type="html"><![CDATA[<h2 id="六-哈夫曼树">六、哈夫曼树</h2><h3 id="1-合并果子">1.合并果子</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2023/10/31.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//https://www.acwing.com/problem/content/150/</span></span><br><span class="line"><span class="comment">//使用哈夫曼树的知识合并果子堆，计算最小花费体力</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//定义一个优先队列，第一个参数是队列元素的类型，第二个是使用的容器类型，第三个是排序方式。</span></span><br><span class="line">    <span class="comment">//此处使用升序排序，即小的元素优先出队。</span></span><br><span class="line">    priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt;&gt; stones_heap;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">while</span> (n--)&#123;</span><br><span class="line">        <span class="type">int</span> stones;</span><br><span class="line">        cin&gt;&gt;stones;</span><br><span class="line">        stones_heap.<span class="built_in">push</span>(stones);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> strength_used = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (stones_heap.<span class="built_in">size</span>() &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">//取出最小的两个结点（果子堆）</span></span><br><span class="line">        <span class="type">int</span> min1 = stones_heap.<span class="built_in">top</span>();</span><br><span class="line">        stones_heap.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> min2 = stones_heap.<span class="built_in">top</span>();</span><br><span class="line">        stones_heap.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="comment">//将这两个果子堆合并</span></span><br><span class="line">        stones_heap.<span class="built_in">push</span>(min1 + min2);</span><br><span class="line">        <span class="comment">//累计合并果子堆花费的体力</span></span><br><span class="line">        strength_used += (min1 + min2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;strength_used;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-荷马史诗">2.荷马史诗</h3><p>​K叉哈夫曼树的问题类似于二叉哈夫曼树。需要注意的点是，在K叉哈夫曼树中，我们每次合并结点都会取出最小的K个结点，在我们进行最后一次合并的时候，可能存在的结点个数不足K个。</p><p>​如1，2，3，4，5，6  ——&gt; 6（1，2，3），4，5，6 ——&gt; 6（1，2，3），15（4，5，6）.</p><p>​这时候我们需要补充零结点进去充数。 6（1，2，3），15（4，5，6），0 ——&gt; 21（6，15）.然后我们会发现，将二层的0和底部的6交换，会让K叉树的结果变好。所以，我们应在开始合并前就补充零结点，使得刚好其元素个数刚好能构建K叉哈夫曼树。</p><p>​这时候我们可以分析什么时候该补充零结点。我们每次合并结点都会将K个结点合并成一个结点，减少了K-1个结点。刚开始N个元素，全部合并后仅剩1个元素，减少了N-1个结点。每次合并减少K-1个，共需减少N-1个，合并次数为（N-1）/ (K-1)。即不能整除的时候，说明需要补充零结点。</p><p>​由于荷马史诗的编码要求编码树的高度最小，所以在合并结点的时候，除了选择最小的K个结点，还要在节点值相同的时候，优先选择结点展开的子树高度（深度）最小的结点。</p><p>​比如，1，3，4，3 ——&gt; 4（1，3），4，3 。根据值最小原则，可以选第一个4，也可以选第二个4，与3合并。很显然，前者合并到最后的高度为3，后者为2。所以在合并的时候，我们应尽量往矮的结点上合并。就像俄罗斯方块，合并的恰到好处才不容易到达顶端。我想大多数人都是优先平铺方块再垂直放的吧。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2023/11/1.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//https://www.acwing.com/problem/content/151/</span></span><br><span class="line"><span class="comment">//荷马史诗</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;algorithm&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;queue&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;vector&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//define a pair of data. long long for word_code and int for Huffman coding node depth.</span></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">long</span> <span class="type">long</span>, <span class="type">int</span>&gt; PLI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    priority_queue&lt;PLI, vector&lt;PLI&gt;, greater&lt;&gt;&gt; words;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//k is the system of numeration</span></span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> words_num, k;</span><br><span class="line">    cin&gt;&gt;words_num&gt;&gt;k;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (words_num--)&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> word;</span><br><span class="line">        cin&gt;&gt;word;</span><br><span class="line">        words.<span class="built_in">push</span>(&#123;word, <span class="number">0</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//every loop for merge will delete k nodes and add a combined node,</span></span><br><span class="line">    <span class="comment">//so k-1 nodes decrease in each merge.</span></span><br><span class="line">    <span class="comment">//the loop will continues until there is only one node.</span></span><br><span class="line">    <span class="comment">//loop time = (words_num - 1) / (k-1).</span></span><br><span class="line">    <span class="comment">//if the time is not a integer, just add zero node until it can be a integer.</span></span><br><span class="line">    <span class="keyword">while</span> ((words.<span class="built_in">size</span>() - <span class="number">1</span>) % (k - <span class="number">1</span>) != <span class="number">0</span>)</span><br><span class="line">        words.<span class="built_in">push</span>(&#123;<span class="number">0</span>,<span class="number">0</span>&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//the with power length is the new coded book length</span></span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> wpl = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (words.<span class="built_in">size</span>() &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span>  combined_node_val = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> max_depth = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">            <span class="comment">//get the min node</span></span><br><span class="line">            <span class="keyword">auto</span> min_node = words.<span class="built_in">top</span>();</span><br><span class="line">            <span class="comment">//merge</span></span><br><span class="line">            combined_node_val += min_node.first;</span><br><span class="line">            <span class="comment">//save the highest son-tree&#x27;s depth</span></span><br><span class="line">            max_depth = <span class="built_in">max</span>(max_depth, min_node.second);</span><br><span class="line">            <span class="comment">//delete the node</span></span><br><span class="line">            words.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//add the combined node.</span></span><br><span class="line">        words.<span class="built_in">push</span>(&#123;combined_node_val,max_depth + <span class="number">1</span>&#125;);</span><br><span class="line">        <span class="comment">//the new combined node value is a part of the WPL.</span></span><br><span class="line">        wpl += combined_node_val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;wpl&lt;&lt;endl&lt;&lt;words.<span class="built_in">top</span>().second;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="七-拓扑排序-有向图问题">七、拓扑排序（有向图问题）</h2><h3 id="1-基于广搜-广度优先遍历-的拓扑排序实现方法">1.基于广搜（广度优先遍历）的拓扑排序实现方法</h3><p>​广度优先遍历（BFS），实际上就是一层一层地遍历。</p><ol><li>将第一个顶点入队</li><li>队列出队，将出队的顶点连接的顶点进行入队，我简称为出队展开。</li><li>重复步骤2直到队列为空</li></ol><ul><li>注意，需要开一个数组保存顶点是否被遍历过。顶点入队的时候，就该标记为被遍历过了，防止重复入队（比如出现回环的时候，A&lt;—&gt;B，A出队会B会入队，B出队A会入队，会出现死循环）。</li></ul><p>​拓扑排序实现方式</p><pre><code>1. 入队的标准改为：入度为0的顶点才能入队。2. 当顶点入队的时候，将该顶点可以通往顶点的入度减1（即在图中隐藏该入队的顶点，代表该工程任务结束）3. 简单来说，就是在BFS出队展开时，只让入度为0的顶点入队（即只有前置任务全部完成，才能将新的任务加入执行清单）。</code></pre><ul><li>需要开一个数组维护每个顶点的入度。</li><li>因为只有入度为0的才能入队，重边，或者回环，都会导致度不为0无法入队，所以不需要BFS那个判断是否被遍历过的数组。</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by Kahiva on 2023/11/5.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//https://www.acwing.com/problem/content/850/</span></span><br><span class="line"><span class="comment">//拓扑排序(采用广度遍历实现)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;algorithm&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;queue&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//n个顶点m条边</span></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="comment">//定义一个常量N，即最大可能用到的顶点数。定义入度数组和模拟队列的数组时可以用到。</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="type">int</span> nodeId;</span><br><span class="line">    Node* next;</span><br><span class="line">    <span class="built_in">Node</span>(<span class="type">int</span> id):<span class="built_in">nodeId</span>(id), <span class="built_in">next</span>(<span class="literal">NULL</span>)&#123;&#125;;</span><br><span class="line">&#125;*link[N];</span><br><span class="line"></span><br><span class="line"><span class="comment">//保存各顶点的入度</span></span><br><span class="line"><span class="type">int</span> inDegree[N];</span><br><span class="line"><span class="comment">//采用数组模拟队列，出队移动头索引，入队移动尾索引。这样可以在模拟队列的同时，保留原队列中的元素。</span></span><br><span class="line"><span class="type">int</span> checkQueue[N];</span><br><span class="line"></span><br><span class="line"><span class="comment">//将某个点和另一个点的边加入邻接表表示的图中。</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addLink</span><span class="params">(<span class="type">int</span> fromNodeId, <span class="type">int</span> toNodeId)</span></span>&#123;</span><br><span class="line">    Node* node = <span class="keyword">new</span> <span class="built_in">Node</span>(toNodeId);</span><br><span class="line">    node-&gt;next = link[fromNodeId];</span><br><span class="line">    link[fromNodeId] = node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">topSort</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//head指向队头，rear指向队列最后一个元素</span></span><br><span class="line">    <span class="type">int</span> head = <span class="number">0</span>, rear = <span class="number">-1</span>;</span><br><span class="line">    <span class="comment">//因为顶点编号从1开始，所以入度数组从索引1开始遍历</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="comment">//遍历顶点，如果顶点入度为0，就入队</span></span><br><span class="line">        <span class="keyword">if</span> (!inDegree[i])&#123;</span><br><span class="line">            checkQueue[++rear] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (head &lt;= rear)&#123;</span><br><span class="line">        <span class="comment">//取出队头元素</span></span><br><span class="line">        <span class="keyword">auto</span> top = checkQueue[head++];</span><br><span class="line">        <span class="comment">//遍历它的邻边，将邻边那头对应点的入度减一</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> p = link[top]; p ; p = p-&gt;next)&#123;</span><br><span class="line">            inDegree[p-&gt;nodeId]--;</span><br><span class="line">            <span class="comment">//如果没有了前置结点，代表可以入队(即被遍历，或者说该工程任务可以执行了)</span></span><br><span class="line">            <span class="keyword">if</span> (inDegree[p-&gt;nodeId] == <span class="number">0</span>)&#123;</span><br><span class="line">                checkQueue[++rear] = p-&gt;nodeId;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果队列中的元素个数刚好等于顶点个数，就代表拓扑排序成立，即不存在闭环。</span></span><br><span class="line">    <span class="comment">//因为如果有闭环，闭环上结点的入度始终不为0，无法入队。</span></span><br><span class="line">    <span class="keyword">return</span> n == rear + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (m--)&#123;</span><br><span class="line">        <span class="type">int</span> from, to;</span><br><span class="line">        cin&gt;&gt;from&gt;&gt;to;</span><br><span class="line">        <span class="built_in">addLink</span>(from, to);</span><br><span class="line">        inDegree[to]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果拓扑排序无效，则输出-1</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">topSort</span>())</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;-1&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">            cout&lt;&lt;checkQueue[i]&lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Algorithm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Clion中Cmake的设置问题</title>
      <link href="/2023/10/15/Clion-cmake.html"/>
      <url>/2023/10/15/Clion-cmake.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-设置可执行程序输出目录">1.设置可执行程序输出目录</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY <span class="string">&quot;$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/bin&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="2-将cpp文件添加为-生成可执行文件-的源文件">2.将cpp文件添加为“生成可执行文件”的源文件</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(AcWing3375 Acwing/graduate/AcWing3375.cpp)</span><br></pre></td></tr></table></figure><h3 id="完整的cmake设置">完整的cmake设置</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.24</span>)</span><br><span class="line"><span class="comment">#指定cmake工程名</span></span><br><span class="line"><span class="keyword">project</span>(algorithm)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c++版本</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">14</span>)</span><br><span class="line"><span class="comment"># 指定可执行程序输出目录</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY <span class="string">&quot;$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/bin&quot;</span>)</span><br><span class="line"><span class="keyword">add_executable</span>(AcWing3375 Acwing/graduate/AcWing3375.cpp)</span><br></pre></td></tr></table></figure><h3 id="附：普通的gitignore文件">附：普通的gitignore文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/.idea/</span><br><span class="line">/cmake-build-debug/</span><br><span class="line">/bin/</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> clion cmake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue3使用Echarts</title>
      <link href="/2023/07/19/vue3-echarts.html"/>
      <url>/2023/07/19/vue3-echarts.html</url>
      
        <content type="html"><![CDATA[<h3 id="安装">安装</h3><p>响应式布局，是为五个不同的屏幕尺寸制定不同的显示比例。这是网页收缩导致网页布局变乱的究极解决方案。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> echarts vue3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>响应式布局</title>
      <link href="/2023/07/04/ResponsiveDesign.html"/>
      <url>/2023/07/04/ResponsiveDesign.html</url>
      
        <content type="html"><![CDATA[<h3 id="响应式布局">响应式布局</h3><p>响应式布局，是为五个不同的屏幕尺寸制定不同的显示比例。这是网页收缩导致网页布局变乱的究极解决方案。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> html element </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nodejs-包</title>
      <link href="/2023/06/28/NodeJsPackage.html"/>
      <url>/2023/06/28/NodeJsPackage.html</url>
      
        <content type="html"><![CDATA[<h3 id="包的类型">包的类型</h3><ul><li>项目包：用于编写项目和和业务逻辑</li><li>软件包：封装工具和方法进行使用<ul><li>本地软件包：当前项目内使用，封装<strong>属性和方法</strong>，存在于 node_modules中。</li><li>全局软件包：本机所有项目使用，封装<strong>命令和工具</strong>，存在于系统设置的位置。</li></ul></li></ul><h3 id="软件包的结构">软件包的结构</h3><p>如下图所示。整个util包由三部分组成，libs、index.js、package.json。</p><ul><li>libs中，存放工具包的源代码 js 文件。</li><li>index.js文件作为入口文件，通过这个文件统一暴露对外工具方法等。</li><li>package.json文件，描述包的一些信息。</li></ul><p><img src="https://pics.kahvia.cn/img/image-20230628145428487.png" alt="包的结构图"></p><h3 id="libs示例">libs示例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//printHello.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello,Adong. It&#x27;s your first tools package.&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> words = <span class="string">&quot;How old are you?&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    printHello,</span><br><span class="line">    words</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="index-js示例">index.js示例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面这用法叫做解析重构</span></span><br><span class="line"><span class="keyword">let</span> &#123; printHello, words &#125; = <span class="built_in">require</span>(<span class="string">&quot;./libs/printHello&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> resHeaderUtil = <span class="built_in">require</span>(<span class="string">&quot;./libs/resHeaderUtil-commonjs&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//对libs中的工具，统一作模块暴露</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    printHello,</span><br><span class="line">    words,</span><br><span class="line">    resHeaderUtil</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="package-json示例">package.json示例</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;kahvia_tools&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Kahvia&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;包含了设置http请求的响应头的工具和输出你好的工具函数&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>其中，main表示工具包的入口文件，version代表版本，license表示许可证。</p><h3 id="软件包的使用">软件包的使用</h3><p>在使用软件包时，路径只需要到软件包的根目录即可。无需指定更详细的路径。它会自动寻找index.js，若无则查找package.json中的main入口。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> kahvia_utils = <span class="built_in">require</span>(<span class="string">&quot;./util&quot;</span>)</span><br><span class="line"></span><br><span class="line">kahvia_utils.<span class="title function_">printHello</span>()</span><br></pre></td></tr></table></figure><p>结果如下所示。</p><p><img src="https://pics.kahvia.cn/img/image-20230628150604791.png" alt="工具包使用结果"></p><h3 id="npm">NPM</h3><p>npm是nodejs的包管理器。</p><p>若项目中没有package.json，可以通过以下命令执行初始化。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><p>若我们需要安装某个软件包，则通过以下命令执行安装，软件包会存放在node_modules目录下，软件包的版本则会保存在package-lock.json文件中，用作固化版本。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i package-name</span><br></pre></td></tr></table></figure><p>我们使用下载的软件包时，可以<strong>直接通过包名引入</strong>，而不用通过路径。</p><p>当我们协同开发时，git不会同步我们的node_modules文件夹。可能别人使用了某个包，但是我们自己没有使用，所以本地没有这个包。我们可以通过以下命令，根据package.json文件，安装本地缺少的包。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i</span><br></pre></td></tr></table></figure><h3 id="常用的软件包">常用的软件包</h3><h4 id="nodemon">nodemon</h4><p>一个全局软件包，需要全局安装。通过这个nodemon启动 js 文件，可以检测代码更改，自动重启程序。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i nodemon -g</span><br></pre></td></tr></table></figure><h4 id="webpack">webpack</h4><p>一个常用的打包工具，安装在项目的dev环境中。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack webpack-cli --save-dev</span><br></pre></td></tr></table></figure><p>在项目的package.json中添加自定义脚本命令。其中，build是自定义的名称，什么都可以，其后面的值即webpack才是真正执行的命令。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span><span class="string">&quot;webpack&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>将要打包的文件放在根目录的src目录中，通过npm run build，实现项目打包。不过这里的打包只能实现<strong>部分</strong> js 文件的打包，至于为什么是<strong>部分</strong>，因为打包那种nodejs写的后端项目，会报很多错误，而我暂时还不太懂问题出在哪里。目前打包给前端页面引用的js文件是没有问题的。</p><p>通过配置项目根目录的webpack.config.js文件，可以配置打包的参数，比如入口、出口、插件等。其中，entry是入口，output是出口，path是输出路径，filename是打包后的文件名。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/hello.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;testPack.js&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="htmlwebpackplugin-根据自动生成目标页面并连接打包压缩的js文件">HtmlWebpackPlugin（根据自动生成目标页面并连接打包压缩的JS文件）</h5><p>webpack通过上述方式打包的话，只能打包普通的静态js文件。也就是说，打包完成后，我们需要手动为页面引入打包后的js文件，这无疑的麻烦的。通过HtmlWebpackPlugin，我们可以将页面一起打包，自动为页面引入打包好的js文件，一起输出到目标目录。</p><blockquote><p>​详细的使用可以参考<a href="https://www.webpackjs.com/plugins/html-webpack-plugin/#basic-usage">官方文档</a></p></blockquote><p>通过如下命令安装插件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev html-webpack-plugin</span><br></pre></td></tr></table></figure><p>在webpack配置文件中，配置如下。其中，template作为模板，即以此模板在目标目录生成一份以filename为文件名的html文件，同时为其引入打包好的js文件。output中的clean属性可以清除上一次打包的东西。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"><span class="comment">//引入插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HtmlWebpackPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;html-webpack-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/hello.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;testPack.js&#x27;</span>,</span><br><span class="line">        <span class="attr">clean</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./public/index.html&#x27;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;test.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="css-loader-style-loader-加载器-把css打包到js文件中">css-loader,style-loader（加载器，把css打包到js文件中）</h5><blockquote><p><a href="https://www.webpackjs.com/loaders/css-loader/">这两个加载器的官方文档</a></p></blockquote><ul><li>css-loader：解析css代码。</li><li>style-loader：把解析后的css代码插入到DOM。最后css代码在打包后的js文件中，通过函数的方式保存。</li></ul><p>按照下方命令安装加载器。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev css-loader style-loader</span><br></pre></td></tr></table></figure><p>在webpack配置文件中配置加载器。下方的module部分。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"><span class="comment">//引入插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HtmlWebpackPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;html-webpack-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/hello.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;testPack.js&#x27;</span>,</span><br><span class="line">        <span class="attr">clean</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./Login/login.html&#x27;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;login.html&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">                <span class="attr">use</span>: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>use数组中的元素顺序是有影响的。loader是从右到左应用的。在这种情况下，首先应用css-loader，然后应用style-loader。即先解析css引用，再绑定DOM元素。</p><p>配置好加载器以后，就可以把使用到的css文件引用到入口js文件中了。比如我这里的打包入口是hello.js文件，那我在文件内容开头import即可。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//hello.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../Login/login.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//测试打包</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello, kahvia !&quot;</span>)</span><br><span class="line"><span class="comment">//二次输出</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;what&#x27;s up ?&quot;</span>)</span><br></pre></td></tr></table></figure><p>以上都完成后，即可打包。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><h5 id="mini-css-extract-plugin-提取css文件">mini-css-extract-plugin(提取css文件)</h5><blockquote><p><a href="https://www.webpackjs.com/plugins/mini-css-extract-plugin/">MiniCssExtractPlugin | webpack 中文文档</a></p></blockquote><p>我们在上面通过style-loader，是将css打包进js文件，这会导致js文件比平常更大。所以官方更推荐的一个做法是将css提取出来，而不是打包进js文件。通过<strong>mini-css-extract-plugin</strong>这个插件，配合css-loader我们可以做到提取css文件。</p><p>值得注意的是，mini-css-extract-plugin<strong>不能</strong>和style-loader一起使用，因为既要单独提取，又要打包进js文件，这不是相互矛盾了吗？</p><p>顺带一提，单独提取的css文件，是不会被压缩的。</p><p>通过以下命令安装插件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev mini-css-extract-plugin</span><br></pre></td></tr></table></figure><p>再在webpack配置文件中引入该插件，为其配置plugin选项，并在rules-use中添加插件内置的loader。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"><span class="comment">//引入插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HtmlWebpackPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;html-webpack-plugin&#x27;</span></span><br><span class="line"><span class="comment">//引入css提取插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MiniCssExtractPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;mini-css-extract-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/hello.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;testPack.js&#x27;</span>,</span><br><span class="line">        <span class="attr">clean</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./Login/login.html&#x27;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;login.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>()</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">                <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="cssminimizerwebpackplugin-压缩提取的css文件">CssMinimizerWebpackPlugin（压缩提取的css文件）</h5><p>通过上述的mini-css-extract-plugin插件，只能做到提取，但是会发现提取出来的css文件并没有做到压缩。而CssMinimizerWebpackPlugin就是为了压缩而使用的。</p><p>通过命令安装插件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install css-minimizer-webpack-plugin --save-dev</span><br></pre></td></tr></table></figure><p>在webpack配置文件中引入并配置。其中optimization-minimizer是配置项。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"><span class="comment">//引入插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HtmlWebpackPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;html-webpack-plugin&#x27;</span></span><br><span class="line"><span class="comment">//引入css提取插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MiniCssExtractPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;mini-css-extract-plugin&#x27;</span></span><br><span class="line"><span class="comment">//引入css压缩插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CssMinimizerPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;css-minimizer-webpack-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/hello.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;testPack.js&#x27;</span>,</span><br><span class="line">        <span class="attr">clean</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./Login/login.html&#x27;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;login.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">                <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//优化</span></span><br><span class="line">    <span class="attr">optimization</span>: &#123;</span><br><span class="line">        <span class="comment">//minimize 减小</span></span><br><span class="line">        <span class="attr">minimizer</span>: [</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CssMinimizerPlugin</span>()</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="打包图片">打包图片</h5><p>在上述操作中，我们可以打包html，css，js了，但是图片该如何处理呢？如果项目中的图片，采用网络地址url访问，那么我们打包后自然可以正常使用。但如果采用的是本地的图片呢？我们就需要把图片也一起打包了。</p><blockquote><p><a href="https://www.webpackjs.com/guides/asset-modules/">资源模块 | webpack 中文文档</a></p></blockquote><p>在webpack5中，我们无需使用外置loader，配置如下所示，在rule中配置图片打包。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"><span class="comment">//引入插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HtmlWebpackPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;html-webpack-plugin&#x27;</span></span><br><span class="line"><span class="comment">//引入css提取插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MiniCssExtractPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;mini-css-extract-plugin&#x27;</span></span><br><span class="line"><span class="comment">//引入css压缩插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CssMinimizerPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;css-minimizer-webpack-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/hello.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;testPack.js&#x27;</span>,</span><br><span class="line">        <span class="attr">clean</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./Login/login.html&#x27;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;login.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">                <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//配置图片打包</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif)$/i</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;asset&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//优化</span></span><br><span class="line">    <span class="attr">optimization</span>: &#123;</span><br><span class="line">        <span class="comment">//minimize 减小</span></span><br><span class="line">        <span class="attr">minimizer</span>: [</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CssMinimizerPlugin</span>()</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在asset类型下，大于8kb的图片会直接作拷贝处理，小于8kb的会转为base64，通过uri的方式替换项目中的src引用。</p><p>类似于css打包，我们将要打包的图片也引入入口JS文件即可。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//hello.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../Login/login.css&#x27;</span></span><br><span class="line"><span class="comment">//导入需要打包的本地图片</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../Login/ganda.jpg&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//测试打包</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello, kahvia !&quot;</span>)</span><br><span class="line"><span class="comment">//二次输出</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;what&#x27;s up ?&quot;</span>)</span><br></pre></td></tr></table></figure><p>正常打包即可。</p><h5 id="搭建热更新开发环境">搭建热更新开发环境</h5><p>下载webpack-dev-server。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack-dev-server --save-dev</span><br></pre></td></tr></table></figure><p>在webpack配置文件中，设置模式（mode）为开发模式（development）,并在package.json中配置自定义命令，即scripts中的选项，“dev”: “webpack serve --open”。</p><p>设置开发模式。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"><span class="comment">//引入插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HtmlWebpackPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;html-webpack-plugin&#x27;</span></span><br><span class="line"><span class="comment">//引入css提取插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MiniCssExtractPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;mini-css-extract-plugin&#x27;</span></span><br><span class="line"><span class="comment">//引入css压缩插件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CssMinimizerPlugin</span> <span class="keyword">from</span> <span class="string">&#x27;css-minimizer-webpack-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="comment">//设置热更新开发模式</span></span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">    <span class="comment">//设置入口</span></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/hello.js&#x27;</span>,</span><br><span class="line">    <span class="comment">//出口</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&#x27;dist&#x27;</span>),</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&#x27;testPack.js&#x27;</span>,</span><br><span class="line">        <span class="attr">clean</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//插件</span></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">MiniCssExtractPlugin</span>(&#123;</span><br><span class="line">            <span class="comment">// filename: &quot;login.css&quot;</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&#x27;./Login/login.html&#x27;</span>,</span><br><span class="line">            <span class="attr">filename</span>: <span class="string">&#x27;login.html&#x27;</span></span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">                <span class="attr">use</span>: [<span class="title class_">MiniCssExtractPlugin</span>.<span class="property">loader</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//配置图片打包</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif)$/i</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;asset&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//优化</span></span><br><span class="line">    <span class="attr">optimization</span>: &#123;</span><br><span class="line">        <span class="comment">//minimize 减小</span></span><br><span class="line">        <span class="attr">minimizer</span>: [</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">CssMinimizerPlugin</span>()</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在package.json中，如下所示。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;css-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.8.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;css-minimizer-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;html-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.5.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mini-css-extract-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.7.6&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;style-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.3.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.88.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-cli&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.1.4&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-dev-server&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.15.1&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack serve --open&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>通过自定义命令启动。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>这种情况下，会自动创建一个8080端口的服务，服务器的根目录为项目的public目录和webpack配置文件中的出口目录。默认打开的是public目录下的index网页，而我们要查看的网页在出口目录，那么我们可以为public目录的index网页添加重定向，自动跳转到我们要查看的网页。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- public目录下的index.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    location.<span class="property">href</span> = <span class="string">&quot;/login.html&quot;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="生产模式">生产模式</h5><p>上面使用到了开发模式，配合webpack-dev-server可以热更新。与之相对的，还有生产模式（production），即打包模式。</p><p>我们开发模式用的更多，所以mode设置为development，那打包的时候怎么办呢？再去修改mode吗？这很显然不方便。所以我们可以通过自定义命令指定模式。命令的优先级＞配置文件。</p><p>在package.json文件中，我们这样设置，在build和dev后面加上–mode=[mode]即可。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;css-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.8.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;css-minimizer-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;html-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.5.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mini-css-extract-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.7.6&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;style-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.3.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.88.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-cli&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.1.4&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-dev-server&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.15.1&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --mode=production&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack serve --open --mode=development&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>这样一来，开发的时候就使用热更新开发模式，打包的时候就使用生产模式，两不误。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript-解构赋值</title>
      <link href="/2023/06/28/Javascript-DestructuringAssignment.html"/>
      <url>/2023/06/28/Javascript-DestructuringAssignment.html</url>
      
        <content type="html"><![CDATA[<h3 id="解构赋值">解构赋值</h3><p><strong>解构赋值</strong>语法是一种 Javascript 表达式。可以将数组中的值或对象的属性取出，赋值给其他变量。</p><p>对于对象和数组的解构，有两种解构模式：<em>绑定模式</em>和<em>赋值模式</em>，它们的语法略有不同。</p><h3 id="绑定模式">绑定模式</h3><p>在绑定模式中，模式以声明关键字（<code>var</code>、<code>let</code> 或 <code>const</code>）开始。然后，每个单独的属性必须绑定到一个变量或进一步解构。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: &#123; <span class="attr">c</span>: <span class="number">2</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; a, <span class="attr">b</span>: &#123; <span class="attr">c</span>: d &#125; &#125; = obj;</span><br><span class="line"><span class="comment">// Two variables are bound: `a` and `d`</span></span><br><span class="line"><span class="comment">//两个变量绑定了：a 和 b</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="赋值模式">赋值模式</h3><p>在赋值模式中，模式不以关键字开头。每个解构属性都被赋值给一个赋值目标——这个赋值目标可以事先用 <code>var</code> 或 <code>let</code> 声明，也可以是另一个对象的属性——一般来说，可以是任何可以出现在赋值表达式左侧的东西。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = [];</span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line">(&#123; <span class="attr">a</span>: numbers[<span class="number">0</span>], <span class="attr">b</span>: numbers[<span class="number">1</span>] &#125; = obj);</span><br><span class="line"><span class="comment">// The properties `a` and `b` are assigned to properties of `numbers`</span></span><br><span class="line"><span class="comment">//obj的两个属性，a和b，被赋值给了数组numbers[]</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>备注：</strong> 当使用对象文字解构赋值而不带声明时，在赋值语句周围必须添加括号 <code>( ... )</code>。</p><p><code>&#123; a, b &#125; = &#123; a: 1, b: 2 &#125;</code> 不是有效的独立语法，因为左侧的 <code>&#123;a, b&#125;</code> 被视为块而不是对象字面量。但是，<code>(&#123; a, b &#125; = &#123; a: 1, b: 2 &#125;)</code> 是有效的，<code>const &#123; a, b &#125; = &#123; a: 1， b: 2 &#125;</code> 也是有效的。</p><p>如果你的编码风格不包括尾随分号，则 <code>( ... )</code> 表达式前面需要有一个分号，否则它可能用于执行前一行的函数。</p></blockquote><h3 id="参考来源">参考来源</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment">解构赋值 - JavaScript | MDN</a></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NodeJs使用</title>
      <link href="/2023/06/27/NodeJs.html"/>
      <url>/2023/06/27/NodeJs.html</url>
      
        <content type="html"><![CDATA[<h2 id="commonjs和ecmascript语法">Commonjs和ECMAScript语法</h2><h3 id="commonjs">Commonjs</h3><p>Nodejs中默认采用Commonjs语法。</p><p>模块导出格式如下。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//commonjs语法导出自定义模块</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">setResHeader</span>: setResHeader</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>模块导入格式如下。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入自定义工具模块，只能使用路径</span></span><br><span class="line"><span class="keyword">let</span> resHeaderUtil = <span class="built_in">require</span>(<span class="string">&quot;./utils/resHeaderUtil&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="ecmascript">ECMAScript</h3><p>比如vue这种框架，采用的就是ECMAScript语法。要使用这种语法，首先得在package.json中指出type的值。</p><blockquote><p>When set to “module”, the type field allows a package to specify all .js files within are ES modules. If the “type” field is omitted or set to “commonjs”, all .js files are treated as CommonJS.</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>这便设置成了。</p><h4 id="默认导出">默认导出</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ECMAScript语法默认导出,外部import以后，全部加载</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">setResHeader</span>: setResHeader</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们需要时，如下导入即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入自定义工具模块,需要附带文件的后缀</span></span><br><span class="line"><span class="keyword">import</span> resHeaderUtil <span class="keyword">from</span> <span class="string">&#x27;./utils/resHeaderUtil-ecmascript-default.js&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="命名导出">命名导出</h4><p>只需要在变量前面加上 export 修饰，即可在其它地方导入。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置http响应体的Content-Type</span></span><br><span class="line"><span class="comment">//ECMAScript语法命名导出,外部import按需导入，按需加载</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">setResHeader</span>(<span class="params">response, contentType</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (contentType == <span class="string">&quot;html&quot;</span>)</span><br><span class="line">        response.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (contentType == <span class="string">&quot;css&quot;</span>)</span><br><span class="line">        response.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/css;charset=utf-8&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (contentType == <span class="string">&quot;js&quot;</span>)</span><br><span class="line">        response.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/javascript;charset=utf-8&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        response.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/plain;charset=utf-8&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>命名导出方式，在导入时，是按需导入，按需加载。花括号中放置需要的变量，不用像默认导出那样将整个模块都导入进来。</p><p>需要注意的是，花括号中的变量名，要和引入模块中的变量名或者函数名相同。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入自定义工具模块,需要附带文件的后缀</span></span><br><span class="line"><span class="keyword">import</span> &#123; setResHeader &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/resHeaderUtil-ecmascript-named.js&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="语法差异">语法差异</h3><p>在Common.js中，我们可以使用__dirname来获取当前js文件所在目录的绝对路径，通过node:path模块的join方法来拼接自己想要的绝对路径。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加监听事件</span></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> pathname = req.<span class="property">url</span></span><br><span class="line">    <span class="keyword">var</span> postfix = pathname.<span class="title function_">match</span>(<span class="regexp">/(\.[^.]+|)$/</span>)[<span class="number">0</span>];<span class="comment">//取得后缀名</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//readFile方法使用相对路径时，查找的起点是执行node xx.js命令的目录。这个目录与我们打开终端的位置有关，所以最好采用绝对路径。</span></span><br><span class="line">    <span class="comment">//其中__dirname是当前文件夹的绝对路径，通过path.join方法拼接路径可以将拼接后的路径转换成当前操作系统支持识别的绝对路径</span></span><br><span class="line">    <span class="keyword">let</span> filePath = path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;./Login&quot;</span>, pathname)</span><br><span class="line">    fs.<span class="title function_">readFile</span>(filePath, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            res.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/html;charset=utf-8&quot;</span>)</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&quot;&lt;h1&gt;访问的内容不存在&lt;/h1&gt;&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//根据后缀设置响应头</span></span><br><span class="line">            <span class="keyword">if</span> (postfix == <span class="string">&quot;html&quot;</span>)</span><br><span class="line">                resHeaderUtil.<span class="title function_">setResHeader</span>(res, <span class="string">&quot;html&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (postfix == <span class="string">&quot;css&quot;</span>)</span><br><span class="line">                resHeaderUtil.<span class="title function_">setResHeader</span>(res, <span class="string">&quot;css&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (postfix == <span class="string">&quot;js&quot;</span>)</span><br><span class="line">                resHeaderUtil.<span class="title function_">setResHeader</span>(res, <span class="string">&quot;js&quot;</span>)</span><br><span class="line">            <span class="comment">//以...内容结束响应</span></span><br><span class="line">            res.<span class="title function_">end</span>(data.<span class="title function_">toString</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>但是当我们使用ES语法后，__dirname就不能使用了，否则会报错如下。</p><blockquote><p>ReferenceError: __dirname is not defined in ES module scope</p></blockquote><p>但是我们使用fs.readFile方法时，又经常需要使用到绝对路径。作为__dirname的替代方案，可以实现工具类如下。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> url <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;node:path&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getRecentDir</span>(<span class="params">fileUrl</span>) &#123;</span><br><span class="line">    <span class="comment">//将文件url转换成文件的绝对路径</span></span><br><span class="line">    <span class="keyword">let</span> filePath = url.<span class="title function_">fileURLToPath</span>(fileUrl)</span><br><span class="line">    <span class="comment">//获取绝对路径的最后目录名</span></span><br><span class="line">    <span class="keyword">let</span> dirname = path.<span class="title function_">dirname</span>(filePath)</span><br><span class="line">    <span class="comment">//返回给外界使用</span></span><br><span class="line">    <span class="keyword">return</span> dirname</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>外界传入对应的文件URL即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入自定义工具模块,需要附带文件的后缀</span></span><br><span class="line"><span class="keyword">import</span> &#123; setResHeader &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/resHeaderUtil-ecmascript-named.js&#x27;</span></span><br><span class="line"><span class="comment">//导入自定义的文件绝对路径工具</span></span><br><span class="line"><span class="keyword">import</span> &#123; getRecentDir &#125; <span class="keyword">from</span> <span class="string">&#x27;./utils/recentPath.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//添加监听事件</span></span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> pathname = req.<span class="property">url</span></span><br><span class="line">    <span class="keyword">var</span> postfix = pathname.<span class="title function_">match</span>(<span class="regexp">/(\.[^.]+|)$/</span>)[<span class="number">0</span>];<span class="comment">//取得后缀名</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//readFile方法使用相对路径时，查找的起点是执行node xx.js命令的目录。这个目录与我们打开终端的位置有关，所以最好采用绝对路径。</span></span><br><span class="line">    <span class="comment">//在ES语法中没有__dirname，要通过文件url转换得到当前文件夹的绝对路径，通过path.join方法拼接路径可以将拼接后的路径转换成当前操作系统支持识别的绝对路径</span></span><br><span class="line">    <span class="keyword">let</span> filePath = path.<span class="title function_">join</span>(<span class="title function_">getRecentDir</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>), <span class="string">&quot;./Login&quot;</span>, pathname)</span><br><span class="line">    fs.<span class="title function_">readFile</span>(filePath, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            res.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/html;charset=utf-8&quot;</span>)</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&quot;&lt;h1&gt;访问的内容不存在&lt;/h1&gt;&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//根据后缀设置响应头</span></span><br><span class="line">            <span class="keyword">if</span> (postfix == <span class="string">&quot;html&quot;</span>)</span><br><span class="line">                <span class="comment">// resHeaderUtil.setResHeader(res, &quot;html&quot;)</span></span><br><span class="line">                <span class="title function_">setResHeader</span>(res, <span class="string">&quot;html&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (postfix == <span class="string">&quot;css&quot;</span>)</span><br><span class="line">                <span class="comment">// resHeaderUtil.setResHeader(res, &quot;css&quot;)</span></span><br><span class="line">                <span class="title function_">setResHeader</span>(res, <span class="string">&quot;css&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (postfix == <span class="string">&quot;js&quot;</span>)</span><br><span class="line">                <span class="comment">// resHeaderUtil.setResHeader(res, &quot;js&quot;)</span></span><br><span class="line">                <span class="title function_">setResHeader</span>(res, <span class="string">&quot;js&quot;</span>)</span><br><span class="line">            <span class="comment">//以...内容结束响应</span></span><br><span class="line">            res.<span class="title function_">end</span>(data.<span class="title function_">toString</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>汇编语言练习</title>
      <link href="/2023/05/04/AssemblyLanguageWorks.html"/>
      <url>/2023/05/04/AssemblyLanguageWorks.html</url>
      
        <content type="html"><![CDATA[<h3 id="变量buf3中存放着10个有符号的字节数据-编程将这10个数按从小到大排序">变量BUF3中存放着10个有符号的字节数据，编程将这10个数按从小到大排序。</h3><h4 id="思路">思路</h4><p>双指针排序。BP留在原地，SI不断移动，一旦发现比BP小的值，就把那个值和BP交换，SI从左往右走一轮可以使得BP所在位置的值最小。一轮走完再开一轮，BP向右移动一位，用以存放次小值，SI再去探险。如此循环。</p><h4 id="代码">代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">;变量BUF3中存放着10个有符号的字节数据，编程将这10个数按从小到大排序。</span><br><span class="line">DSEG SEGMENT</span><br><span class="line">    BUF3       DB 10,9,8,7,6,5,4,3,2,1</span><br><span class="line">    BUFFLENGTH DB $-BUF3</span><br><span class="line">DSEG ENDS</span><br><span class="line"></span><br><span class="line">SSEG SEGMENT</span><br><span class="line">SSEG ENDS</span><br><span class="line"></span><br><span class="line">CSEG SEGMENT</span><br><span class="line">                   ASSUME DS:DSEG,SS:SSEG,CS:CSEG</span><br><span class="line">    START:         </span><br><span class="line">                   MOV    AX,DSEG</span><br><span class="line">                   MOV    DS,AX</span><br><span class="line"></span><br><span class="line">                   MOV    BP,OFFSET BUF3             ;用以指向BUF数组需要放置最小数的位置</span><br><span class="line">                   LEA    SI,BUF3                    ;移动这个指针来寻找最小值</span><br><span class="line"></span><br><span class="line">                   MOV    DH,BUFFLENGTH              ;外循环次数</span><br><span class="line"></span><br><span class="line">    ;MOV    DL,BUFFLENGTH-1            ;不能直接这么写，这样会把BUFFLENGTH处理为地址。地址减一，就成数组的最后一个值的地址了。</span><br><span class="line">                   MOV    DL,BUFFLENGTH</span><br><span class="line">                   DEC    DL                         ;DL是内循环次数</span><br><span class="line"></span><br><span class="line">    OUTERLOOP:     </span><br><span class="line">                   CMP    DH,0                       ;查看是否需要进行外循环</span><br><span class="line">                   JE     ENDLOOP</span><br><span class="line">                   DEC    DH</span><br><span class="line">                   MOV    DL,DH                      ;重置内循环次数</span><br><span class="line"></span><br><span class="line">                   MOV    SI,BP                      ;需要则，将用以移动寻找最小值的指针SI重置到需要放置最小值的指针处</span><br><span class="line">                   JMP    INNERLOOP</span><br><span class="line"></span><br><span class="line">    INNERLOOP:     </span><br><span class="line">                   INC    SI                         ;让SI自增，指向下一个数组元素</span><br><span class="line">                   MOV    AL,DS:[BP]</span><br><span class="line">                   CMP    DS:[SI],AL</span><br><span class="line">                   JLE    UPDATEMIN</span><br><span class="line">                   JMP    BEFORENEXTLOOP</span><br><span class="line">    </span><br><span class="line">    UPDATEMIN:                                       ;把到目前为止的最小值交换到目标最小值位置</span><br><span class="line">                   MOV    AL,DS:[BP]</span><br><span class="line">                   XCHG   AL,DS:[SI]</span><br><span class="line">                   MOV    DS:[BP],AL</span><br><span class="line"></span><br><span class="line">    BEFORENEXTLOOP:                                  ;在内循环进行下一次之前</span><br><span class="line">                   DEC    DL                         ;内循环剩余次数自减</span><br><span class="line">                   CMP    DL,0                       ;判断是否需要还需要进行内循环</span><br><span class="line">                   JG     INNERLOOP                  ;需要则进行</span><br><span class="line"></span><br><span class="line">                   INC    BP                         ;否则自增外循环初始数组地址</span><br><span class="line">                   JMP    OUTERLOOP                  ;进行外循环</span><br><span class="line">    ENDLOOP:       </span><br><span class="line">                   MOV    AH,4CH</span><br><span class="line">                   INT    21H</span><br><span class="line"></span><br><span class="line">CSEG ENDS</span><br><span class="line">END START</span><br></pre></td></tr></table></figure><h4 id="注意事项">注意事项</h4><ul><li>不能写 “MOV    DL, BUFFLENGTH-1” ，因为会把BUFFLENGTH当成地址来减一然后取新地址的值，会导致DL中存放的是上一个变量即BUF3数组的最后一个数。</li><li>使用BP和SI的时候，需要指定段地址为DS，不然会找不到数据（虽然我也不知道为什么以前不写没事）。</li><li>涉及到双循环还是自己操作循环数比较方便。</li></ul><h4 id="结果图">结果图</h4><p><img src="https://pics.kahvia.cn/img/%E5%8F%98%E9%87%8FBUF3%E4%B8%AD%E5%AD%98%E6%94%BE%E7%9D%8010%E4%B8%AA%E6%9C%89%E7%AC%A6%E5%8F%B7%E7%9A%84%E5%AD%97%E8%8A%82%E6%95%B0%E6%8D%AE%EF%BC%8C%E7%BC%96%E7%A8%8B%E5%B0%86%E8%BF%9910%E4%B8%AA%E6%95%B0%E6%8C%89%E4%BB%8E%E5%B0%8F%E5%88%B0%E5%A4%A7%E6%8E%92%E5%BA%8F.png" alt="结果图"></p>]]></content>
      
      
      <categories>
          
          <category> 微机 汇编 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AssemblyLanguage </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端练习1</title>
      <link href="/2023/04/18/HTML-Study.html"/>
      <url>/2023/04/18/HTML-Study.html</url>
      
        <content type="html"><![CDATA[<h3 id="代码">代码</h3><p>HTML:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Button Anime<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;button.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;:javascript&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;button.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>CSS:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">13px</span> <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="built_in">rgb</span>(<span class="number">43</span>, <span class="number">190</span>, <span class="number">96</span>), <span class="built_in">rgb</span>(<span class="number">15</span>, <span class="number">157</span>, <span class="number">88</span>));</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">transition</span>: <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: inherit;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="comment">/* var函数的参数必须以--开头 */</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="built_in">var</span>(--xPos);</span><br><span class="line">    <span class="attribute">top</span>: <span class="built_in">var</span>(--yPos);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: black;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transition</span>: width <span class="number">0.5s</span>, height <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">600px</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span> <span class="selector-tag">a</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>JS:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> button = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.btn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">button.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseover&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> x = e.<span class="property">clientX</span> - button.<span class="property">offsetLeft</span>;</span><br><span class="line">    <span class="keyword">const</span> y = e.<span class="property">clientY</span> - button.<span class="property">offsetTop</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//element.style.setPorperty是用于设置css的属性</span></span><br><span class="line">    button.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--xPos&#x27;</span>, x + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">    button.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--yPos&#x27;</span>, y + <span class="string">&#x27;px&#x27;</span>);</span><br><span class="line">    <span class="comment">//element.setAttribute可以用于设置document元素的style属性，但是会覆盖style</span></span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="效果图">效果图</h3><p><img src="https://pics.kahvia.cn/img/screenshots.gif" alt="效果图"></p><h3 id="总结">总结</h3><ol><li><p>transition和transform是两个不同的CSS属性，它们的作用和用法也不同：</p><ul><li>transition是用来设置元素在不同状态之间切换时的过渡效果的，它可以指定要过渡的属性、过渡的持续时间、过渡的速度曲线和过渡的延迟时间¹。transition可以让元素的属性值平滑地变化，而不是突然跳变。</li><li>transform是用来设置元素的变形效果的，它可以对元素进行旋转、缩放、倾斜、移动等操作，改变元素在二维或三维空间中的形状和位置²。transform可以让元素产生视觉上的变化，而不影响元素在文档流中的位置。</li></ul><p>简单地说，transition是用来控制元素属性值的变化速度和方式的，而transform是用来控制元素形状和位置的变化效果的。两者可以结合使用，实现更多种类的动画效果。例如，你可以用transition来设置transform属性的过渡效果，让元素在旋转或缩放时有一个平滑的动画³。</p><p>源: 与必应的对话， 2023/4/18<br>(1) CSS transforms VS transitions - Stack Overflow. <a href="https://stackoverflow.com/questions/19186585/css-transforms-vs-transitions">https://stackoverflow.com/questions/19186585/css-transforms-vs-transitions</a>.<br>(2) CSS Transitions - W3School. <a href="https://www.w3schools.com/css/css3_transitions.asp">https://www.w3schools.com/css/css3_transitions.asp</a>.<br>(3) Easy CSS Animation With Transition &amp; Transforms. <a href="https://webdesignerwall.com/tutorials/easy-css-animation-transition-transforms">https://webdesignerwall.com/tutorials/easy-css-animation-transition-transforms</a>.</p></li><li><p>element.setAttribute()和element.style.setProperty()有一些区别，主要是：</p><ul><li>element.setAttribute()是用来设置元素的属性的，它可以设置任何属性，包括自定义属性¹。element.style.setProperty()是用来设置元素的样式属性的，它只能设置CSS属性²。</li><li>element.setAttribute()的第一个参数是属性名，第二个参数是属性值。如果属性已经存在，它会更新属性值，如果不存在，它会添加一个新的属性¹。element.style.setProperty()的第一个参数是CSS属性名，第二个参数是CSS属性值，第三个参数是可选的，表示优先级（如&quot;important&quot;）²。</li><li>element.setAttribute()的属性名不区分大小写，但是在HTML文档中，它会自动转换为小写¹。element.style.setProperty()的CSS属性名区分大小写，但是要使用连字符分隔的形式（如&quot;background-color&quot;），而不是驼峰形式（如&quot;backgroundColor&quot;）²。</li></ul><p>一般来说，如果你想设置元素的样式属性，建议使用element.style.setProperty()，因为它更符合CSS规范，并且可以避免一些浏览器兼容性问题³。如果你想设置元素的其他属性，例如id、class、data-*等，可以使用element.setAttribute()。</p><p>源: 与必应的对话， 2023/4/18<br>(1) javascript - Setting a property via property or setAttribute - Stack … <a href="https://stackoverflow.com/questions/8018814/setting-a-property-via-property-or-setattribute">https://stackoverflow.com/questions/8018814/setting-a-property-via-property-or-setattribute</a>.<br>(2) Element: setAttribute() method - Web APIs | MDN - Mozilla Developer. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute">https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute</a>.<br>(3) When to use setAttribute vs .attribute= in JavaScript?. <a href="https://stackoverflow.com/questions/3919291/when-to-use-setattribute-vs-attribute-in-javascript">https://stackoverflow.com/questions/3919291/when-to-use-setattribute-vs-attribute-in-javascript</a>.</p></li><li><p>var()函数是CSS中的一个函数，它可以插入一个自定义属性（有时也被称为“CSS变量”）的值，用来代替非自定义属性中值的任何部分¹²。例如，你可以在:root上定义一个名为–main-bg-color的自定义属性，然后在其他地方使用var(–main-bg-color)来引用它的值²。var()函数的第一个参数是要替换的自定义属性的名称，第二个参数是可选的，用作回退值，如果第一个参数引用的自定义属性无效，则该函数将使用第二个值¹。</p><p>源: 与必应的对话， 2023/4/18<br>(1) var() - CSS：层叠样式表 | MDN - Mozilla Developer. <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/var">https://developer.mozilla.org/zh-CN/docs/Web/CSS/var</a>.<br>(2) CSS var() 函数 - w3school. <a href="https://www.w3school.com.cn/cssref/func_var.asp">https://www.w3school.com.cn/cssref/func_var.asp</a>.<br>(3) var() - CSS: Cascading Style Sheets | MDN - Mozilla Developer. <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/var">https://developer.mozilla.org/en-US/docs/Web/CSS/var</a>.</p></li><li><p>var()函数的第一个参数必须是一个以两个破折号开头的有效标识符，表示自定义属性的名称¹。你可以元素上定义这两个自定义属性，然后给它们赋值，例如：</p><p>:root {<br>–data-x: 50%;<br>–data-y: 50%;<br>}</p><p>或者</p><p>.btn {<br>–data-x: 50%;<br>–data-y: 50%;<br>}</p><p>然后你就可以在::before伪元素中使用var(–data-x)和var(–data-y)来引用它们的值了。</p><p>源: 与必应的对话， 2023/4/18<br>(1) var() - CSS: Cascading Style Sheets | MDN - Mozilla Developer. <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/var">https://developer.mozilla.org/en-US/docs/Web/CSS/var</a>.<br>(2) var() - CSS：层叠样式表 | MDN - Mozilla Developer. <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/var">https://developer.mozilla.org/zh-CN/docs/Web/CSS/var</a>.</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端练习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Html Css JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-AzListView</title>
      <link href="/2023/03/14/FlutterAzList_fix.html"/>
      <url>/2023/03/14/FlutterAzList_fix.html</url>
      
        <content type="html"><![CDATA[<h3 id="修复数据过少时跳转反弹">修复数据过少时跳转反弹</h3><p>修改源码中滚动代码如下所示。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _scrollTopIndex(<span class="built_in">String</span> tag) &#123;</span><br><span class="line">  <span class="built_in">int</span> index = _getIndex(tag);</span><br><span class="line">  <span class="built_in">int</span> itemsCountOnScreen = itemPositionsListener.itemPositions.value.length;</span><br><span class="line">  <span class="keyword">if</span> (index != <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="comment">//如果要跳转的条目后面的数据个数&lt;屏幕可容纳的数据个数,使用align属性去调整跳转</span></span><br><span class="line">    <span class="comment">//条目在屏幕上的位置。align默认是0，即条目的头部top与可视部分上边缘对齐。</span></span><br><span class="line">    <span class="comment">//计算正确的对齐位置，才能让它正常显示。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//if the the items&#x27;counts after the item you want to jump less than</span></span><br><span class="line">    <span class="comment">//full screen items counts, use the align to justify the item&#x27;s location</span></span><br><span class="line">    <span class="comment">// to be correct. The align defaults to be 0, which means the item&#x27;s top</span></span><br><span class="line">    <span class="comment">// to align the view&#x27;s top.</span></span><br><span class="line">    /ange the data of alignment and make it <span class="keyword">show</span> properly.</span><br><span class="line">    <span class="keyword">if</span> ((widget.data.length - index) &lt; itemsCountOnScreen) &#123;</span><br><span class="line">      <span class="comment">//可视口由两部分组成，一个是其它数据，一个是期望数据（即想要跳转却不足以填充屏幕的数据）。</span></span><br><span class="line">      <span class="comment">//用其他数据个数/总数据个数，作为alignment，就可以让期望数据正确对齐而不发生反弹。</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">//The view port includes other datas and expected datas(this refers to</span></span><br><span class="line">      <span class="comment">//the data you want to jump but can&#x27;t fill the screen and therefor causes</span></span><br><span class="line">      <span class="comment">//out bouncing).</span></span><br><span class="line">      <span class="comment">//other datas&#x27; length / all datas&#x27;length = alignment(the correct rete to align expected datas)</span></span><br><span class="line">      <span class="built_in">double</span> alignment = (itemsCountOnScreen - (widget.data.length - index)) /</span><br><span class="line">          itemsCountOnScreen;</span><br><span class="line">      itemScrollController.jumpTo(alignment: alignment, index: index);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      itemScrollController.jumpTo(index: index);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 小问题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nacos集群模式</title>
      <link href="/2023/01/05/NacosCluster.html"/>
      <url>/2023/01/05/NacosCluster.html</url>
      
        <content type="html"><![CDATA[<h3 id="nacos集群模式">Nacos集群模式</h3><p>想要使用nacos的集群模式，就需要为其配置单独的数据库。</p><ol><li>先在 mysql 数据库中创建数据库NacosDb ，再使用 conf 目录下的 nacos-mysql.sql 文件，创建相关表结构。文件如下所示。</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Copyright 1999-2018 Alibaba Group Holding Ltd.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment"> * you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment"> * You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment"> * See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment"> * limitations under the License.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = config_info   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;content&#x27;</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;md5&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  `src_user` text COMMENT <span class="string">&#x27;source user&#x27;</span>,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;source ip&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;租户字段&#x27;</span>,</span><br><span class="line">  `c_desc` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `c_use` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `effect` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `type` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `c_schema` text,</span><br><span class="line">  `encrypted_data_key` text <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;秘钥&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfo_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_info&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = config_info_aggr   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info_aggr` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `datum_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;datum_id&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;内容&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;租户字段&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfoaggr_datagrouptenantdatum` (`data_id`,`group_id`,`tenant_id`,`datum_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;增加租户字段&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = config_info_beta   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info_beta` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;app_name&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;content&#x27;</span>,</span><br><span class="line">  `beta_ips` <span class="type">varchar</span>(<span class="number">1024</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;betaIps&#x27;</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;md5&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  `src_user` text COMMENT <span class="string">&#x27;source user&#x27;</span>,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;source ip&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;租户字段&#x27;</span>,</span><br><span class="line">  `encrypted_data_key` text <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;秘钥&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfobeta_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_info_beta&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = config_info_tag   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info_tag` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_id&#x27;</span>,</span><br><span class="line">  `tag_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tag_id&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;app_name&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;content&#x27;</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;md5&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  `src_user` text COMMENT <span class="string">&#x27;source user&#x27;</span>,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;source ip&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfotag_datagrouptenanttag` (`data_id`,`group_id`,`tenant_id`,`tag_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_info_tag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = config_tags_relation   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_tags_relation` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `tag_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tag_name&#x27;</span>,</span><br><span class="line">  `tag_type` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tag_type&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_id&#x27;</span>,</span><br><span class="line">  `nid` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`nid`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configtagrelation_configidtag` (`id`,`tag_name`,`tag_type`),</span><br><span class="line">  KEY `idx_tenant_id` (`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_tag_relation&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = group_capacity   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `group_capacity` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;Group ID，空字符表示整个集群&#x27;</span>,</span><br><span class="line">  `quota` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;配额，0表示使用默认值&#x27;</span>,</span><br><span class="line">  `usage` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;使用量&#x27;</span>,</span><br><span class="line">  `max_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;单个配置大小上限，单位为字节，0表示使用默认值&#x27;</span>,</span><br><span class="line">  `max_aggr_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;聚合子配置最大个数，，0表示使用默认值&#x27;</span>,</span><br><span class="line">  `max_aggr_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;单个聚合数据的子配置大小上限，单位为字节，0表示使用默认值&#x27;</span>,</span><br><span class="line">  `max_history_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;最大变更历史数量&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_group_id` (`group_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;集群、各Group容量信息表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = his_config_info   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `his_config_info` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `nid` <span class="type">bigint</span>(<span class="number">20</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;app_name&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">  `src_user` text,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `op_type` <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;租户字段&#x27;</span>,</span><br><span class="line">  `encrypted_data_key` text <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;秘钥&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`nid`),</span><br><span class="line">  KEY `idx_gmt_create` (`gmt_create`),</span><br><span class="line">  KEY `idx_gmt_modified` (`gmt_modified`),</span><br><span class="line">  KEY `idx_did` (`data_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;多租户改造&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   数据库全名 = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   表名称 = tenant_capacity   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tenant_capacity` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;Tenant ID&#x27;</span>,</span><br><span class="line">  `quota` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;配额，0表示使用默认值&#x27;</span>,</span><br><span class="line">  `usage` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;使用量&#x27;</span>,</span><br><span class="line">  `max_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;单个配置大小上限，单位为字节，0表示使用默认值&#x27;</span>,</span><br><span class="line">  `max_aggr_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;聚合子配置最大个数&#x27;</span>,</span><br><span class="line">  `max_aggr_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;单个聚合数据的子配置大小上限，单位为字节，0表示使用默认值&#x27;</span>,</span><br><span class="line">  `max_history_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;最大变更历史数量&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_tenant_id` (`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;租户容量信息表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tenant_info` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `kp` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;kp&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_id&#x27;</span>,</span><br><span class="line">  `tenant_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_name&#x27;</span>,</span><br><span class="line">  `tenant_desc` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tenant_desc&#x27;</span>,</span><br><span class="line">  `create_source` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;create_source&#x27;</span>,</span><br><span class="line">  `gmt_create` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `gmt_modified` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_tenant_info_kptenantid` (`kp`,`tenant_id`),</span><br><span class="line">  KEY `idx_tenant_id` (`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;tenant_info&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `users` (</span><br><span class="line">`username` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">`password` <span class="type">varchar</span>(<span class="number">500</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`enabled` <span class="type">boolean</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `roles` (</span><br><span class="line">`username` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`role` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">UNIQUE</span> INDEX `idx_user_role` (`username` <span class="keyword">ASC</span>, `role` <span class="keyword">ASC</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `permissions` (</span><br><span class="line">    `role` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `resource` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `action` <span class="type">varchar</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">UNIQUE</span> INDEX `uk_role_permission` (`role`,`resource`,`action`) <span class="keyword">USING</span> BTREE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (username, password, enabled) <span class="keyword">VALUES</span> (<span class="string">&#x27;nacos&#x27;</span>, <span class="string">&#x27;$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu&#x27;</span>, <span class="literal">TRUE</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> roles (username, role) <span class="keyword">VALUES</span> (<span class="string">&#x27;nacos&#x27;</span>, <span class="string">&#x27;ROLE_ADMIN&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li><p>配置 conf 目录下的 application.properties 配置文件，重要几项如下所示，主要是配置当前节点的一些信息，而且，有几个nacos节点就要复制几个nacos文件夹作相同的配置。</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Default web context path:</span></span><br><span class="line"><span class="attr">server.servlet.contextPath</span>=<span class="string">/nacos</span></span><br><span class="line"><span class="comment">### Include message field</span></span><br><span class="line"><span class="attr">server.error.include-message</span>=<span class="string">ON_PARAM</span></span><br><span class="line"><span class="comment">### 当前nacos节点对应端口号</span></span><br><span class="line"><span class="comment">### Default web server port:</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8841</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#*************** Network Related Configurations ***************#</span></span><br><span class="line"><span class="comment">### If prefer hostname over ip for Nacos server addresses in cluster.conf:</span></span><br><span class="line"><span class="comment"># nacos.inetutils.prefer-hostname-over-ip=false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### Specify local server&#x27;s IP:</span></span><br><span class="line"><span class="comment"># nacos.inetutils.ip-address=</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#*************** Config Module Related Configurations ***************#</span></span><br><span class="line"><span class="comment">### 下面这项需要去掉注释，因为我们要配置数据库</span></span><br><span class="line"><span class="comment">### If use MySQL as datasource:</span></span><br><span class="line"><span class="attr">spring.datasource.platform</span>=<span class="string">mysql</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### 数据库的数量</span></span><br><span class="line"><span class="comment">### Count of DB:</span></span><br><span class="line"><span class="attr">db.num</span>=<span class="string">1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">### Connect URL of DB:</span></span><br><span class="line"><span class="attr">db.url.0</span>=<span class="string">jdbc:mysql://www.kahvia.cn:3306/NacosDb（这是我创建的数据库名称）?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="attr">db.user.0</span>=<span class="string">数据库账号</span></span><br><span class="line"><span class="attr">db.password.0</span>=<span class="string">密码</span></span><br></pre></td></tr></table></figure></li><li><p>配置 cluster.conf (需要去掉example后缀), 即便是本地配置，也不能使用 localhost 或者127.0.0.1。要使用通过 cmd 和 ipconfig 查看到的ipv4地址，<a href="https://blog.csdn.net/u010696630/article/details/123617028">原因在这里</a>。端口也不能连续，<a href="https://blog.csdn.net/w_e_i_a_i_/article/details/121993518">原因在这里</a>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 列出各 nacos 节点的ip地址和端口号。谁让它们是一起作负载均衡用的呢？</span><br><span class="line">192.168.137.1:8841</span><br><span class="line">192.168.137.1:8843</span><br></pre></td></tr></table></figure></li><li><p>配置nginx，对于上方配置的nacos节点作负载均衡。因为微服务可能有很多很多，注册中心由一个nacos节点来可能不够用。所以上面配置了多个nacos节点，再采用nginx作负载均衡。nginx.conf 文件如下所示。</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#user  nobody;</span></span><br><span class="line"><span class="attribute">worker_processes</span>  <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span>  <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">include</span>       mime.types;</span><br><span class="line">    <span class="attribute">default_type</span>  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#access_log  logs/access.log  main;</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">sendfile</span>        <span class="literal">on</span>;</span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    <span class="attribute">keepalive_timeout</span>  <span class="number">65</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#gzip  on;</span></span><br><span class="line"></span><br><span class="line"><span class="section">upstream</span> nacos-cluster &#123;</span><br><span class="line"><span class="attribute">server</span> <span class="number">127.0.0.1:8841</span>;</span><br><span class="line"><span class="attribute">server</span> <span class="number">127.0.0.1:8843</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  localhost;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#charset koi8-r;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#access_log  logs/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">            <span class="attribute">root</span>   html;</span><br><span class="line">            <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="section">location</span> /nacos &#123;</span><br><span class="line"><span class="attribute">proxy_pass</span> http://nacos-cluster;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="attribute">error_page</span>   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /50x.html;</span><br><span class="line">        <span class="section">location</span> = /50x.html &#123;</span><br><span class="line">            <span class="attribute">root</span>   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    root           html;</span></span><br><span class="line">        <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">        <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">        <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">        <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">        <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">        <span class="comment">#    deny  all;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># another virtual host using mix of IP-, name-, and port-based configuration</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       8000;</span></span><br><span class="line">    <span class="comment">#    listen       somename:8080;</span></span><br><span class="line">    <span class="comment">#    server_name  somename  alias  another.alias;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># HTTPS server</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       443 ssl;</span></span><br><span class="line">    <span class="comment">#    server_name  localhost;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_certificate      cert.pem;</span></span><br><span class="line">    <span class="comment">#    ssl_certificate_key  cert.key;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_session_cache    shared:SSL:1m;</span></span><br><span class="line">    <span class="comment">#    ssl_session_timeout  5m;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span></span><br><span class="line">    <span class="comment">#    ssl_prefer_server_ciphers  on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>配置完nginx，依次启动各nacos节点，再启动nginx即可。</p></li><li><p>最后启动各项 spring boot 微服务。需要配置 nacos 服务端地址，也就是上面作负载均衡的地址。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://xxx.xxx.xxx:3306/xxx?serverTimezone=GMT%2B8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">xxxxx</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">xxxxx</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">ImageService</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.137</span><span class="number">.1</span><span class="string">:80</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">39941</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><p>最后附上一张效果图。</p><p><img src="https://pics.kahvia.cn/img/image-20230105202443232.png" alt="nacos集群模式效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MicroService </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android button 修改背景颜色</title>
      <link href="/2022/12/23/AndroidButtonBackground.html"/>
      <url>/2022/12/23/AndroidButtonBackground.html</url>
      
        <content type="html"><![CDATA[<p>在 themes.xml 中，style的parent如下所示。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;Theme.AndroidUiDesign&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.MaterialComponents.DayNight.NoActionBar&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这时候，app中按钮的背景颜色会是主题色，自己设置的背景色则会被主题色覆盖。</p><p>修改成下面这样子就可以正常显示自定义背景颜色了。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;Theme.AndroidUiDesign&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.MaterialComponents.DayNight.NoActionBar.Bridge&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>material design官方文档是这样解释的。</p><blockquote><h4 id="bridge-themes"><strong>Bridge Themes</strong></h4><p>If you cannot change your theme to inherit from a Material Components theme, you can inherit from a Material Components <strong>Bridge</strong> theme.</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;Theme.MyApp&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.MaterialComponents.Light.Bridge&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- ... --&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Both Theme.MaterialComponents and Theme.MaterialComponents.Light have .Bridge themes:</p><ul><li>Theme.MaterialComponents.Bridge</li><li>Theme.MaterialComponents.Light.Bridge</li><li>Theme.MaterialComponents.NoActionBar.Bridge</li><li>Theme.MaterialComponents.Light.NoActionBar.Bridge</li><li>Theme.MaterialComponents.Light.DarkActionBar.Bridge</li></ul><p>Bridge themes inherit from AppCompat themes, but also define the new Material Components theme attributes for you. If you use a bridge theme, you can start using Material Design components without changing your app theme.</p></blockquote><p>大致意思就是，如果我们既想要保留我们的自定义样式，比如按钮背景啥的，又想要用这种比较新的主题，就可以使用Bridge主题。毕竟是桥嘛，两边都要也很合理。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AndroidViewPager2</title>
      <link href="/2022/12/22/AndroidViewPager2.html"/>
      <url>/2022/12/22/AndroidViewPager2.html</url>
      
        <content type="html"><![CDATA[<h3 id="what-s-this">What’s this ?</h3><p>​ViewPager2，它可以用来制作可以滑动切换的小卡片。相当于Flutter里面的 PageView 。</p><h3 id="使用方法">使用方法</h3><p>​在想要使用的地方加入 ViewPager2 节点，创建每一项子节点的布局文件，并实现 ViewPager2 的适配器 adaptor 。大体步骤和ListView 的使用差不多。</p><p>​涉及到以下三个文件。activity_pages.xml, viewpager_item.xml, CardItem.java, ViewPagerAdaptor.java 。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.PagesActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@color/black&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.viewpager2.widget.ViewPager2</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/viewPager2&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;450dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;40dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.cardview.widget.CardView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:cardElevation</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/itemImg&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;200dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:src</span>=<span class="string">&quot;@drawable/girlandcat&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:scaleType</span>=<span class="string">&quot;centerCrop&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/itemTitle&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;50dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@id/itemImg&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;Study&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;35sp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:fontFamily</span>=<span class="string">&quot;cursive&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@+id/itemContent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:maxHeight</span>=<span class="string">&quot;130dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:overScrollMode</span>=<span class="string">&quot;ifContentScrolls&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">&quot;@id/itemTitle&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;As you can see,I want to study and make my own progress.&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textStyle</span>=<span class="string">&quot;bold&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:fontFamily</span>=<span class="string">&quot;cursive&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">&quot;start&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginHorizontal</span>=<span class="string">&quot;20dp&quot;</span></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@drawable/card_button_background&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.cardview.widget.CardView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.androiduidesign.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CardItem</span> &#123;</span><br><span class="line">    <span class="type">int</span> imageId;</span><br><span class="line">    String title,content;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CardItem</span><span class="params">(<span class="type">int</span> imageId, String title, String content)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.imageId = imageId;</span><br><span class="line">        <span class="built_in">this</span>.title = title;</span><br><span class="line">        <span class="built_in">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getImageId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> imageId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setImageId</span><span class="params">(<span class="type">int</span> imageId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.imageId = imageId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTitle</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTitle</span><span class="params">(String title)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.title = title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getContent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContent</span><span class="params">(String content)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.androiduidesign.adaptors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"><span class="keyword">import</span> android.widget.ImageView;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.NonNull;</span><br><span class="line"><span class="keyword">import</span> androidx.recyclerview.widget.RecyclerView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.kahvia.androiduidesign.R;</span><br><span class="line"><span class="keyword">import</span> cn.kahvia.androiduidesign.pojo.CardItem;</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承时传入泛型为内部类ViewHolder，这个Holder用来保存通过view findViewById方法获得的组件，这样只需要find一次足矣</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewPagerAdaptor</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.Adapter&lt;ViewPagerAdaptor.ViewHolder&gt; &#123;</span><br><span class="line">    <span class="comment">//要展示的列表数据</span></span><br><span class="line">    List&lt;CardItem&gt; cardItems;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造函数，必需。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ViewPagerAdaptor</span><span class="params">(List&lt;CardItem&gt; cardItems)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.cardItems=cardItems;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//内部类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ViewHolder</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.ViewHolder&#123;</span><br><span class="line">        ImageView image;</span><br><span class="line">        TextView title;</span><br><span class="line">        TextView content;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ViewHolder</span><span class="params">(<span class="meta">@NonNull</span> View itemView)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(itemView);</span><br><span class="line">            image=itemView.findViewById(R.id.itemImg);</span><br><span class="line">            title=itemView.findViewById(R.id.itemTitle);</span><br><span class="line">            content=itemView.findViewById(R.id.itemContent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span><span class="comment">//创建ViewHolder</span></span><br><span class="line">    <span class="keyword">public</span> ViewPagerAdaptor.ViewHolder <span class="title function_">onCreateViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewGroup parent, <span class="type">int</span> viewType)</span> &#123;</span><br><span class="line">        <span class="comment">//创建一个view，在父节点的上下文中填充一个View</span></span><br><span class="line">        View view= LayoutInflater.from(parent.getContext()).inflate(R.layout.viewpager_item,parent,<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//创建一个ViewHolder。多个ViewHolder可以实现View的复用，无需反复创建View。</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ViewHolder</span>(view);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span><span class="comment">//快速赋值，实现view的迅速加载</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBindViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewPagerAdaptor.ViewHolder holder, <span class="type">int</span> position)</span> &#123;</span><br><span class="line">        CardItem cardItem=cardItems.get(position);</span><br><span class="line">        holder.image.setImageResource(cardItem.getImageId());</span><br><span class="line">        holder.title.setText(cardItem.getTitle());</span><br><span class="line">        holder.content.setText(cardItem.getContent());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getItemCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cardItems.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ps">ps</h3><ul><li>ViewPager2 的子节点要设置为 match_parent .</li></ul><h3 id="效果图">效果图</h3><p><img src="https://pics.kahvia.cn/img/image-20221222235846505.png" alt="page1"></p><p><img src="https://pics.kahvia.cn/img/image-20221222235924994.png" alt="page2"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MixContent</title>
      <link href="/2022/12/15/HttpMixContent.html"/>
      <url>/2022/12/15/HttpMixContent.html</url>
      
        <content type="html"><![CDATA[<h3 id="问题发生场景">问题发生场景</h3><p>在本地测试前后端项目的时候一切正常。当我将前端项目和后端项目打包并部署到服务器后，前端项目无法正常访问后端接口。浏览器控制台报错为“已阻止混合内容”，即mix content。</p><p>经过百度得知，mix content 常在 https 页面访问 http 接口时发生。</p><p>由于我的服务器上的tomcat之前就已经配置过SSL证书，所以部署在那个 tomcat 中的项目资源都会以https的方式访问。但是我这个后端项目是spring boot项目，使用的是内置的tomcat，所以直接部署后启动的是 http 服务。我 https 的页面访问了我 http 的接口，就产生了错误。</p><h3 id="解决方案">解决方案</h3><ol><li>去除服务器上 tomcat 的SSL配置。（不合适）</li><li>为后端spring boot项目配置SSL证书。（目前适用于我）</li></ol><h3 id="方案实施">方案实施</h3><ol><li>下载自己的SSL证书，将 jks 后缀的文件放在项目的 resource 目录下。</li><li>完善项目的配置文件，我这里用的是 yml 配置文件。</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="string">xxxxx</span></span><br><span class="line">  <span class="attr">ssl:</span></span><br><span class="line">    <span class="attr">key-store:</span> <span class="string">classpath:www.kahvia.cn.jks</span></span><br><span class="line">    <span class="attr">key-store-type:</span> <span class="string">JKS</span> <span class="comment">#证书文件类型</span></span><br><span class="line">    <span class="attr">key-store-password:</span> <span class="string">xxxxxxxx</span> <span class="comment">#证书下载时包含的密码</span></span><br></pre></td></tr></table></figure><h3 id="补充">补充</h3><ul><li>Mix Content 的错误不会在 http 页面请求 https 接口的时候发生。也就是说，当我为spring boot配置SSL证书后，本地项目仍然可以正常访问已经部署的后端项目。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 小问题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql-Uft8mb4</title>
      <link href="/2022/11/29/MysqlUtf8mb4.html"/>
      <url>/2022/11/29/MysqlUtf8mb4.html</url>
      
        <content type="html"><![CDATA[<h3 id="问题">问题</h3><p>在使用MySQL数据库存储数据的时候，意外发现不能存储Emoji表情😄。经过百度查证得知，mysql默认的 utf8 是三个字节的，存储不了四个字节的生僻字或者Emoji表情。需要换成支持四个字节的 utf8mb4 ，也就是UTF-8 most byte 4 。</p><h3 id="解决">解决</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 数据库更换字符集</span><br><span class="line">ALTER DATABASE AchatUserService CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci;</span><br><span class="line"># 表更换字符集</span><br><span class="line">ALTER TABLE friendship CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</span><br><span class="line"># 需要改变的列进行更换字符集</span><br><span class="line">ALTER TABLE messages CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</span><br></pre></td></tr></table></figure><p>仅仅这样是不够的。在建立数据库连接的地方，还需要指定UTF-8字符集。比如在Spring boot项目的配置文件中，指定数据库连接的 url 处。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/AchatUserService?serverTimezone=GMT%2B8&amp;characterEncoding=utf-8</span> <span class="comment"># here</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">xxxx</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">multipart:</span></span><br><span class="line">      <span class="attr">max-file-size:</span> <span class="string">100MB</span></span><br><span class="line">      <span class="attr">max-request-size:</span> <span class="string">500MB</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">39939</span></span><br></pre></td></tr></table></figure><p>不指定 utf-8 的话，估计默认是按照 utf8mb3 去连接的吧，这样是修改不了设置了 utf8mb4 字符集的数据的。（这可是重点所在）</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-VerticalText</title>
      <link href="/2022/11/19/FlutterVerticalText.html"/>
      <url>/2022/11/19/FlutterVerticalText.html</url>
      
        <content type="html"><![CDATA[<h3 id="需求">需求</h3><p>今天有人问了我一个很有意思的问题：如何实现文字竖直排列，就像古诗词一样。</p><h3 id="思路">思路</h3><p>我首先想到的是使用 Container 组件嵌套 Text 组件，固定它的宽度，这样来实现一行一个文字。看起来就像竖直排列一样。但是它的文字垂直间距很显然不方便控制。</p><p>我便去 StackOverflow 上搜索了一番 vertical text。果然有所收获。有人提出，使用 Wrap 组件去实现这个功能。分割需要竖直排列的字符串为单个字，用 Text 组件包裹每个字，然后利用 Wrap 组件的 direction 使得这些 Text 列表垂直排列，排不下则往右边另起一列。</p><p>我自然是希望古诗一列一句的。所以就不用考虑超出换列，手动分割当然最好。既然使用不到 Wrap ，用各种 ListView 来展示上面的 Text 们也是可以的。</p><p>当然了，如果是显示的宋词，那一句太长也是有可能的，为了保险起见，我还是使用了Wrap做了超出处理。</p><p>如此一来，就可以着手实现了。封装一个用 Wrap 为核心的自定义组件，主要用于展示古诗的一句。我们拿到一个古诗后，可以将古诗按标点符号分割，分割后的句子用自定义的 VerticalText 显示就可以了。我更倾向于用 Row 组件去显示，因为我能用它决定主轴方向和交叉轴方向的起点，这能做到古诗句的上对齐，和右对齐。用 ListView 的话，可以很方便地翻转古诗句的顺序，但是不太方便对齐。</p><p>具体的实现可以参考如下代码。</p><h3 id="代码">代码</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;<span class="keyword">super</span>.key&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">List</span>&lt;VerticalText&gt; poetry=<span class="keyword">const</span>[</span><br><span class="line">      VerticalText(<span class="string">&quot;将进酒，&quot;</span>),</span><br><span class="line">      VerticalText(<span class="string">&quot;杯莫停。&quot;</span>),</span><br><span class="line">      VerticalText(<span class="string">&quot;与君歌一曲,&quot;</span>),</span><br><span class="line">      VerticalText(<span class="string">&quot;请君为我倾耳听。&quot;</span>)</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: <span class="keyword">const</span> Text(<span class="string">&quot;test&quot;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: Row(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.end,</span><br><span class="line">          crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">          children: <span class="built_in">List</span>.from(poetry.reversed) ,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VerticalText</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> text;</span><br><span class="line">  <span class="keyword">const</span> VerticalText(<span class="keyword">this</span>.text,&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">//分割字符串为单字，每个字包裹一个Text组件，作为Wrap组件的子组件</span></span><br><span class="line">    <span class="built_in">List</span>&lt;Text&gt; texts=text.split(<span class="string">&quot;&quot;</span>).map((string) =&gt; Text(string, style: <span class="keyword">const</span> TextStyle(fontSize: <span class="number">17</span>))).toList();</span><br><span class="line">    <span class="keyword">return</span> Padding(</span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">10</span>),</span><br><span class="line">      child: Wrap(</span><br><span class="line">        <span class="comment">//排列方式，vertical代表竖着排，排不够就往旁边排</span></span><br><span class="line">        direction: Axis.vertical,</span><br><span class="line">        <span class="comment">//主轴方向上间距</span></span><br><span class="line">        spacing: <span class="number">20</span>,</span><br><span class="line">        <span class="comment">//交叉轴方向上间距</span></span><br><span class="line">        runSpacing: <span class="number">30</span>,</span><br><span class="line">        alignment: WrapAlignment.center,</span><br><span class="line">        children: texts,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pics.kahvia.cn/img/image-20221119145723737.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OS-Lab2</title>
      <link href="/2022/11/13/OS-lab2.html"/>
      <url>/2022/11/13/OS-lab2.html</url>
      
        <content type="html"><![CDATA[<h2 id="练习0">练习0</h2><blockquote><p>练习0：填写已有实验<br>本实验依赖实验1。请把你做的实验1的代码填入本实验中代码中有“LAB1”的注释相应部分。</p></blockquote><p>使用 Meld Diff Viewer 将 lab1 的代码填入了 lab2 的相应位置。</p><h2 id="练习1">练习1</h2><blockquote><p>练习1：实现 first-fit 连续物理内存分配算法（需要编程）<br>在实现first fit 内存分配算法的回收函数时，要考虑地址连续的空闲块之间的合并操作。提示:在建立空闲页块链表时，需要按照空闲页块起始地址来排序，形成一个有序的链表。可能会修改default_pmm.c中的default_init，default_init_memmap，default_alloc_pages，default_free_pages等相关函数。请仔细查看和理解default_pmm.c中的注释。<br>请在实验报告中简要说明你的设计实现过程。请回答如下问题：<br>你的first fit算法是否有进一步的改进空间</p></blockquote><ol><li>进入ucore操作系统之后，第一个执行的函数是 default_init_memmap，对内核进行初始化。在其中，调用了初始化物理内存的函数 pmm_init 。</li><li>这个函数主要是完成对于整个物理内存的初始化，页初始化只是其中的一部分，调用位置偏前，函数之后的部分可以不管，直接进入page_init函数。</li><li>函数 page_init 完成了一个整体物理地址的初始化过程。</li><li>页初始化部分，由函数 init_memmap 处理。</li></ol><p>在 kern/mm/default_pmm.c 文件中，修改各个函数。</p><h3 id="1">1</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line"><span class="title function_">default_init_memmap</span><span class="params">(<span class="keyword">struct</span> Page *base, <span class="type">size_t</span> n)</span> &#123;</span><br><span class="line">    assert(n &gt; <span class="number">0</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">p</span> =</span> base;</span><br><span class="line">    <span class="keyword">for</span> (; p != base + n; p ++) &#123;</span><br><span class="line">        assert(PageReserved(p));</span><br><span class="line">        p-&gt;flags = <span class="number">0</span>;</span><br><span class="line">        SetPageProperty(p);</span><br><span class="line">        p-&gt;property = <span class="number">0</span>;</span><br><span class="line">        set_page_ref(p, <span class="number">0</span>);</span><br><span class="line">        list_add_before(&amp;free_list, &amp;(p-&gt;page_link));</span><br><span class="line">    &#125;</span><br><span class="line">    nr_free += n;</span><br><span class="line">    <span class="comment">//first block</span></span><br><span class="line">    base-&gt;property = n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2">2</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="keyword">struct</span> Page *</span><br><span class="line"><span class="title function_">default_alloc_pages</span><span class="params">(<span class="type">size_t</span> n)</span> &#123;</span><br><span class="line">    assert(n &gt; <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (n &gt; nr_free) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">list_entry_t</span> *le, *len;</span><br><span class="line">    le = &amp;free_list;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((le=list_next(le)) != &amp;free_list) &#123;</span><br><span class="line">      <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">p</span> =</span> le2page(le, page_link);</span><br><span class="line">      <span class="keyword">if</span>(p-&gt;property &gt;= n)&#123;</span><br><span class="line">        <span class="type">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">          len = list_next(le);</span><br><span class="line">          <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">pp</span> =</span> le2page(le, page_link);</span><br><span class="line">          SetPageReserved(pp);</span><br><span class="line">          ClearPageProperty(pp);</span><br><span class="line">          list_del(le);</span><br><span class="line">          le = len;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;property&gt;n)&#123;</span><br><span class="line">          (le2page(le,page_link))-&gt;property = p-&gt;property - n;</span><br><span class="line">        &#125;</span><br><span class="line">        ClearPageProperty(p);</span><br><span class="line">        SetPageReserved(p);</span><br><span class="line">        nr_free -= n;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3">3</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line"><span class="title function_">default_free_pages</span><span class="params">(<span class="keyword">struct</span> Page *base, <span class="type">size_t</span> n)</span> &#123;</span><br><span class="line">    assert(n &gt; <span class="number">0</span>);</span><br><span class="line">    assert(PageReserved(base));</span><br><span class="line"></span><br><span class="line">    <span class="type">list_entry_t</span> *le = &amp;free_list;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> * <span class="title">p</span>;</span></span><br><span class="line">    <span class="keyword">while</span>((le=list_next(le)) != &amp;free_list) &#123;</span><br><span class="line">      p = le2page(le, page_link);</span><br><span class="line">      <span class="keyword">if</span>(p&gt;base)&#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//list_add_before(le, base-&gt;page_link);</span></span><br><span class="line">    <span class="keyword">for</span>(p=base;p&lt;base+n;p++)&#123;</span><br><span class="line">      list_add_before(le, &amp;(p-&gt;page_link));</span><br><span class="line">    &#125;</span><br><span class="line">    base-&gt;flags = <span class="number">0</span>;</span><br><span class="line">    set_page_ref(base, <span class="number">0</span>);</span><br><span class="line">    ClearPageProperty(base);</span><br><span class="line">    SetPageProperty(base);</span><br><span class="line">    base-&gt;property = n;</span><br><span class="line">    </span><br><span class="line">    p = le2page(le,page_link) ;</span><br><span class="line">    <span class="keyword">if</span>( base+n == p )&#123;</span><br><span class="line">      base-&gt;property += p-&gt;property;</span><br><span class="line">      p-&gt;property = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    le = list_prev(&amp;(base-&gt;page_link));</span><br><span class="line">    p = le2page(le, page_link);</span><br><span class="line">    <span class="keyword">if</span>(le!=&amp;free_list &amp;&amp; p==base<span class="number">-1</span>)&#123;</span><br><span class="line">      <span class="keyword">while</span>(le!=&amp;free_list)&#123;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;property)&#123;</span><br><span class="line">          p-&gt;property += base-&gt;property;</span><br><span class="line">          base-&gt;property = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        le = list_prev(le);</span><br><span class="line">        p = le2page(le,page_link);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    nr_free += n;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="练习2">练习2</h2><blockquote><p>练习2：实现寻找虚拟地址对应的页表项（需要编程）<br>通过设置页表和对应的页表项，可建立虚拟内存地址和物理内存地址的对应关系。其中的get_pte函数是设置页表项环节中的一个重要步骤。此函数找到一个虚地址对应的二级页表项的内核虚地址，如果此二级页表项不存在，则分配一个包含此项的二级页表。本练习需要补全get_pte函数 in kern/mm/pmm.c，实现其功能。</p></blockquote><p>打开 pmm.c 文件，根据注释实现代码如下。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//get_pte - get pte and return the kernel virtual address of this pte for la</span></span><br><span class="line"><span class="comment">//        - if the PT contians this pte didn&#x27;t exist, alloc a page for PT</span></span><br><span class="line"><span class="comment">// parameter:</span></span><br><span class="line"><span class="comment">//  pgdir:  the kernel virtual base address of PDT</span></span><br><span class="line"><span class="comment">//  la:     the linear address need to map</span></span><br><span class="line"><span class="comment">//  create: a logical value to decide if alloc a page for PT</span></span><br><span class="line"><span class="comment">// return vaule: the kernel virtual address of this pte</span></span><br><span class="line"><span class="type">pte_t</span> *</span><br><span class="line"><span class="title function_">get_pte</span><span class="params">(<span class="type">pde_t</span> *pgdir, <span class="type">uintptr_t</span> la, <span class="type">bool</span> create)</span> &#123;</span><br><span class="line">    <span class="comment">/* LAB2 EXERCISE 2: YOUR CODE</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * If you need to visit a physical address, please use KADDR()</span></span><br><span class="line"><span class="comment">     * please read pmm.h for useful macros</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Maybe you want help comment, BELOW comments can help you finish the code</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Some Useful MACROs and DEFINEs, you can use them in below implementation.</span></span><br><span class="line"><span class="comment">     * MACROs or Functions:</span></span><br><span class="line"><span class="comment">     *   PDX(la) = the index of page directory entry of VIRTUAL ADDRESS la.</span></span><br><span class="line"><span class="comment">     *   KADDR(pa) : takes a physical address and returns the corresponding kernel virtual address.</span></span><br><span class="line"><span class="comment">     *   set_page_ref(page,1) : means the page be referenced by one time</span></span><br><span class="line"><span class="comment">     *   page2pa(page): get the physical address of memory which this (struct Page *) page  manages</span></span><br><span class="line"><span class="comment">     *   struct Page * alloc_page() : allocation a page</span></span><br><span class="line"><span class="comment">     *   memset(void *s, char c, size_t n) : sets the first n bytes of the memory area pointed by s</span></span><br><span class="line"><span class="comment">     *                                       to the specified value c.</span></span><br><span class="line"><span class="comment">     * DEFINEs:</span></span><br><span class="line"><span class="comment">     *   PTE_P           0x001                   // page table/directory entry flags bit : Present</span></span><br><span class="line"><span class="comment">     *   PTE_W           0x002                   // page table/directory entry flags bit : Writeable</span></span><br><span class="line"><span class="comment">     *   PTE_U           0x004                   // page table/directory entry flags bit : User can access</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    <span class="type">pde_t</span> *pdep = <span class="literal">NULL</span>;   <span class="comment">// (1) find page directory entry</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span>) &#123;              <span class="comment">// (2) check if entry is not present</span></span><br><span class="line">                          <span class="comment">// (3) check if creating is needed, then alloc page for page table</span></span><br><span class="line">                          <span class="comment">// CAUTION: this page is used for page table, not for common data page</span></span><br><span class="line">                          <span class="comment">// (4) set page reference</span></span><br><span class="line">        <span class="type">uintptr_t</span> pa = <span class="number">0</span>; <span class="comment">// (5) get linear address of page</span></span><br><span class="line">                          <span class="comment">// (6) clear page content using memset</span></span><br><span class="line">                          <span class="comment">// (7) set page directory entry&#x27;s permission</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;          <span class="comment">// (8) return page table entry</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="comment">//尝试获得页表</span></span><br><span class="line">    <span class="type">pde_t</span> *pdep = &amp;pgdir[PDX(la)]; </span><br><span class="line">    <span class="comment">//若是获取不成功</span></span><br><span class="line">    <span class="keyword">if</span> (!(*pdep &amp; PTE_P)) &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">page</span>;</span></span><br><span class="line">        <span class="comment">//若是不需要创建或者创建失败</span></span><br><span class="line">        <span class="keyword">if</span> (!create || (page = alloc_page()) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//增加引用次数</span></span><br><span class="line">        set_page_ref(page, <span class="number">1</span>);</span><br><span class="line">        <span class="comment">//得到该页物理地址</span></span><br><span class="line">        <span class="type">uintptr_t</span> pa = page2pa(page);</span><br><span class="line">        <span class="comment">//物理地址转虚拟地址并初始化</span></span><br><span class="line">        <span class="built_in">memset</span>(KADDR(pa), <span class="number">0</span>, PGSIZE);</span><br><span class="line">        <span class="comment">//设置控制位</span></span><br><span class="line">        *pdep = pa | PTE_U | PTE_W | PTE_P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回的是虚拟地址la对应的页表项入口地址</span></span><br><span class="line">    <span class="keyword">return</span> &amp;((<span class="type">pte_t</span> *)KADDR(PDE_ADDR(*pdep)))[PTX(la)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>首先尝试使用PDX函数，获取一级页表的位置，如果获取成功，可以直接返回。</li><li>如果获取不成功，那么需要根据create标记位来决定是否创建这一个二级页表（注意，一级页表中，存储的都是二级页表的起始地址）。如果create为0，那么不创建，否则创建。</li><li>既然需要查找这个页表，那么页表的引用次数就要加一。</li><li>之后，需要使用memset将新建的这个页表虚拟地址，全部设置为0，因为这个页所代表的虚拟地址都没有被映射。</li><li>接下来是设置控制位。这里应该设置同时设置上PTE_U、PTE_W和PTE_P，分别代表用户态的软件可以读取对应地址的物理内存页内容、物理内存页内容可写、物理内存页存在。</li></ul><h2 id="练习3">练习3</h2><blockquote><p>练习3：释放某虚地址所在的页并取消对应二级页表项的映射（需要编程）<br>当释放一个包含某虚地址的物理内存页时，需要让对应此物理内存页的管理数据结构Page做相关的清除处理，使得此物理内存页成为空闲；另外还需把表示虚地址与物理地址对应关系的二级页表项清除。请仔细查看和理解page_remove_pte函数中的注释。为此，需要补全在<br>kern/mm/pmm.c中的page_remove_pte函数。page_remove_pte函数的调用关系图如下所示：<br>图2 page_remove_pte函数的调用关系图<br>请在实验报告中简要说明你的设计实现过程。请回答如下问题：<br>数据结构Page的全局变量（其实是一个数组）的每一项与页表中的页目录项和页表项有无对应关系？如果有，其对应关系是啥？<br>如果希望虚拟地址与物理地址相等，则需要如何修改lab2，完成此事？ 鼓励通过编程来具体完成这个问题</p></blockquote><h3 id="1">1</h3><p>page_remove_pte函数补全如下。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//page_remove_pte - free an Page sturct which is related linear address la</span></span><br><span class="line"><span class="comment">//                - and clean(invalidate) pte which is related linear address la</span></span><br><span class="line"><span class="comment">//note: PT is changed, so the TLB need to be invalidate </span></span><br><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span></span><br><span class="line"><span class="title function_">page_remove_pte</span><span class="params">(<span class="type">pde_t</span> *pgdir, <span class="type">uintptr_t</span> la, <span class="type">pte_t</span> *ptep)</span> &#123;</span><br><span class="line">    <span class="comment">/* LAB2 EXERCISE 3: YOUR CODE</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Please check if ptep is valid, and tlb must be manually updated if mapping is updated</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Maybe you want help comment, BELOW comments can help you finish the code</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Some Useful MACROs and DEFINEs, you can use them in below implementation.</span></span><br><span class="line"><span class="comment">     * MACROs or Functions:</span></span><br><span class="line"><span class="comment">     *   struct Page *page pte2page(*ptep): get the according page from the value of a ptep</span></span><br><span class="line"><span class="comment">     *   free_page : free a page</span></span><br><span class="line"><span class="comment">     *   page_ref_dec(page) : decrease page-&gt;ref. NOTICE: ff page-&gt;ref == 0 , then this page should be free.</span></span><br><span class="line"><span class="comment">     *   tlb_invalidate(pde_t *pgdir, uintptr_t la) : Invalidate a TLB entry, but only if the page tables being</span></span><br><span class="line"><span class="comment">     *                        edited are the ones currently in use by the processor.</span></span><br><span class="line"><span class="comment">     * DEFINEs:</span></span><br><span class="line"><span class="comment">     *   PTE_P           0x001                   // page table/directory entry flags bit : Present</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> 0</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span>) &#123;                      <span class="comment">//(1) check if this page table entry is present</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">page</span> =</span> <span class="literal">NULL</span>; <span class="comment">//(2) find corresponding page to pte</span></span><br><span class="line">                                  <span class="comment">//(3) decrease page reference</span></span><br><span class="line">                                  <span class="comment">//(4) and free this page when page reference reachs 0</span></span><br><span class="line">                                  <span class="comment">//(5) clear second page table entry</span></span><br><span class="line">                                  <span class="comment">//(6) flush tlb</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="keyword">if</span> (*ptep &amp; PTE_P) &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Page</span> *<span class="title">page</span> =</span> pte2page(*ptep);</span><br><span class="line">        <span class="keyword">if</span> (page_ref_dec(page) == <span class="number">0</span>) &#123;</span><br><span class="line">            free_page(page);</span><br><span class="line">        &#125;</span><br><span class="line">        *ptep = <span class="number">0</span>;</span><br><span class="line">        tlb_invalidate(pgdir, la);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先判断该页被引用的次数，如果只被引用了一次，那么直接释放掉这页， 否则就删掉二级页表的该表项，即该页的入口。我们先将物理页的引用数目减一，如果变为零，那么释放页面；然后将页目录项清零，刷新页表，即可取消页表映射。</p><h3 id="2">2</h3><p>数据结构Page的全局变量的每一项与页表中的页目录项和页表项有关系。数据结构page是最低级的页表，目录项是一级页表，存储的内容是页表项的起始地址（二级页表），而页表项是二级页表，存储的是每个页表的开始地址，这些内容之间的关系时通过线性地址高低位不同功能的寻址体现的。</p><h3 id="3">3</h3><p>物理地址和虚拟地址之间存在一定偏移offset，通常，这个offset，就是KERNBASE，是由操作系统决定的，而ucore中，定义在（kern/mm/memlayout.h）。KERNBASE为虚拟地址空间中的内核基址，即偏移量。如果想要让虚拟地址与物理地址相等，就需要修改偏移值为0。</p><p>修改位置如图所示。</p><p><img src="https://pics.kahvia.cn/img/image-20221113195348463.png" alt="image-20221113195348463"></p>]]></content>
      
      
      <categories>
          
          <category> 课程实验 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OS-Lab1</title>
      <link href="/2022/11/13/OS-lab1.html"/>
      <url>/2022/11/13/OS-lab1.html</url>
      
        <content type="html"><![CDATA[<h2 id="练习1">练习1</h2><blockquote><p>练习1：理解通过make生成执行文件的过程。（要求在报告中写出对下述问题的回答）<br>列出本实验各练习中对应的OS原理的知识点，并说明本实验中的实现部分如何对应和体现了原理中的基本概念和关键知识点。<br>在此练习中，大家需要通过静态分析代码来了解：</p><p>1.操作系统镜像文件ucore.img是如何一步一步生成的？(需要比较详细地解释Makefile中每一条相关命令和命令参数的含义，以及说明命令导致的结果)</p><p>2.一个被系统认为是符合规范的硬盘主引导扇区的特征是什么？</p></blockquote><h3 id="1">1</h3><h4 id="过程">过程</h4><p>输入make “V=” 得到详细的make过程如下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">[~/moocos/ucore_lab/labcodes/lab1]</span><br><span class="line">moocos-&gt; make <span class="string">&quot;V=&quot;</span></span><br><span class="line">+ cc kern/init/init.c</span><br><span class="line">gcc -Ikern/init/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/init/init.c -o obj/kern/init/init.o</span><br><span class="line">kern/init/init.c:95:1: warning: ‘lab1_switch_test’ defined but not used [-Wunused-<span class="keyword">function</span>]</span><br><span class="line"> lab1_switch_test(void) &#123;</span><br><span class="line"> ^</span><br><span class="line">+ cc kern/libs/readline.c</span><br><span class="line">gcc -Ikern/libs/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/libs/readline.c -o obj/kern/libs/readline.o</span><br><span class="line">+ cc kern/libs/stdio.c</span><br><span class="line">gcc -Ikern/libs/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/libs/stdio.c -o obj/kern/libs/stdio.o</span><br><span class="line">+ cc kern/debug/kdebug.c</span><br><span class="line">gcc -Ikern/debug/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/debug/kdebug.c -o obj/kern/debug/kdebug.o</span><br><span class="line">kern/debug/kdebug.c:251:1: warning: ‘read_eip’ defined but not used [-Wunused-<span class="keyword">function</span>]</span><br><span class="line"> read_eip(void) &#123;</span><br><span class="line"> ^</span><br><span class="line">+ cc kern/debug/kmonitor.c</span><br><span class="line">gcc -Ikern/debug/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/debug/kmonitor.c -o obj/kern/debug/kmonitor.o</span><br><span class="line">+ cc kern/debug/panic.c</span><br><span class="line">gcc -Ikern/debug/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/debug/panic.c -o obj/kern/debug/panic.o</span><br><span class="line">+ cc kern/driver/clock.c</span><br><span class="line">gcc -Ikern/driver/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/driver/clock.c -o obj/kern/driver/clock.o</span><br><span class="line">+ cc kern/driver/console.c</span><br><span class="line">gcc -Ikern/driver/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/driver/console.c -o obj/kern/driver/console.o</span><br><span class="line">+ cc kern/driver/intr.c</span><br><span class="line">gcc -Ikern/driver/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/driver/intr.c -o obj/kern/driver/intr.o</span><br><span class="line">+ cc kern/driver/picirq.c</span><br><span class="line">gcc -Ikern/driver/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/driver/picirq.c -o obj/kern/driver/picirq.o</span><br><span class="line">+ cc kern/trap/trap.c</span><br><span class="line">gcc -Ikern/trap/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/trap/trap.c -o obj/kern/trap/trap.o</span><br><span class="line">kern/trap/trap.c:14:13: warning: ‘print_ticks’ defined but not used [-Wunused-<span class="keyword">function</span>]</span><br><span class="line"> static void <span class="function"><span class="title">print_ticks</span></span>() &#123;</span><br><span class="line">             ^</span><br><span class="line">kern/trap/trap.c:30:26: warning: ‘idt_pd’ defined but not used [-Wunused-variable]</span><br><span class="line"> static struct pseudodesc idt_pd = &#123;</span><br><span class="line">                          ^</span><br><span class="line">+ cc kern/trap/trapentry.S</span><br><span class="line">gcc -Ikern/trap/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/trap/trapentry.S -o obj/kern/trap/trapentry.o</span><br><span class="line">+ cc kern/trap/vectors.S</span><br><span class="line">gcc -Ikern/trap/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/trap/vectors.S -o obj/kern/trap/vectors.o</span><br><span class="line">+ cc kern/mm/pmm.c</span><br><span class="line">gcc -Ikern/mm/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Ikern/debug/ -Ikern/driver/ -Ikern/trap/ -Ikern/mm/ -c kern/mm/pmm.c -o obj/kern/mm/pmm.o</span><br><span class="line">+ cc libs/printfmt.c</span><br><span class="line">gcc -Ilibs/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/  -c libs/printfmt.c -o obj/libs/printfmt.o</span><br><span class="line">+ cc libs/string.c</span><br><span class="line">gcc -Ilibs/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/  -c libs/string.c -o obj/libs/string.o</span><br><span class="line">+ ld bin/kernel</span><br><span class="line">ld -m    elf_i386 -nostdlib -T tools/kernel.ld -o bin/kernel  obj/kern/init/init.o obj/kern/libs/readline.o obj/kern/libs/stdio.o obj/kern/debug/kdebug.o obj/kern/debug/kmonitor.o obj/kern/debug/panic.o obj/kern/driver/clock.o obj/kern/driver/console.o obj/kern/driver/intr.o obj/kern/driver/picirq.o obj/kern/trap/trap.o obj/kern/trap/trapentry.o obj/kern/trap/vectors.o obj/kern/mm/pmm.o  obj/libs/printfmt.o obj/libs/string.o</span><br><span class="line">+ cc boot/bootasm.S</span><br><span class="line">gcc -Iboot/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Os -nostdinc -c boot/bootasm.S -o obj/boot/bootasm.o</span><br><span class="line">+ cc boot/bootmain.c</span><br><span class="line">gcc -Iboot/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Os -nostdinc -c boot/bootmain.c -o obj/boot/bootmain.o</span><br><span class="line">+ cc tools/sign.c</span><br><span class="line">gcc -Itools/ -g -Wall -O2 -c tools/sign.c -o obj/sign/tools/sign.o</span><br><span class="line">gcc -g -Wall -O2 obj/sign/tools/sign.o -o bin/sign</span><br><span class="line">+ ld bin/bootblock</span><br><span class="line">ld -m    elf_i386 -nostdlib -N -e start -Ttext 0x7C00 obj/boot/bootasm.o obj/boot/bootmain.o -o obj/bootblock.o</span><br><span class="line"><span class="string">&#x27;obj/bootblock.out&#x27;</span> size: 472 bytes</span><br><span class="line">build 512 bytes boot sector: <span class="string">&#x27;bin/bootblock&#x27;</span> success!</span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=bin/ucore.img count=10000</span><br><span class="line">10000+0 records <span class="keyword">in</span></span><br><span class="line">10000+0 records out</span><br><span class="line">5120000 bytes (5.1 MB) copied, 0.0484045 s, 106 MB/s</span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=bin/bootblock of=bin/ucore.img conv=notrunc</span><br><span class="line">1+0 records <span class="keyword">in</span></span><br><span class="line">1+0 records out</span><br><span class="line">512 bytes (512 B) copied, 0.000105295 s, 4.9 MB/s</span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=bin/kernel of=bin/ucore.img seek=1 conv=notrunc</span><br><span class="line">138+1 records <span class="keyword">in</span></span><br><span class="line">138+1 records out</span><br><span class="line">70775 bytes (71 kB) copied, 0.00033329 s, 212 MB/s</span><br><span class="line">[~/moocos/ucore_lab/labcodes/lab1]</span><br><span class="line">moocos-&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>其中我们可以看到一些与gcc有关的命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -c xxxx.c -o xxxx.o</span><br></pre></td></tr></table></figure><p>这个命令的作用是将某个 c 文件经过 预处理(-E)、汇编(-S)、编译(-c) 后，将得到的结果输出到目标文件，即.o后缀的文件。</p><p>还有ld命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ld -o [target]  [<span class="built_in">source</span>]</span><br></pre></td></tr></table></figure><p>将 source 对应的源文件作连接处理，得到最终的文件。</p><p>make记录中对应的目标命令如下，将之前gcc编译出来的，一些以.o后缀的对象文件，作连接处理后，得到最终文件 kernel.ld，存放在tools目录下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ld -m    elf_i386 -nostdlib -T tools/kernel.ld -o bin/kernel  obj/kern/init/init.o obj/kern/libs/readline.o obj/kern/libs/stdio.o obj/kern/debug/kdebug.o obj/kern/debug/kmonitor.o obj/kern/debug/panic.o obj/kern/driver/clock.o obj/kern/driver/console.o obj/kern/driver/intr.o obj/kern/driver/picirq.o obj/kern/trap/trap.o obj/kern/trap/trapentry.o obj/kern/trap/vectors.o obj/kern/mm/pmm.o  obj/libs/printfmt.o obj/libs/string.o</span><br></pre></td></tr></table></figure><p>第二部分的编译和连接过程更短，可以看得更直观。编译得到bootasm.o和bootmain.o，再通过ld命令连接，得到obj目录下的bootblock.o文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+ cc boot/bootasm.S</span><br><span class="line">gcc -Iboot/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Os -nostdinc -c boot/bootasm.S -o obj/boot/bootasm.o</span><br><span class="line">+ cc boot/bootmain.c</span><br><span class="line">gcc -Iboot/ -fno-builtin -Wall -ggdb -m32 -gstabs -nostdinc  -fno-stack-protector -Ilibs/ -Os -nostdinc -c boot/bootmain.c -o obj/boot/bootmain.o</span><br><span class="line">+ cc tools/sign.c</span><br><span class="line">gcc -Itools/ -g -Wall -O2 -c tools/sign.c -o obj/sign/tools/sign.o</span><br><span class="line">gcc -g -Wall -O2 obj/sign/tools/sign.o -o bin/sign</span><br><span class="line">+ ld bin/bootblock</span><br><span class="line">ld -m    elf_i386 -nostdlib -N -e start -Ttext 0x7C00 obj/boot/bootasm.o obj/boot/bootmain.o -o obj/bootblock.o</span><br><span class="line"><span class="string">&#x27;obj/bootblock.out&#x27;</span> size: 472 bytes</span><br></pre></td></tr></table></figure><p><img src="https://pics.kahvia.cn/img/image-20221112141937226.png" alt="bootblock.o"></p><p>最后则是 dd 命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=xxx of=yyy count=number</span><br></pre></td></tr></table></figure><p>类似于拷贝，if 指定输入文件， of 指定输出文件， count 指定拷贝的的块数。</p><p>make过程中对应的代码块如下。conv=notrunc指的是“不截短输出文件”。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=bin/ucore.img count=10000</span><br><span class="line">10000+0 records <span class="keyword">in</span></span><br><span class="line">10000+0 records out</span><br><span class="line">5120000 bytes (5.1 MB) copied, 0.0484045 s, 106 MB/s</span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=bin/bootblock of=bin/ucore.img conv=notrunc</span><br><span class="line">1+0 records <span class="keyword">in</span></span><br><span class="line">1+0 records out</span><br><span class="line">512 bytes (512 B) copied, 0.000105295 s, 4.9 MB/s</span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=bin/kernel of=bin/ucore.img seek=1 conv=notrunc</span><br><span class="line">138+1 records <span class="keyword">in</span></span><br><span class="line">138+1 records out</span><br><span class="line">70775 bytes (71 kB) copied, 0.00033329 s, 212 MB/s</span><br></pre></td></tr></table></figure><p>具体拷贝的流程我结合指令详解也不是很明白。</p><h4 id="结论">结论</h4><p>make生成 ucore.img 大概有三步，分别依赖指令 gcc, ld, dd。</p><p>gcc命令负责编译源文件，ld命令负责连接gcc得到的目标文件，dd命令负责拷贝目标文件到指定的位置。而dd 命令完成后得到的最终文件，就是 ucore.img</p><h3 id="2">2</h3><p>引导扇区的大小为512字节。</p><h2 id="练习2">练习2</h2><blockquote><p>练习2：使用qemu执行并调试lab1中的软件。（要求在报告中简要写出练习过程）<br>为了熟悉使用qemu和gdb进行的调试工作，我们进行如下的小练习：<br>1.从CPU加电后执行的第一条指令开始，单步跟踪BIOS的执行。<br>2.在初始化位置0x7c00设置实地址断点,测试断点正常。<br>3.从0x7c00开始跟踪代码运行,将单步跟踪反汇编得到的代码与bootasm.S和bootblock.asm进行比较。<br>4.自己找一个bootloader或内核中的代码位置，设置断点并进行测试。</p></blockquote><h3 id="1">1</h3><p>在lab1目录下，执行 make -debug，进入调试界面，输入si进行单步跟踪，如下图所示</p><p><img src="https://pics.kahvia.cn/img/image-20221112153930312.png" alt="image-20221112153930312"></p><h3 id="2">2</h3><p>设置实地址断点</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set architecture i8086</span><br><span class="line">target remote :1234</span><br><span class="line">b *0x7c00</span><br><span class="line">c</span><br><span class="line">x/2i $pc</span><br></pre></td></tr></table></figure><p>再次使用make -debug,测试断点正常</p><p><img src="https://pics.kahvia.cn/img/image-20221112154421915.png" alt="image-20221112154421915"></p><h3 id="3">3</h3><p>将makefile 的第218行起的代码，修改为如下代码</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">debug: <span class="variable">$(UCOREIMG)</span></span></span><br><span class="line"><span class="variable">$(V)</span><span class="variable">$(TERMINAL)</span> -e <span class="string">&quot;<span class="variable">$(QEMU)</span> -S -s -d in_asm -D <span class="variable">$(BINDIR)</span>/q.log -parallel stdio -hda <span class="variable">$&lt;</span> -serial null&quot;</span></span><br><span class="line"><span class="variable">$(V)</span>sleep 2</span><br><span class="line"><span class="variable">$(V)</span><span class="variable">$(TERMINAL)</span> -e <span class="string">&quot;gdb -q -tui -x tools/gdbinit&quot;</span></span><br></pre></td></tr></table></figure><p>make -debug 后产生 q.log 文件。通过查找断点地址得如下信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">IN: </span><br><span class="line">0x00007c00:  cli    </span><br><span class="line">0x00007c01:  cld    </span><br><span class="line">0x00007c02:  xor    %ax,%ax</span><br><span class="line">0x00007c04:  mov    %ax,%ds</span><br><span class="line">0x00007c06:  mov    %ax,%es</span><br><span class="line">0x00007c08:  mov    %ax,%ss</span><br></pre></td></tr></table></figure><p>而 bootasm.S 文件中，如此显示。</p><p><img src="https://pics.kahvia.cn/img/image-20221112155556494.png" alt="image-20221112155556494"></p><p>bootblock.asm 文件中如此显示。</p><p><img src="https://pics.kahvia.cn/img/image-20221112155733053.png" alt="image-20221112155733053"></p><p>通过比较得知，各文件中，指令差别不大。</p><h3 id="4">4</h3><p>设置新断点为 0x7c16</p><p>make -debug 如图所示。</p><p><img src="https://pics.kahvia.cn/img/image-20221112160237581.png" alt="image-20221112160237581"></p><p>此时正在执行的指令为 test 和 jne</p><h2 id="练习3">练习3</h2><blockquote><p>练习3：分析bootloader进入保护模式的过程。（要求在报告中写出分析）<br>BIOS将通过读取硬盘主引导扇区到内存，并转跳到对应内存中的位置执行bootloader。请分析bootloader是如何完成从实模式进入保护模式的。</p></blockquote><h3 id="1-开启a20门">1.开启A20门</h3><p>在 bootasm.S 文件中，有这样的代码</p><p><img src="https://pics.kahvia.cn/img/image-20221112162346236.png" alt="image-20221112162346236"></p><p>其中seta20.1是往端口0x64写数据0xd1，告诉CPU我要往8042芯片的P2端口写数据；seta20.2是往端口0x60写数据0xdf，从而将8042芯片的P2端口设置为1. 两段代码都需要先读0x64端口的第2位，确保输入缓冲区为空后再进行后续写操作。</p><h3 id="2-初始化gdt表">2.初始化GDT表</h3><p>同样在这个文件中。</p><p><img src="https://pics.kahvia.cn/img/image-20221112162738325.png" alt="image-20221112162738325"></p><h3 id="3-进入保护模式">3.进入保护模式</h3><p>将cr0寄存器的PE位（cr0寄存器的最低位）设置为1。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movl %cr0, %eax</span><br><span class="line">orl $CR0_PE_ON, %eax</span><br><span class="line">movl %eax, %cr0</span><br></pre></td></tr></table></figure><h2 id="练习4">练习4</h2><blockquote><p>练习4：分析bootloader加载ELF格式的OS的过程。（要求在报告中写出分析）<br>通过阅读bootmain.c，了解bootloader如何加载ELF文件。通过分析源代码和通过qemu来运行并调试bootloader&amp;OS，<br>1.bootloader如何读取硬盘扇区的？<br>2.bootloader是如何加载ELF格式的OS？</p></blockquote><h3 id="1">1</h3><p>在boot目录下的 bootmain.c 文件中，读取扇区的核心代码如下所示。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* readsect - read a single sector at @secno into @dst */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line"><span class="title function_">readsect</span><span class="params">(<span class="type">void</span> *dst, <span class="type">uint32_t</span> secno)</span> &#123;</span><br><span class="line">    <span class="comment">// wait for disk to be ready</span></span><br><span class="line">    waitdisk();</span><br><span class="line"></span><br><span class="line">    outb(<span class="number">0x1F2</span>, <span class="number">1</span>);                         <span class="comment">// count = 1</span></span><br><span class="line">    outb(<span class="number">0x1F3</span>, secno &amp; <span class="number">0xFF</span>);</span><br><span class="line">    outb(<span class="number">0x1F4</span>, (secno &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>);</span><br><span class="line">    outb(<span class="number">0x1F5</span>, (secno &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>);</span><br><span class="line">    outb(<span class="number">0x1F6</span>, ((secno &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xF</span>) | <span class="number">0xE0</span>);</span><br><span class="line">    outb(<span class="number">0x1F7</span>, <span class="number">0x20</span>);                      <span class="comment">// cmd 0x20 - read sectors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// wait for disk to be ready</span></span><br><span class="line">    waitdisk();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// read a sector</span></span><br><span class="line">    insl(<span class="number">0x1F0</span>, dst, SECTSIZE / <span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>等待磁盘就绪</li><li>发出指令</li><li>等待磁盘就绪</li><li>读取扇区</li></ul><h3 id="2">2</h3><p>加载ELF格式的OS的核心代码如下所示</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* bootmain - the entry of bootloader */</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line"><span class="title function_">bootmain</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// read the 1st page off disk</span></span><br><span class="line">    readseg((<span class="type">uintptr_t</span>)ELFHDR, SECTSIZE * <span class="number">8</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// is this a valid ELF?</span></span><br><span class="line">    <span class="keyword">if</span> (ELFHDR-&gt;e_magic != ELF_MAGIC) &#123;</span><br><span class="line">        <span class="keyword">goto</span> bad;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">proghdr</span> *<span class="title">ph</span>, *<span class="title">eph</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// load each program segment (ignores ph flags)</span></span><br><span class="line">    ph = (<span class="keyword">struct</span> proghdr *)((<span class="type">uintptr_t</span>)ELFHDR + ELFHDR-&gt;e_phoff);</span><br><span class="line">    eph = ph + ELFHDR-&gt;e_phnum;</span><br><span class="line">    <span class="keyword">for</span> (; ph &lt; eph; ph ++) &#123;</span><br><span class="line">        readseg(ph-&gt;p_va &amp; <span class="number">0xFFFFFF</span>, ph-&gt;p_memsz, ph-&gt;p_offset);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// call the entry point from the ELF header</span></span><br><span class="line">    <span class="comment">// note: does not return</span></span><br><span class="line">    ((<span class="type">void</span> (*)(<span class="type">void</span>))(ELFHDR-&gt;e_entry &amp; <span class="number">0xFFFFFF</span>))();</span><br><span class="line"></span><br><span class="line">bad:</span><br><span class="line">    outw(<span class="number">0x8A00</span>, <span class="number">0x8A00</span>);</span><br><span class="line">    outw(<span class="number">0x8A00</span>, <span class="number">0x8E00</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* do nothing */</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>从磁盘读取第一页</li><li>判断是否是合法的ELF</li><li>加载每一个扇区</li><li>从ELF头部调用入口函数</li></ul><h2 id="练习5">练习5</h2><blockquote><p>练习5：实现函数调用堆栈跟踪函数 （需要编程）<br>我们需要在lab1中完成kdebug.c中函数print_stackframe的实现，可以通过函数print_stackframe来跟踪函数调用堆栈中记录的返回地址。在如果能够正确实现此函数，可在lab1中执行 “make qemu”后，在qemu模拟器中得到类似如下的输出：<br>…<br>ebp:0x00007b28 eip:0x00100992 args:0x00010094 0x00010094 0x00007b58 0x00100096<br>kern/debug/kdebug.c:305: print_stackframe+22<br>ebp:0x00007b38 eip:0x00100c79 args:0x00000000 0x00000000 0x00000000 0x00007ba8<br>kern/debug/kmonitor.c:125: mon_backtrace+10<br>ebp:0x00007b58 eip:0x00100096 args:0x00000000 0x00007b80 0xffff0000 0x00007b84<br>kern/init/init.c:48: grade_backtrace2+33<br>ebp:0x00007b78 eip:0x001000bf args:0x00000000 0xffff0000 0x00007ba4 0x00000029<br>kern/init/init.c:53: grade_backtrace1+38<br>ebp:0x00007b98 eip:0x001000dd args:0x00000000 0x00100000 0xffff0000 0x0000001d<br>kern/init/init.c:58: grade_backtrace0+23<br>ebp:0x00007bb8 eip:0x00100102 args:0x0010353c 0x00103520 0x00001308 0x00000000<br>kern/init/init.c:63: grade_backtrace+34<br>ebp:0x00007be8 eip:0x00100059 args:0x00000000 0x00000000 0x00000000 0x00007c53<br>kern/init/init.c:28: kern_init+88<br>ebp:0x00007bf8 eip:0x00007d73 args:0xc031fcfa 0xc08ed88e 0x64e4d08e 0xfa7502a8<br><unknow>: – 0x00007d72 –<br>…<br>请完成实验，看看输出是否与上述显示大致一致，并解释最后一行各个数值的含义。</p></blockquote><p>实现函数如下所示。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">print_stackframe(<span class="type">void</span>) &#123;</span><br><span class="line">    <span class="type">uint32_t</span> *ebp = (<span class="type">uint32_t</span> *)read_ebp();</span><br><span class="line">    <span class="type">uint32_t</span> eip = read_eip();</span><br><span class="line">    <span class="keyword">while</span> (ebp)</span><br><span class="line">    &#123;</span><br><span class="line">        cprintf(<span class="string">&quot;ebp:0x%08x eip:0x%08x args:&quot;</span>, (<span class="type">uint32_t</span>)ebp, eip);</span><br><span class="line">        cprintf(<span class="string">&quot;0x%08x 0x%08x 0x%08x 0x%08x\n&quot;</span>, ebp[<span class="number">2</span>], ebp[<span class="number">3</span>], ebp[<span class="number">4</span>], ebp[<span class="number">5</span>]);</span><br><span class="line">        print_debuginfo(eip - <span class="number">1</span>);</span><br><span class="line">        eip = ebp[<span class="number">1</span>];</span><br><span class="line">        ebp = (<span class="type">uint32_t</span> *)*ebp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>执行make qemu，结果如下所示</p><p><img src="https://pics.kahvia.cn/img/image-20221112164802166.png" alt="image-20221112164802166"></p><ul><li>ebp：ebp的值是kern_init函数的栈顶地址。</li><li>eip：eip的值是kern_init函数的返回地址，也就是bootmain函数调用kern_init对应的指令的下一条指令的地址。</li><li>args：存放的是boot loader指令的前16个字节。</li></ul><h2 id="练习6">练习6</h2><blockquote><p>练习6：完善中断初始化和处理 （需要编程）<br>请完成编码工作和回答如下问题：<br>1.中断描述符表（也可简称为保护模式下的中断向量表）中一个表项占多少字节？其中哪几位代表中断处理代码的入口？<br>2.请编程完善kern/trap/trap.c中对中断向量表进行初始化的函数idt_init。在idt_init函数中，依次对所有中断入口进行初始化。使用mmu.h中的SETGATE宏，填充idt数组内容。每个中断的入口由tools/vectors.c生成，使用trap.c中声明的vectors数组即可。<br>3.请编程完善trap.c中的中断处理函数trap，在对时钟中断进行处理的部分填写trap函数中处理时钟中断的部分，使操作系统每遇到100次时钟中断后，调用print_ticks子程序，向屏幕上打印一行文字”100 ticks”。</p></blockquote><h4 id="1">1</h4><p>中断描述符表一个表项占8个字节，其中2-3字节是段选择子，0-1字节和6-7字节拼成偏移量，即第16~ 32位是段选择子，第0~ 15、48~63位构成的偏移地址，通过段选择子去GDT中找到对应的基地址，然后基地址加上偏移量就是中断处理程序的地址。</p><h3 id="2">2</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">idt_init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">     <span class="comment">/* LAB1 YOUR CODE : STEP 2 */</span></span><br><span class="line">     <span class="comment">/* (1) Where are the entry addrs of each Interrupt Service Routine (ISR)?</span></span><br><span class="line"><span class="comment">      *     All ISR&#x27;s entry addrs are stored in __vectors. where is uintptr_t __vectors[] ?</span></span><br><span class="line"><span class="comment">      *     __vectors[] is in kern/trap/vector.S which is produced by tools/vector.c</span></span><br><span class="line"><span class="comment">      *     (try &quot;make&quot; command in lab1, then you will find vector.S in kern/trap DIR)</span></span><br><span class="line"><span class="comment">      *     You can use  &quot;extern uintptr_t __vectors[];&quot; to define this extern variable which will be used later.</span></span><br><span class="line"><span class="comment">      * (2) Now you should setup the entries of ISR in Interrupt Description Table (IDT).</span></span><br><span class="line"><span class="comment">      *     Can you see idt[256] in this file? Yes, it&#x27;s IDT! you can use SETGATE macro to setup each item of IDT</span></span><br><span class="line"><span class="comment">      * (3) After setup the contents of IDT, you will let CPU know where is the IDT by using &#x27;lidt&#x27; instruction.</span></span><br><span class="line"><span class="comment">      *     You don&#x27;t know the meaning of this instruction? just google it! and check the libs/x86.h to know more.</span></span><br><span class="line"><span class="comment">      *     Notice: the argument of lidt is idt_pd. try to find it!</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    <span class="keyword">extern</span> <span class="type">uintptr_t</span> __vectors[];</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(idt) / <span class="keyword">sizeof</span>(<span class="keyword">struct</span> gatedesc); i ++) &#123;</span><br><span class="line">        SETGATE(idt[i], <span class="number">0</span>, GD_KTEXT, __vectors[i], DPL_KERNEL);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// set for switch from user to kernel</span></span><br><span class="line">    SETGATE(idt[T_SWITCH_TOK], <span class="number">0</span>, GD_KTEXT, __vectors[T_SWITCH_TOK], DPL_USER);</span><br><span class="line"><span class="comment">// load the IDT</span></span><br><span class="line">    lidt(&amp;idt_pd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3">3</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> IRQ_OFFSET + IRQ_TIMER:</span><br><span class="line">        <span class="comment">/* LAB1 YOUR CODE : STEP 3 */</span></span><br><span class="line">        <span class="comment">/* handle the timer interrupt */</span></span><br><span class="line">        <span class="comment">/* (1) After a timer interrupt, you should record this event using a global variable (increase it), such as ticks in kern/driver/clock.c</span></span><br><span class="line"><span class="comment">         * (2) Every TICK_NUM cycle, you can print some info using a funciton, such as print_ticks().</span></span><br><span class="line"><span class="comment">         * (3) Too Simple? Yes, I think so!</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        ticks ++;</span><br><span class="line">        <span class="keyword">if</span> (ticks % TICK_NUM == <span class="number">0</span>) &#123;</span><br><span class="line">            print_ticks();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>运行结果如下所示。</p><p><img src="https://pics.kahvia.cn/img/image-20221112170446171.png" alt="image-20221112170446171"></p>]]></content>
      
      
      <categories>
          
          <category> 课程实验 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android-HttpRequest</title>
      <link href="/2022/10/31/AndroidHttpRequest.html"/>
      <url>/2022/10/31/AndroidHttpRequest.html</url>
      
        <content type="html"><![CDATA[<h3 id="post">POST</h3><p>据度娘解释，以前的安卓应用发出 http 请求后，如果请求时间过长，就会产生应用无响应的状态。所以改成了现在这种，直接发出 http 请求就会抛出错误。想要正确地发出http请求，就需要开一个子线程来进行这些操作。</p><p>下方的代码采用的是，直接通过 Thread 类创建子线程，需要传递的参数是一个实现了 Runnable 接口的类的实例对象。这里的对象通过匿名类生成。线程和匿名类的知识，可以在《Java2 实用教程》（俗称 课本）中找到。</p><p>线程的启动使用 start（）方法。启动后，就进入等待cpu使用权的队列。得到使用权就开始运行。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpUtil</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">requestPost</span><span class="params">()</span> <span class="keyword">throws</span> IOException, JSONException &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">               <span class="keyword">try</span> &#123;</span><br><span class="line">                   <span class="comment">//创建URL对象</span></span><br><span class="line">                   URL url=<span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://www.xxx.com/user/check&quot;</span>);</span><br><span class="line">                   <span class="comment">//获取连接</span></span><br><span class="line">                   HttpURLConnection connection= (HttpURLConnection) url.openConnection();</span><br><span class="line">                   <span class="comment">//设定请求方式</span></span><br><span class="line">                   connection.setRequestMethod(<span class="string">&quot;POST&quot;</span>);</span><br><span class="line">                   <span class="comment">//设置内容类型，这里是json数据</span></span><br><span class="line">                   connection.setRequestProperty(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json;charset=UTF-8&quot;</span>);</span><br><span class="line">                   <span class="comment">//期望接收到的请求返回值</span></span><br><span class="line">                   connection.setRequestProperty(<span class="string">&quot;Accept&quot;</span>,<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">                   <span class="comment">//允许通过连接向外输出，即发送数据到服务器</span></span><br><span class="line">                   connection.setDoOutput(<span class="literal">true</span>);</span><br><span class="line">                   <span class="comment">//允许通过连接向内输出，即安卓应用收到数据</span></span><br><span class="line">                   connection.setDoInput(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">                   <span class="comment">//创建实体对象</span></span><br><span class="line">                   User user=<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;914302063&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">                   <span class="comment">//转换为JSONObject对象。user.toString()的toString方法是额外实现的。</span></span><br><span class="line">                   JSONObject jsonObject=<span class="keyword">new</span> <span class="title class_">JSONObject</span>(user.toString());</span><br><span class="line">                   <span class="comment">//转字符串，也就是这个字符串就是俗称的json字符串，是目标数据。</span></span><br><span class="line">                   String json=jsonObject.toString();</span><br><span class="line">                   Log.i(<span class="string">&quot;JsonData&quot;</span>,json);</span><br><span class="line"></span><br><span class="line">                   <span class="comment">//通过连接获取输出流</span></span><br><span class="line">                   OutputStream outputStream=connection.getOutputStream();</span><br><span class="line">                   <span class="comment">//把json字符串转换成字符数组，通过输出流输出</span></span><br><span class="line">                   outputStream.write(json.getBytes());</span><br><span class="line">                   <span class="comment">//outputStream输出流缓存区满了会自动调用flush（），输出流关闭前也会调用。所以这里写不写flush都可。</span></span><br><span class="line">                   outputStream.flush();</span><br><span class="line">                   outputStream.close();</span><br><span class="line">                   Log.i(<span class="string">&quot;responseCode&quot;</span>, String.valueOf(connection.getResponseCode()));</span><br><span class="line"></span><br><span class="line">                   <span class="comment">//通过连接获得输入流</span></span><br><span class="line">                   InputStream inputStream=connection.getInputStream();</span><br><span class="line">                   String result=<span class="string">&quot;&quot;</span>;</span><br><span class="line">                   StringBuilder stringBuilder=<span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                   InputStreamReader inputStreamReader=<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(inputStream);</span><br><span class="line">                   BufferedReader bufferedReader=<span class="keyword">new</span> <span class="title class_">BufferedReader</span>(inputStreamReader);</span><br><span class="line">                   <span class="keyword">while</span>((result=bufferedReader.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">                       stringBuilder.append(result);</span><br><span class="line">                   &#125;</span><br><span class="line">                   Log.i(<span class="string">&quot;resultData&quot;</span>, String.valueOf(stringBuilder));</span><br><span class="line">               &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                   System.out.println(e);</span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    String username;</span><br><span class="line">    String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;<span class="comment">//这个方法在转换对象为JSONObject的时候会用到</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, password=&#x27;&quot;</span> + password + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pics.kahvia.cn/img/image-20221031190721290.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-ListWheelScrollView</title>
      <link href="/2022/10/29/FlutterListWheelScrollView.html"/>
      <url>/2022/10/29/FlutterListWheelScrollView.html</url>
      
        <content type="html"><![CDATA[<h3 id="listwheelscrollview">ListWheelScrollView</h3><p>和 ListView 类似，但是正如它的名字，它像个轮子，显示的时候有弧度。</p><p>这是官方的组件，并不需要引入第三方依赖包。</p><h3 id="使用">使用</h3><p>它就像一个横放的圆柱，你只能看到前面这个面。能看到多少东西，取决于它的大小和你离它的位置。</p><p>可以使用 diameterRatio 改变它的圆面直径。你站在一个地方看圆柱，圆柱越大，你看那个面越不像弧面，能看到的东西就越多。就好像本来弯曲的书本，你让它不那么弯曲后，看到的就更多了吧。</p><p>可以使用 perspective 来决定你的透视位置。你离它越远，看到的东西越多。就像一张弯曲的纸上写着很多字，你贴近了看，只能看到几个字，拿远了看，就看得见一些弯曲后的字，总体上来说能看清的字变多了。</p><p>前者是在视野不变的情况下，让圆柱可视面能显示更多的东西。后者是让圆柱面显示的东西不变的情况下，自己去获得更大的视野，企图去看到更多东西。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Checker</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Checker(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">//层叠布局，用一个阴影来标注当前选项</span></span><br><span class="line">    <span class="keyword">return</span> Stack(</span><br><span class="line">      children: [</span><br><span class="line">        Center(</span><br><span class="line">          child: Row(</span><br><span class="line">            mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">            children: [</span><br><span class="line">              SizedBox(</span><br><span class="line">                width: <span class="number">100</span>,</span><br><span class="line">                child:ListWheelScrollView.useDelegate(</span><br><span class="line">                  <span class="comment">//固定距离滚动，这样可以刚好停留在一个选项上</span></span><br><span class="line">                    physics: <span class="keyword">const</span> FixedExtentScrollPhysics(),</span><br><span class="line">                    <span class="comment">//透视程度。0代表从无限远的地方观察圆柱，而1代表从无限近的地方观察，近到无法渲染</span></span><br><span class="line">                    <span class="comment">//可选择的范围是(0,0.01]，隔得越远，弧线角度变化越不明显，看到的范围也就越大</span></span><br><span class="line">                    perspective: <span class="number">0.005</span>,</span><br><span class="line">                    <span class="comment">//直径比，默认为2。可以代表这个圆柱截面圆的直径。</span></span><br><span class="line">                    <span class="comment">//在某个固定的地方观察圆柱，圆柱截面直径越大，角度变化越不明显。列表看起来越像直线，看的范围反而好像变大了。</span></span><br><span class="line">                    diameterRatio: <span class="number">1.2</span>,</span><br><span class="line">                    <span class="comment">//每个选项的高度</span></span><br><span class="line">                    itemExtent: <span class="number">50</span>,</span><br><span class="line">                    <span class="comment">//子选项构造器</span></span><br><span class="line">                    childDelegate: ListWheelChildBuilderDelegate(</span><br><span class="line">                        childCount: <span class="number">13</span>,</span><br><span class="line">                        builder: (context,index)=&gt;Hour(hour: index,)</span><br><span class="line">                    )</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              SizedBox(</span><br><span class="line">                width: <span class="number">100</span>,</span><br><span class="line">                child: ListWheelScrollView.useDelegate(</span><br><span class="line">                    physics: <span class="keyword">const</span> FixedExtentScrollPhysics(),</span><br><span class="line">                    perspective: <span class="number">0.005</span>,</span><br><span class="line">                    diameterRatio: <span class="number">1.2</span>,</span><br><span class="line">                    itemExtent: <span class="number">50</span>,</span><br><span class="line">                    childDelegate: ListWheelChildBuilderDelegate(</span><br><span class="line">                        childCount: <span class="number">60</span>,</span><br><span class="line">                        builder: (context,index)=&gt;Minute(minute: index)</span><br><span class="line">                    )</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              SizedBox(</span><br><span class="line">                width: <span class="number">100</span>,</span><br><span class="line">                child: ListWheelScrollView.useDelegate(</span><br><span class="line">                    physics: <span class="keyword">const</span> FixedExtentScrollPhysics(),</span><br><span class="line">                    perspective: <span class="number">0.005</span>,</span><br><span class="line">                    diameterRatio: <span class="number">1.2</span>,</span><br><span class="line">                    itemExtent: <span class="number">50</span>,</span><br><span class="line">                    childDelegate: ListWheelChildBuilderDelegate(</span><br><span class="line">                        childCount: <span class="number">2</span>,</span><br><span class="line">                        builder: (context,index)&#123;</span><br><span class="line">                          <span class="keyword">return</span> AmPm(am: index==<span class="number">0</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    )</span><br><span class="line">                ),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        Center(</span><br><span class="line">          child: Container(</span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">              color: <span class="keyword">const</span> Color.fromRGBO(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>),</span><br><span class="line">              borderRadius: BorderRadius.circular(<span class="number">24</span>)</span><br><span class="line">            ),</span><br><span class="line">            height: <span class="number">50</span>,</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="效果">效果</h3><p><img src="https://pics.kahvia.cn/img/image-20221029143240083.png" alt="image-20221029143240083"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-SmoothPageIndicator-Lottie</title>
      <link href="/2022/10/27/FlutterSmoothPageIndicator.html"/>
      <url>/2022/10/27/FlutterSmoothPageIndicator.html</url>
      
        <content type="html"><![CDATA[<h3 id="smoothpageindicator">SmoothPageIndicator</h3><p>平滑的页面指示器。我称它为点集。效果与 dots indicator 类似，但样式更多样。</p><h4 id="依赖引入">依赖引入</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">smooth_page_indicator:</span> <span class="string">^1.0.0+2</span></span><br></pre></td></tr></table></figure><h4 id="使用">使用</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SmoothPageIndicator(</span><br><span class="line">  <span class="comment">//this controller is PageController,which is usually used in PageView to controlle the page changing</span></span><br><span class="line">  controller: _controller,</span><br><span class="line">  count: <span class="number">3</span>,</span><br><span class="line">  onDotClicked: (index)&#123;</span><br><span class="line">    _controller.jumpToPage(index);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//是特效！我加了特效！</span></span><br><span class="line">  <span class="comment">//ExpandingDotsEffect,ColorTransitionEffect,JumpingDotEffect...</span></span><br><span class="line">  effect: SwapEffect(</span><br><span class="line">    activeDotColor: Colors.deepPurple,</span><br><span class="line">    dotColor: Colors.deepPurple.shade200</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="lottie">Lottie</h3><p>一个可以渲染动态特效的工具。常用于渲染 AE 导出的 json 格式的特效。</p><p>可配合<a href="https://lottiefiles.com/">LottieFiles</a>使用。</p><h4 id="依赖引入">依赖引入</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lottie:</span> <span class="string">^1.4.3</span> <span class="comment"># A library for animations</span></span><br></pre></td></tr></table></figure><h4 id="使用">使用</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Lottie.asset(<span class="string">&quot;assets/lotties/wifi-high-speed-internet.json&quot;</span>) <span class="comment">//通过预设资源使用</span></span><br><span class="line">Lottie.network(<span class="string">&quot;https://assets5.lottiefiles.com/packages/lf20_mdxpRNhzMQ.json&quot;</span>) <span class="comment">//通过网络资源使用</span></span><br></pre></td></tr></table></figure><h3 id="两者结合">两者结合</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntroductionScreensPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">//the page controller is essential</span></span><br><span class="line">  <span class="keyword">final</span> PageController _controller=PageController();</span><br><span class="line"></span><br><span class="line">  IntroductionScreensPage(&#123;<span class="keyword">super</span>.key&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">//only using the stack layout can make the dots bar shown correctly on the screen</span></span><br><span class="line">    <span class="comment">//因为用column会超出屏幕，然后报错</span></span><br><span class="line">    <span class="keyword">return</span> Stack(</span><br><span class="line">      alignment: <span class="keyword">const</span> AlignmentDirectional(<span class="number">0</span>, <span class="number">0.75</span>),</span><br><span class="line">      children: [</span><br><span class="line">        PageView(</span><br><span class="line">          controller: _controller,</span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            IntroductionPage1(),</span><br><span class="line">            IntroductionPage2(),</span><br><span class="line">            IntroductionPage3()</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        SmoothPageIndicator(</span><br><span class="line">          controller: _controller,</span><br><span class="line">          count: <span class="number">3</span>,</span><br><span class="line">          onDotClicked: (index)&#123;</span><br><span class="line">            _controller.jumpToPage(index);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">//是特效！我加了特效！</span></span><br><span class="line">          <span class="comment">//ExpandingDotsEffect,ColorTransitionEffect,JumpingDotEffect...</span></span><br><span class="line">          effect: SwapEffect(</span><br><span class="line">            activeDotColor: Colors.deepPurple,</span><br><span class="line">            dotColor: Colors.deepPurple.shade200</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntroductionPage1</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> IntroductionPage1(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: Container(</span><br><span class="line">        color: Colors.deepPurple.shade300,</span><br><span class="line">        child: Column(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">          children: [</span><br><span class="line">            <span class="keyword">const</span> SizedBox(height: <span class="number">30</span>,),</span><br><span class="line">            <span class="keyword">const</span> Text(</span><br><span class="line">              <span class="string">&quot;It&#x27;s Achat&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                fontFamily: <span class="string">&quot;Bebas_Neue&quot;</span>,</span><br><span class="line">                fontSize: <span class="number">70</span>,</span><br><span class="line">                color: Colors.white</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            Lottie.asset(<span class="string">&quot;assets/lotties/talk-show2.json&quot;</span>),</span><br><span class="line">            <span class="keyword">const</span> SizedBox(height: <span class="number">70</span>,),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="效果图">效果图</h3><p><img src="https://pics.kahvia.cn/img/image-20221027134752117.png" alt="image-20221027134752117"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-PercentIndicator</title>
      <link href="/2022/10/26/FlutterPercentIndicator.html"/>
      <url>/2022/10/26/FlutterPercentIndicator.html</url>
      
        <content type="html"><![CDATA[<h3 id="percentindicator">PercentIndicator</h3><p>这是一个百分比指示器的组件，俗称进度条。是第三方组件，用以弥补官方的 CircularProgressIndicator 的不足。我曾想用官方的进度条组件包裹一个圆框，用以展示头像上传进度，然而官方的组件并不支持在圆环中间插入子组件，所以自己做的话，或许要用层叠布局，颇感麻烦。</p><p>但是今天偶然遇见这个第三方组件就解决了这个问题。</p><h3 id="依赖引入">依赖引入</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">percent_indicator:</span> <span class="string">^4.0.1</span></span><br></pre></td></tr></table></figure><h3 id="使用">使用</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProgressBarPageContent</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ProgressBarPageContent(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;ProgressBarPageContent&gt; createState() =&gt; _ProgressBarPageContentState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_ProgressBarPageContentState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">ProgressBarPageContent</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">double</span> progress=<span class="number">0</span>;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Center(</span><br><span class="line">      child: Column(</span><br><span class="line">        mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">        children: [</span><br><span class="line">          CircularPercentIndicator(</span><br><span class="line">            <span class="comment">//开启过渡动画</span></span><br><span class="line">            animation: <span class="keyword">true</span>,</span><br><span class="line">            <span class="comment">//动画起点从上一次动画终点开始。默认从0开始。</span></span><br><span class="line">            animateFromLastPercent: <span class="keyword">true</span>,</span><br><span class="line">            <span class="comment">//圆环底色</span></span><br><span class="line">            backgroundColor: Colors.red[<span class="number">200</span>]!,</span><br><span class="line">            <span class="comment">//外圆半径</span></span><br><span class="line">            radius: <span class="number">150</span>,</span><br><span class="line">            <span class="comment">//圆环宽度</span></span><br><span class="line">            lineWidth: <span class="number">10</span>,</span><br><span class="line">            <span class="comment">//圆环线帽设置，也就是进度条的尾部，多出一部分用作线帽，线帽的形状</span></span><br><span class="line">            circularStrokeCap: CircularStrokeCap.round,</span><br><span class="line">            <span class="comment">//这里圆环中间可放置任意元素。</span></span><br><span class="line">            center: <span class="keyword">const</span> CircleAvatar(</span><br><span class="line">              backgroundImage: AssetImage(<span class="string">&quot;images/head/nilu.png&quot;</span>),</span><br><span class="line">              radius: <span class="number">140</span>,</span><br><span class="line">            ),</span><br><span class="line">            <span class="comment">//percent为进度</span></span><br><span class="line">            percent: progress</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">const</span> SizedBox(height: <span class="number">10</span>,),</span><br><span class="line">          ElevatedButton(</span><br><span class="line">            style: ButtonStyle(</span><br><span class="line">              backgroundColor: MaterialStateProperty.all(Colors.redAccent)</span><br><span class="line">            ),</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              setState(() &#123;</span><br><span class="line">                <span class="keyword">if</span>(progress==<span class="number">1</span>) &#123;</span><br><span class="line">                  progress=<span class="number">0</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  progress=<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            child: <span class="keyword">const</span> Text(<span class="string">&quot;Show Progress&quot;</span>)</span><br><span class="line">          )</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="效果展示">效果展示</h3><p><img src="https://pics.kahvia.cn/img/image-20221026192953616.png" alt="image-20221026192953616"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Slidable</title>
      <link href="/2022/10/23/FlutterSlidable.html"/>
      <url>/2022/10/23/FlutterSlidable.html</url>
      
        <content type="html"><![CDATA[<h3 id="slidable">Slidable</h3><p>滑动选项卡组件。</p><h3 id="依赖引入">依赖引入</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter_slidable: ^<span class="number">2.0</span><span class="number">.0</span></span><br></pre></td></tr></table></figure><h3 id="使用">使用</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Slidable(<span class="comment">//可滑动的组件</span></span><br><span class="line">  <span class="comment">//end代表从右边往左边滑动</span></span><br><span class="line">  endActionPane: ActionPane(<span class="comment">//滑动选项面板</span></span><br><span class="line">    motion: <span class="keyword">const</span> StretchMotion(),<span class="comment">//滑动动画</span></span><br><span class="line">    children: [</span><br><span class="line">      <span class="comment">//SlidableAction是单个滑动选项</span></span><br><span class="line">      SlidableAction(</span><br><span class="line">        onPressed: onDelete,<span class="comment">//触发删除的函数</span></span><br><span class="line">        icon: Icons.delete,<span class="comment">//图标</span></span><br><span class="line">        backgroundColor: Colors.redAccent,<span class="comment">//背景色</span></span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">12</span>),<span class="comment">//圆角</span></span><br><span class="line">      )</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">  child: Container(</span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">24</span>),</span><br><span class="line">    <span class="comment">// height: 60,</span></span><br><span class="line">    decoration:  BoxDecoration(</span><br><span class="line">        color: Colors.orange,</span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">12</span>)</span><br><span class="line">    ),</span><br><span class="line">    child: Row(</span><br><span class="line">      children: [</span><br><span class="line">        Checkbox(</span><br><span class="line">          value: finished,</span><br><span class="line">          onChanged: onChanged,</span><br><span class="line">          activeColor: Colors.black,</span><br><span class="line">        ),</span><br><span class="line">        Text(</span><br><span class="line">          taskName,</span><br><span class="line">          style: TextStyle(decoration: finished?TextDecoration.lineThrough:TextDecoration.none),</span><br><span class="line">          overflow: TextOverflow.ellipsis,</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>Navigator.of(context).pop();<a href="//xn--Navigator-9z0tv106a.pop">//这样Navigator.pop</a>(context);//或这样dart</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-CircularProgressIndicator</title>
      <link href="/2022/10/20/FlutterCircularProgressIndicator.html"/>
      <url>/2022/10/20/FlutterCircularProgressIndicator.html</url>
      
        <content type="html"><![CDATA[<h3 id="circularprogressindicator">CircularProgressIndicator</h3><p>圆形的进度指示。可以用于等待加载的时候。</p><h3 id="使用">使用</h3><p>常配合 showDialog( ) 使用。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">showDialog(</span><br><span class="line">    context: context,</span><br><span class="line">    builder: (context)&#123;</span><br><span class="line">      <span class="keyword">return</span> Center(</span><br><span class="line">        child: CircularProgressIndicator(color: MyColors.rgbRed,),</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>用完以后用 Navigator 回退页面就行了。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Navigator.of(context).pop();<span class="comment">//这样</span></span><br><span class="line">Navigator.pop(context);<span class="comment">//或这样</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-ImagePicker-ImageCropper</title>
      <link href="/2022/10/20/FlutterImagePickerAndCropper.html"/>
      <url>/2022/10/20/FlutterImagePickerAndCropper.html</url>
      
        <content type="html"><![CDATA[<h3 id="imagepicker">ImagePicker</h3><p>Flutter用于选择图片的工具包。</p><h4 id="依赖引入">依赖引入</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image_picker:</span> <span class="string">^0.8.6</span></span><br></pre></td></tr></table></figure><h4 id="使用">使用</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> ImagePicker _picker=ImagePicker();<span class="comment">//创建选择器实例</span></span><br><span class="line">onPressed: ()<span class="keyword">async</span>&#123;</span><br><span class="line">        <span class="comment">//从相册选择图片</span></span><br><span class="line">        <span class="keyword">final</span> image=<span class="keyword">await</span> _picker.pickImage(source: ImageSource.gallery);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h3 id="imagecropper">ImageCropper</h3><p>用于图片裁剪的工具包</p><h4 id="依赖引入">依赖引入</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image_cropper:</span> <span class="string">^3.0.0</span></span><br></pre></td></tr></table></figure><h4 id="相关配置-安卓需要配置-ios不需要">相关配置(安卓需要配置，ios不需要)</h4><p>在AndroidManifest.xml加入以下信息。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.yalantis.ucrop.UCropActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:screenOrientation</span>=<span class="string">&quot;portrait&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.AppCompat.Light.NoActionBar&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="使用">使用</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CroppedFile? croppedImage=<span class="keyword">await</span> ImageCropper().cropImage(sourcePath: image.path);<span class="comment">//创建裁剪器给定图片源进行裁剪</span></span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="两者结合">两者结合</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="comment">//创建图片选择器实例</span></span><br><span class="line">  <span class="keyword">final</span> ImagePicker _picker=ImagePicker();</span><br><span class="line">  <span class="keyword">return</span> ElevatedButton(</span><br><span class="line">    <span class="comment">//单击按钮触发选择</span></span><br><span class="line">    onPressed: ()<span class="keyword">async</span>&#123;</span><br><span class="line">      <span class="comment">//从相册选择图片</span></span><br><span class="line">      <span class="keyword">final</span> image=<span class="keyword">await</span> _picker.pickImage(source: ImageSource.gallery); <span class="comment">//返回的是XFile对象</span></span><br><span class="line">      <span class="comment">//选择了图片则创建裁剪器实例进入裁剪环节</span></span><br><span class="line">      <span class="keyword">if</span>(image!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        CroppedFile? croppedImage=<span class="keyword">await</span> ImageCropper().cropImage(sourcePath: image.path);<span class="comment">//根据XFile对象的路径获得图片进行裁剪</span></span><br><span class="line">        <span class="comment">//裁剪了则把裁剪后的图片设置为预览的文件源</span></span><br><span class="line">        <span class="keyword">if</span>(croppedImage!=<span class="keyword">null</span>)&#123;</span><br><span class="line">          context.read&lt;ImageData&gt;().setImage(File(croppedImage.path));<span class="comment">//CroppedFile转File，上传图片的时候根据File转MultipartFile即可</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//未裁剪则设置裁剪之前选择的图片作为预览的文件源</span></span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">          context.read&lt;ImageData&gt;().setImage(File(image.path));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    style: ButtonStyle(</span><br><span class="line">        shape: MaterialStateProperty.all(<span class="keyword">const</span> RoundedRectangleBorder(</span><br><span class="line">            borderRadius: BorderRadius.all(Radius.circular(<span class="number">30</span>))</span><br><span class="line">        )),</span><br><span class="line">        <span class="comment">//设置按钮宽度高度等</span></span><br><span class="line">        minimumSize: MaterialStateProperty.all(<span class="keyword">const</span> Size(<span class="number">300</span>, <span class="number">40</span>)),</span><br><span class="line">        backgroundColor: MaterialStateProperty.all(MyColors.rgbRed)</span><br><span class="line">    ),</span><br><span class="line">    child: <span class="keyword">const</span> Text(<span class="string">&quot;Select a photo from gallery&quot;</span>),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="图片上传">图片上传</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//图片选择或裁剪完毕后，单击完成上传</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FinishedButton</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> FinishedButton(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">//创建dio实例，用于发送http请求</span></span><br><span class="line">    <span class="keyword">final</span> dio=Dio();</span><br><span class="line">    <span class="comment">//获取已经准备好的图片文件源</span></span><br><span class="line">    File? image=context.watch&lt;ImageData&gt;().image;</span><br><span class="line">    <span class="keyword">return</span> ElevatedButton(</span><br><span class="line">      onPressed: image==null?<span class="comment">//没有文件源代表没有选图片，不进行上传操作</span></span><br><span class="line">      ()&#123;&#125;:<span class="comment">//有文件源就进入上传阶段</span></span><br><span class="line">      ()<span class="keyword">async</span>&#123;</span><br><span class="line">        <span class="keyword">final</span> multipartImg=<span class="keyword">await</span> MultipartFile.fromFile(image.path);<span class="comment">//根据文件源生成媒体图片</span></span><br><span class="line">        <span class="keyword">final</span> map=&lt;<span class="built_in">String</span>,<span class="built_in">dynamic</span>&gt;&#123;&#125;;<span class="comment">//创建map存储图片</span></span><br><span class="line">        map[<span class="string">&#x27;file&#x27;</span>]=<span class="keyword">await</span> MultipartFile.fromFile(image.path);</span><br><span class="line">        <span class="comment">//将map转为表单数据后，发送post请求，上传服务器，并接收返回的数据</span></span><br><span class="line">        <span class="keyword">var</span> response=<span class="keyword">await</span> dio.post(<span class="string">&quot;<span class="subst">$serviceUploadHeader</span>/<span class="subst">$&#123;context.read&lt;UserMsg&gt;().userId&#125;</span>&quot;</span>,data: FormData.fromMap(map));</span><br><span class="line">        context.read&lt;UserMsg&gt;().setHeadImg(response.data);<span class="comment">//及时更新头像的链接</span></span><br><span class="line">        Navigator.pop(context);<span class="comment">//上传完毕即退回首页</span></span><br><span class="line">      &#125;,</span><br><span class="line">      style: ButtonStyle(</span><br><span class="line">          backgroundColor: image==null?</span><br><span class="line">          MaterialStateProperty.all(Colors.grey):</span><br><span class="line">          MaterialStateProperty.all(MyColors.rgbRed)</span><br><span class="line">      ),</span><br><span class="line">      child:  <span class="keyword">const</span> Text(<span class="string">&quot;Finished&quot;</span>,),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MicroService-Nacos</title>
      <link href="/2022/10/16/MicroserviceNacos.html"/>
      <url>/2022/10/16/MicroserviceNacos.html</url>
      
        <content type="html"><![CDATA[<h3 id="nacos">Nacos</h3><p>用于替代已经停止维护的 Eureka 。</p><h3 id="服务端">服务端</h3><p>在<a href="https://github.com/alibaba/nacos">AlibabaNacos</a>的里程碑中选择版本进行下载。</p><p>下载解压后，在 bin 目录下打开终端，输入指令启动。Windows 运行cmd文件，Linux运行sh文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./startup.cmd -m standalone</span><br></pre></td></tr></table></figure><p>默认服务端口为8848，可在 conf 目录下配置文件 application.properties 中更改。</p><span id="more"></span><h3 id="客户端">客户端</h3><p>在父工程的pom文件中添加依赖管理。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.SR9<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            包含nacos的项目依赖管理--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在子工程（各微服务对应的spring boot项目）pom文件中添加 nacos 依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在子工程配置文件yml中配置服务端地址</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">UserService</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">39940</span></span><br></pre></td></tr></table></figure><h3 id="服务多级存储模型">服务多级存储模型</h3><p>微服务分集群部署。分集群部署，服务不容易同时挂掉。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://www.kahvia.cn:3306/Blogs?serverTimezone=GMT%2B8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">xxxxxx</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">UserService</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">      <span class="attr">discovery:</span> </span><br><span class="line">        <span class="attr">cluster-name:</span> <span class="string">YC</span> <span class="comment">#集群名称，常按地名划分，YC为宜昌</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">39940</span></span><br></pre></td></tr></table></figure><h3 id="负载均衡">负载均衡</h3><p>局部策略（在某个微服务中调用指定微服务的负载均衡策略）</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">UserService:</span> <span class="comment">#为某个微服务配置负载均衡的规则</span></span><br><span class="line">  <span class="attr">ribbon:</span></span><br><span class="line">    <span class="attr">NFLoadBalancerRuleClassName:</span> <span class="string">com.alibaba.cloud.nacos.ribbon.NacosRule</span> <span class="comment">#该策略优先远程调用同集群的微服务，同集群挂掉会访问其它集群</span></span><br></pre></td></tr></table></figure><h3 id="权重">权重</h3><p>在nacos管理页面中，可以为同一微服务同一集群的不同实例设置权重。权重越大，负载均衡选中的几率越大。</p><p>可以通过将权重置零来进行服务的升级，升级完成后设置较小权重进行服务测试。</p><h3 id="环境隔离">环境隔离</h3><p>不同环境（不同命名空间）的服务无法互相调用。可用于开发环境与上线后的环境隔离，大概？</p><p>在nacos管理页面中，可新建命名空间，获取它的id后，在需要配置环境隔离的服务项目的 application.yml 中，如下配置。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">AchatWs</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment">#nacos服务端地址</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">cluster-name:</span> <span class="string">YC</span> <span class="comment">#集群模拟，宜昌</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">id</span> <span class="comment">#命名空间的id</span></span><br></pre></td></tr></table></figure><h3 id="nacos配置管理">Nacos配置管理</h3><p>客户端引入nacos配置管理的依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>需要进行配置管理的项目新建 bootstrap.yml 文件，在其中写入与nacos有关的属性，如开发环境、服务端地址、微服务名称等。这些信息在 application.yml 中就可以不写了。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bootstrap.yml</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">UserService</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span> <span class="comment">#开发环境</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">cluster-name:</span> <span class="string">YC</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span> <span class="comment">#要获取的配置文件后缀名</span></span><br></pre></td></tr></table></figure><p>项目启动的时候，会优先读取 bootstrap.yml 中的配置信息，再根据其中的信息去nacos服务端获取nacos管理的配置，将这个获取到的配置与之后读取的 application.yml 作合并，最后才完整地启动项目。</p><p>nacos服务端新建配置，ID由“服务名-环境.后缀”组成最好。</p><p><img src="https://img1.imgtp.com/2022/10/16/wDZtkR8c.png" alt="自定义配置"></p><h3 id="nacos配置管理的热更新">Nacos配置管理的热更新</h3><h4 id="方式一">方式一</h4><p>哪里使用就为那里的类添加热更新注释。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RefreshScope</span> <span class="comment">//加这个注解才能实现配置的热更新</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;pattern.dateformat&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String format;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/time&quot;)</span></span><br><span class="line">    String <span class="title function_">getTime</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.now().format(DateTimeFormatter.ofPattern(format));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>官方对@RefreshScope的解释是</p><blockquote><p>Convenience annotation to put a @Bean definition in refresh scope. Beans annotated this way can be refreshed at runtime and any components that are using them will get a new instance on the next method call, fully initialized and injected with all dependencies.</p></blockquote><h4 id="方式二-推荐">方式二(推荐)</h4><p>自定义配置类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.userservice.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;pattern&quot;)</span><span class="comment">//prefix是前缀的意思，前缀和属性名拼接之后的属性若是在配置文件中，就可以实现自动注入</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PropertiesFromNacos</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String dateformat;<span class="comment">//属性名。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDateformat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dateformat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDateformat</span><span class="params">(String dateformat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.dateformat = dateformat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>@ConfigurationProperties(prefix = “xxx”)源码注释</p><blockquote><p>The prefix of the properties that are valid to bind to this object. Synonym for prefix(). A valid prefix is defined by one or more words separated with dots (e.g. “acme.system.feature”).<br>Returns: the prefix of the properties to bind</p></blockquote><p>使用该注释，需要引入依赖</p><blockquote><p>You can easily generate your own configuration metadata file from items annotated with <code>@ConfigurationProperties</code> by using the <code>spring-boot-configuration-processor</code> jar. The jar includes a Java annotation processor which is invoked as your project is compiled.</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="多环境共享配置">多环境共享配置</h3><p>在nacos管理页面创建配置文件的名字，只需要用服务的名字就可以了。比如，UserService,而不是UserService-dev.</p><p>项目启动时，会同时从nacos读取上述两种配置，后者的优先级大于前者，前者大于本地。同名属性则覆盖。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MicroService </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springboot项目打 jar 包没有webapp中的静态资源</title>
      <link href="/2022/10/07/SpringbootWithoutWebapp.html"/>
      <url>/2022/10/07/SpringbootWithoutWebapp.html</url>
      
        <content type="html"><![CDATA[<h3 id="问题发生场景">问题发生场景</h3><p>以下场景都建立在 maven 打 jar 包的基础上。</p><p>昨日我如往常一样，在springboot项目中新建 webapp 文件夹，然后在里面放俩空文件夹，作为项目里文件上传中转的地方。然后发现打包后程序运行时并不能找到webapp文件夹中的静态资源。查看编译后产生的 target 目录发现，webapp并没有被编译。如下图所示。</p><p><img src="https://img1.imgtp.com/2022/10/09/KyQk4s01.png" alt="webapp未编译"></p><p>而平时开发，直接通过 idea 运行的时候，却会编译 webapp 下的资源文件到 classes 目录下。如下图所示。</p><p><img src="https://img1.imgtp.com/2022/10/09/0NJ4MtZB.png" alt="idea直接运行"></p><span id="more"></span><h3 id="解决方案">解决方案</h3><p>如果跟我一样不愿意放弃 webapp 的使用，那么想要解决这个问题，就需要手动指定项目构建时的资源路径。</p><p>在 pom.xml 文件的 build 标签中，添加以下代码，手动指定资源路径。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/webapp<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">targetPath</span>&gt;</span>META-INF/resources<span class="tag">&lt;/<span class="name">targetPath</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/**<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ps：这样只指定webapp的路径的话，resource 中的 static 和 template 就不会被编译了。要是都想要的话，就得都手动指定。</p><p>也就是说，springboot 使用 maven编译时，默认只寻找 resources 中的静态资源，而忽略 webapp。</p><h3 id="附加">附加</h3><p>自问：为什么我以前学习 spring mvc 的时候，用 webapp 文件夹存放静态资源没有任何问题呢？</p><p>自答：非要说 springboot 和 spring mvc 直观上有哪里不太一样的话，那就是打包方式了。以前学习 spring mvc 的时候，都是打 war 包，然后部署到自己的 tomcat 服务器上。静态资源放在 webapp 中，而我似乎也一直是这么用的。但是当我学了spring boot后，项目都是在本地的idea直接运行，并没有正儿八经打包，然后手动部署过。因为 idea 自身会编译 webapp 下的文件，所以一直没有发现过问题。</p><p>所以另一种解决方案就是把 spring boot 打成 war 包。</p><h3 id="ps">PS</h3><p>究其原因还是项目打成 jar 包和 war 包的区别。这里采用网上的描述。</p><ul><li><p>jar文件包括java普通类、资源文件和普通文件，在maven中即是打包 src/main/java 和 src/main/resources 资源文件夹下的所有文件。在打包的时候会自动生成 META-INF 文件夹，用于存储 maven 的 pom 信息和 MANIFEST.MF 文件。（未包含 webapp 文件夹）</p></li><li><p>war文件包含全部的web应用程序，即所有的java类，配置信息和jsp、js等静态资源。（也就是说 webapp 文件夹也包含了）</p></li></ul><p>或许这就是为什么学习 spring mvc 的时候我还在前后端一体， 而学习 spring boot 后却下意识的用起了前后端分离吧。码农的直觉？</p>]]></content>
      
      
      <categories>
          
          <category> 小问题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Springboot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MicroService-Eureka</title>
      <link href="/2022/10/05/MicroserviceEureka.html"/>
      <url>/2022/10/05/MicroserviceEureka.html</url>
      
        <content type="html"><![CDATA[<h3 id="eureka">Eureka</h3><p>微服务的注册中心。</p><h3 id="服务端">服务端</h3><p>1.添加依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.应用启动入口标注@EnableEurekaServer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EurekaServerDemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(EurekaServerDemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.在 application.yml 中配置相关信息</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span> </span><br><span class="line">    <span class="attr">name:</span> <span class="string">eurekaServer</span> <span class="comment"># 应用自己的名称，会在eureka中注册后显示</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost/eureka</span> <span class="comment"># eureka的服务端地址</span></span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="客户端">客户端</h3><p>1.添加依赖(若是依赖管理中没有客户端的版本，则需要像下面这样手动添加，版本最好跟服务端保持一致)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.在 application.yml 中配置相关信息</p><p>修改端口和应用名称，eureka的服务端地址保持不变。</p><h3 id="远程调用">远程调用</h3><p>服务的远程调用包含两个客户端：调用服务的是消费者，被调用服务的是提供者。一个客户端可用同时是消费者和提供者。</p><p>远程调用服务可使用 RestTemplate 类的实例的 getObject 方法。</p><p>比如，我写一个工具类。将构建 RestTemplate 实体的工厂函数注册为 bean。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.imageservice.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在有需要的地方自动装配一个 RestTemplate 对象，调用它的各种请求方法就行了。post示例如下。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.imageservice.controller;</span><br><span class="line"><span class="keyword">import</span> cn.kahvia.imageservice.pojo.UploadResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.FileSystemResource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpEntity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpHeaders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.LinkedMultiValueMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.MultiValueMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/image&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImageController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RestTemplate restTemplate;</span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">uploadImg</span><span class="params">(MultipartFile file, HttpServletRequest request)</span>&#123;</span><br><span class="line">        String path=request.getServletContext().getRealPath(<span class="string">&quot;&quot;</span>);<span class="comment">//获取当前servlet上下文的绝对路径</span></span><br><span class="line"></span><br><span class="line">        File temp=<span class="keyword">new</span> <span class="title class_">File</span>(path,file.getOriginalFilename());<span class="comment">//在这个路径下新建一个临时文件temp</span></span><br><span class="line">        <span class="keyword">try</span> &#123;<span class="comment">//接受用户上传的文件，往temp中输出</span></span><br><span class="line">            InputStream inputStream=file.getInputStream();</span><br><span class="line">            FileOutputStream fileOutputStream=<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(temp);</span><br><span class="line">            BufferedOutputStream bufferedOutputStream=<span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(fileOutputStream);</span><br><span class="line">            <span class="type">int</span> n=<span class="number">0</span>;</span><br><span class="line">            <span class="type">byte</span> b[] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];<span class="comment">//1024个字节，也就1024byte，即1kb</span></span><br><span class="line">            <span class="keyword">while</span> ((n=inputStream.read(b))!=-<span class="number">1</span>)<span class="comment">//read(b)，是说从输入流中读取“b的大小”这么多的数据到b中，并返回读取的字节个数，-1代表读取完了</span></span><br><span class="line">            &#123;</span><br><span class="line">                bufferedOutputStream.write(b);<span class="comment">//把读取到的的，存放在b中的数据写入到输出流指向的文件中</span></span><br><span class="line">            &#125;</span><br><span class="line">            bufferedOutputStream.flush();<span class="comment">//刷新缓存区，刷新后，缓冲输出流指向的底层输入流，即fileOutputStream会立即将缓存的内容写入目的地</span></span><br><span class="line">            bufferedOutputStream.close();<span class="comment">//先关闭上层输出流</span></span><br><span class="line">            inputStream.close();<span class="comment">//再关闭底层输出流。按理说关了上层，底层也会自动关。</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//定义一个空的map，用来存储请求第三方接口所需的数据</span></span><br><span class="line">        MultiValueMap&lt;String,Object&gt; map= <span class="keyword">new</span> <span class="title class_">LinkedMultiValueMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//利用刚刚生成的临时文件，创建文件系统资源</span></span><br><span class="line">        FileSystemResource fileSystemResource=<span class="keyword">new</span> <span class="title class_">FileSystemResource</span>(temp);</span><br><span class="line">        <span class="comment">//添加到数据map中，第三方所需的参数名为image</span></span><br><span class="line">        map.add(<span class="string">&quot;image&quot;</span>,fileSystemResource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置请求头，包括访问的浏览器，和请求体内容固定类型，传输文件要选择表单数据&quot;multipart/form-data&quot;</span></span><br><span class="line">        <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">        headers.add(<span class="string">&quot;user-agent&quot;</span>, <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36&quot;</span>);</span><br><span class="line">        headers.add(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;multipart/form-data&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//生成http请求</span></span><br><span class="line">        HttpEntity&lt;MultiValueMap&lt;String, Object&gt;&gt; entity=<span class="keyword">new</span> <span class="title class_">HttpEntity</span>&lt;&gt;( map,headers);</span><br><span class="line">        <span class="comment">//发送http请求，返回目标对象。返回的json数据会自动封装为目标对象。</span></span><br><span class="line">        UploadResult uploadResult= restTemplate.postForObject(<span class="string">&quot;https://xxxxxx/api/upload&quot;</span>,entity,UploadResult.class);</span><br><span class="line">        temp.delete();<span class="comment">//删除中转文件</span></span><br><span class="line">        System.out.println(uploadResult.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="负载均衡">负载均衡</h3><p>为 RestTemplate 的工厂函数添加 @LoadBalanced注解</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.imageservice.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateUtil</span> &#123;</span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>原理：远程调用其它服务端的接口时，发出的请求会被拦截，然后根据请求的地址获取主机名（如果是eureka服务获取到的就是服务名），获取到服务名后再去eureka注册中心中取得对应服务名的所有服务端地址，根据负载均衡轮询或者随机的规则选取一个合适的地址，替换请求的地址中的服务名后，再放行，从而实现负载均衡。</p><h3 id="负载均衡的策略">负载均衡的策略</h3><ul><li>RoundRobinRule：简单的轮询。Ribbon默认策略。</li><li>ZoneAvoidanceRule：以区域为基础，进行服务器的选择。使用Zone进行分类。</li><li>RandomRule：随机。</li><li>RetryRule：重连。</li><li>AvailabilityFilteringRule，BestAvailableRule，WeightedResponseTimeRule等</li></ul><p>全局策略</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局配置，对所有微服务有效</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateUtil</span> &#123;</span><br><span class="line">    <span class="meta">@LoadBalanced</span><span class="comment">//使用负载均衡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> IRule <span class="title function_">setBalanceRule</span><span class="params">()</span>&#123;<span class="comment">//设置策略</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BestAvailableRule</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>局部策略</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">UserService:</span> <span class="comment">#为某个微服务配置负载均衡的规则</span></span><br><span class="line">  <span class="attr">ribbon:</span></span><br><span class="line">    <span class="attr">NFLoadBalancerRuleClassName:</span> <span class="string">com.netflix.loadbalancer.RandomRule</span></span><br></pre></td></tr></table></figure><h3 id="ribbon修改饥饿加载">Ribbon修改饥饿加载</h3><p>Ribbon默认是懒加载，也就是说，Ribbon提供的负载均衡的服务 LoadBalancerClient 并不会随着服务端启动而启动。第一次请求远程调用时，会初始化负载均衡服务，所以第一次会比较慢。</p><p>如果想要让负载均衡服务随着服务端启动而启动，就需要设置饥饿加载。在 application.yml 文件中配置饥饿加载。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ribbon:</span></span><br><span class="line">  <span class="attr">eager-load:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#开启饥饿加载，减少第一次远程调用的时间</span></span><br><span class="line">    <span class="attr">clients:</span> <span class="string">UserService</span> <span class="comment">#饥饿加载的名称,多个则换行以-开头分隔</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MicroService </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-TextFormField</title>
      <link href="/2022/10/01/FlutterTextFormField.html"/>
      <url>/2022/10/01/FlutterTextFormField.html</url>
      
        <content type="html"><![CDATA[<h3 id="textformfield">TextFormField</h3><ul><li>decoration：使用 InputDecoration 来创建文本框</li><li>controller：指定 TextEditingController 对象，可以通过这个对象来获取文本框的值</li></ul><h4 id="inputdecoration">InputDecoration</h4><ul><li>focusedBorder：文本框聚焦的时候的边框样式</li><li>disabledBorder：禁止输入时</li><li>enabledBorder：允许选中时</li><li>contentPadding：文本区实际上是由 InputDecoration 创建的，而此处的 padding 就是设置的这个文本区的 padding</li><li>border：设置为 Border.none 可以不渲染边框。但是常常会造成文本框内容不能居中。</li><li>hintText：输入框的提示字段，类似于 html 中的 placeholder</li></ul><p>ps：想要输入框的内容正常的垂直居中，就需要边框，不想要样式的话，可以设置边框为透明色，宽度为0。除此之外，还需要设置 contentPadding 为0才能保证绝对垂直居中。</p><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">TextFormField(</span><br><span class="line">  decoration: <span class="keyword">const</span> InputDecoration(</span><br><span class="line">    focusedBorder: OutlineInputBorder(</span><br><span class="line">        borderSide: BorderSide(width: <span class="number">0</span>, color: Colors.transparent)),</span><br><span class="line">    disabledBorder: OutlineInputBorder(</span><br><span class="line">        borderSide: BorderSide(width: <span class="number">0</span>, color: Colors.transparent)),</span><br><span class="line">    enabledBorder: OutlineInputBorder(</span><br><span class="line">        borderSide: BorderSide(width: <span class="number">0</span>, color: Colors.transparent)),</span><br><span class="line">    contentPadding: EdgeInsets.symmetric(vertical: <span class="number">0</span>),</span><br><span class="line">    hintText: <span class="string">&quot;消息&quot;</span>,</span><br><span class="line">  ),</span><br><span class="line">  controller: textEditingController,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-购物小测试</title>
      <link href="/2022/09/29/FlutterGoodsStoreDemo.html"/>
      <url>/2022/09/29/FlutterGoodsStoreDemo.html</url>
      
        <content type="html"><![CDATA[<p>在学习 Provider 的时候，我在 flutter 的官方小教程中，看到了一个 demo，有关购买商品，加入购物车的。刚学习 Provider 的时候，很多地方不明白，所以那个案例也没有能够理解。</p><p>今天的我已经能使用 Navigator 和 Provider 的知识了。利用我已有的知识，可以大概模仿出官方 demo 的样子了。</p><h3 id="路由分析">路由分析</h3><p>这个 demo 涉及到三个页面，第一个是登录界面，第二个是商品界面，第三个是购物车界面。</p><p>分别命名为：Login, Catalog, Cart</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/Login.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/Catalog.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/Cart.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> routes=&#123;</span><br><span class="line">  <span class="string">&#x27;login&#x27;</span>:(context) =&gt; <span class="keyword">const</span> Login(),</span><br><span class="line">  <span class="string">&quot;catalog&quot;</span>:(context) =&gt; <span class="keyword">const</span> Catalog(),</span><br><span class="line">  <span class="string">&quot;cart&quot;</span>:(context) =&gt; <span class="keyword">const</span> Cart(),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="共享数据">共享数据</h3><p>建立数据模型</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GoodsModel</span> <span class="keyword">extends</span> <span class="title">ChangeNotifier</span></span>&#123;<span class="comment">//共享数据的数据模型</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _itemNames = [<span class="comment">//模拟数据，商品名称</span></span><br><span class="line">    <span class="string">&#x27;Code Smell&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Control Flow&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Interpreter&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Recursion&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sprint&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Heisenbug&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Spaghetti&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Hydra Code&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Off-By-One&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Scope&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Callback&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Closure&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Automata&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Bit Shift&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Currying&#x27;</span>,</span><br><span class="line">  ];</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">bool</span>&gt; _isSelected=<span class="built_in">List</span>.generate(<span class="number">15</span>, (index) =&gt; <span class="keyword">false</span>);<span class="comment">//都设置为未加入购物车</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _selectedItems=[];<span class="comment">//已选中的商品名称</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">List</span> <span class="keyword">get</span> itemNames=&gt;_itemNames;<span class="comment">//暴露以上私有成员变量</span></span><br><span class="line">  <span class="built_in">List</span> <span class="keyword">get</span> selectedItems=&gt;_selectedItems;</span><br><span class="line">  <span class="built_in">List</span> <span class="keyword">get</span> isSelected=&gt;_isSelected;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> selectItem(<span class="built_in">int</span> id)&#123;<span class="comment">//加入购物车</span></span><br><span class="line">    _selectedItems.add(_itemNames[id]);</span><br><span class="line">    _isSelected[id]=<span class="keyword">true</span>;</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> unselectItem(<span class="built_in">int</span> id)&#123;<span class="comment">//移出购物车</span></span><br><span class="line">    _selectedItems.remove(_itemNames[id]);</span><br><span class="line">    _isSelected[id]=<span class="keyword">false</span>;</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将数据模型放置在高级节点上，使其子孙组件都能访问共享数据。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyApp(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ChangeNotifierProvider(<span class="comment">//使用共享数据</span></span><br><span class="line">      create: (context)=&gt;GoodsModel(),</span><br><span class="line">      child: MaterialApp(</span><br><span class="line">        title: <span class="string">&quot;Store&quot;</span>,</span><br><span class="line">        debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">        routes: routes,<span class="comment">//设置路由</span></span><br><span class="line">        initialRoute: <span class="string">&#x27;login&#x27;</span>,<span class="comment">//默认路由，即app首页</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="login">Login</h3><p>简单的登录界面实现。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Login(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(<span class="comment">//标准结构</span></span><br><span class="line">      body: Center(<span class="comment">//整体居中，当然了，只是它的子组件居中，水平和垂直</span></span><br><span class="line">        child: Container(<span class="comment">//有子组件则匹配子组件的大小，没有子组件则看父级有无传递约束，有约束则都尽可能大，如果这个约束是无限，那就尽可能小。自己设定的宽高会覆盖前面所说的大小。</span></span><br><span class="line">          padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">50</span>),<span class="comment">//加个内边距</span></span><br><span class="line">          color: Colors.white70,</span><br><span class="line">          child: Column(<span class="comment">//Column会占满可用空间</span></span><br><span class="line">            mainAxisAlignment: MainAxisAlignment.center,<span class="comment">//想让登录信息的部分居中就要这样做设置，因为上面的Center只是让Column的父级居中了</span></span><br><span class="line">              children: [</span><br><span class="line">                <span class="keyword">const</span> Text(</span><br><span class="line">                  <span class="string">&#x27;Welcome&#x27;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                    color: Colors.black,</span><br><span class="line">                    fontSize: <span class="number">30</span>,</span><br><span class="line">                    fontWeight: FontWeight.bold,<span class="comment">//标题加粗</span></span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                TextFormField(</span><br><span class="line">                  decoration: <span class="keyword">const</span> InputDecoration(</span><br><span class="line">                    hintText: <span class="string">&#x27;Username&#x27;</span>,<span class="comment">//设置占位信息</span></span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                TextFormField(</span><br><span class="line">                  decoration: <span class="keyword">const</span> InputDecoration(</span><br><span class="line">                    hintText: <span class="string">&#x27;Password&#x27;</span>,</span><br><span class="line">                  ),</span><br><span class="line">                  obscureText: <span class="keyword">true</span>,<span class="comment">//模糊文本，也就是隐藏文本信息，密码框嘛</span></span><br><span class="line">                ),</span><br><span class="line">                <span class="keyword">const</span> SizedBox(<span class="comment">//占位的空白组件</span></span><br><span class="line">                  height: <span class="number">24</span>,</span><br><span class="line">                ),</span><br><span class="line">                ElevatedButton(<span class="comment">//普通的按钮</span></span><br><span class="line">                  onPressed: () &#123;</span><br><span class="line">                    Navigator.pushNamed(context, <span class="string">&#x27;catalog&#x27;</span>);<span class="comment">//登录跳转</span></span><br><span class="line">                  &#125;,</span><br><span class="line">                  style: ButtonStyle(</span><br><span class="line">                    backgroundColor: MaterialStateProperty.all(Colors.black)<span class="comment">//设置背景色</span></span><br><span class="line">                  ),</span><br><span class="line">                  child: <span class="keyword">const</span> Text(<span class="string">&#x27;ENTER&#x27;</span>),</span><br><span class="line">                )</span><br><span class="line">              ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/29/iVZdZmjK.png" alt="登录界面"></p><h3 id="catalog">Catalog</h3><p>商品目录。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/main.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:provider/provider.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Catalog</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Catalog(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; itemNames = context.read&lt;GoodsModel&gt;().itemNames <span class="keyword">as</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;;<span class="comment">//获取共享数据中的商品名称</span></span><br><span class="line">    <span class="comment">//根据商品名称生成每一行的商品信息。包括了商品的图片（这里用随机颜色代替），商品id，商品名称。商品类是自定义的。</span></span><br><span class="line">    <span class="built_in">List</span>&lt;Good&gt; goods=<span class="built_in">List</span>.generate(itemNames.length, (index) =&gt; Good(color: Colors.primaries[index],id: index,name: itemNames[index],));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        backgroundColor: Colors.black,</span><br><span class="line">        title: <span class="keyword">const</span> Text(<span class="string">&quot;Catalog&quot;</span>),</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line">        actions: [IconButton(</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              Navigator.pushNamed(context, <span class="string">&#x27;cart&#x27;</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            icon: <span class="keyword">const</span> Icon(Icons.shopping_cart)</span><br><span class="line">        )],</span><br><span class="line">      ),</span><br><span class="line">      body: GridView(<span class="comment">//这里之所以使用网格列表，是因为网格列表可以滚动，且设置垂直间距更方便</span></span><br><span class="line">        gridDelegate: <span class="keyword">const</span> SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">          crossAxisCount: <span class="number">1</span>,<span class="comment">//一列</span></span><br><span class="line">          mainAxisSpacing: <span class="number">0</span>,<span class="comment">//每一行之间的距离</span></span><br><span class="line">          mainAxisExtent: <span class="number">80</span><span class="comment">//每一行的高度</span></span><br><span class="line">        ),</span><br><span class="line">        children: goods,<span class="comment">//刚刚生成是商品们</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Good</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//自定义的商品组件</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> id;<span class="comment">//商品id</span></span><br><span class="line">  <span class="keyword">final</span> Color color;<span class="comment">//商品图片（颜色替代）</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> name;<span class="comment">//商品名称</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> Good(&#123;Key? key, <span class="keyword">required</span> <span class="keyword">this</span>.color, <span class="keyword">required</span> <span class="keyword">this</span>.id, <span class="keyword">required</span> <span class="keyword">this</span>.name&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">bool</span> selected=context.watch&lt;GoodsModel&gt;().isSelected[id];<span class="comment">//确认商品是否选中再初始化</span></span><br><span class="line">    <span class="keyword">return</span>  Padding(</span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">16</span>,vertical: <span class="number">8</span>),</span><br><span class="line">      child: Row(<span class="comment">//每个商品就是一行</span></span><br><span class="line">        <span class="comment">// mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span></span><br><span class="line">        children: [<span class="comment">//一行中的所有列</span></span><br><span class="line">          Container(<span class="comment">//颜色块</span></span><br><span class="line">            width: <span class="number">50</span>,</span><br><span class="line">            height: <span class="number">50</span>,</span><br><span class="line">            color: color,</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">const</span> SizedBox(width: <span class="number">24</span>),<span class="comment">//空白块分隔</span></span><br><span class="line">           Expanded(<span class="comment">//拓展区，自动占满剩余未分配区域</span></span><br><span class="line">            child: Text(name,style: <span class="keyword">const</span> TextStyle(</span><br><span class="line">                fontSize: <span class="number">24</span></span><br><span class="line">            ),),</span><br><span class="line">          ),</span><br><span class="line">          TextButton(<span class="comment">//添加购物车按钮</span></span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span>(selected==<span class="keyword">true</span>)&#123;<span class="comment">//移出购物车</span></span><br><span class="line">                selected=!selected;</span><br><span class="line">                context.read&lt;GoodsModel&gt;().unselectItem(id);</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span>&#123;<span class="comment">//加入购物车</span></span><br><span class="line">                selected=!selected;</span><br><span class="line">                context.read&lt;GoodsModel&gt;().selectItem(id);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: selected</span><br><span class="line">                ?<span class="keyword">const</span> Icon(Icons.check,size: <span class="number">20</span>,)<span class="comment">//已经选中，则变成勾勾图标</span></span><br><span class="line">                :<span class="keyword">const</span> Text(<span class="comment">//未选中，则文字ADD</span></span><br><span class="line">              <span class="string">&quot;ADD&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.black,</span><br><span class="line">                fontSize: <span class="number">20</span></span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">const</span> SizedBox(width: <span class="number">24</span>),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/29/XUcRuMDR.png" alt="商品界面"></p><h3 id="cart">Cart</h3><p>购物车。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/main.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:provider/provider.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cart</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Cart(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        backgroundColor: Colors.black,</span><br><span class="line">        title: <span class="keyword">const</span> Text(<span class="string">&quot;Cart&quot;</span>),</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line">      ),</span><br><span class="line">      body: MyCart(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyCart</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyCart(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; texts=context.watch&lt;GoodsModel&gt;().selectedItems <span class="keyword">as</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;;<span class="comment">//获取共享数据中已经选择的商品</span></span><br><span class="line">    <span class="built_in">List</span>&lt;Text&gt; goods=<span class="built_in">List</span>.generate(texts.length, (index) =&gt; Text(<span class="comment">//生成购物车清单</span></span><br><span class="line">        texts[index],</span><br><span class="line">      style: <span class="keyword">const</span> TextStyle(</span><br><span class="line">        fontSize: <span class="number">30</span></span><br><span class="line">      ),</span><br><span class="line">    ));</span><br><span class="line">    <span class="built_in">int</span> price=texts.length*<span class="number">42</span>;<span class="comment">//每件商品按42美元计算</span></span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.orange,</span><br><span class="line">      child: Padding(</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">20</span>,vertical: <span class="number">16</span>),</span><br><span class="line">        child: Column(</span><br><span class="line">          children: [</span><br><span class="line">            Container(</span><br><span class="line">              height: <span class="number">400</span>,</span><br><span class="line">              child: Row(</span><br><span class="line">                children: [</span><br><span class="line">                  Column(</span><br><span class="line">                    mainAxisAlignment: MainAxisAlignment.start,</span><br><span class="line">                    crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">                    children: goods,</span><br><span class="line">                  )</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            Container(</span><br><span class="line">              height: <span class="number">150</span>,</span><br><span class="line">              decoration: <span class="keyword">const</span> BoxDecoration(</span><br><span class="line">                  border: Border.symmetric(horizontal: BorderSide(</span><br><span class="line">                      style: BorderStyle.solid</span><br><span class="line">                  ))</span><br><span class="line">              ),</span><br><span class="line">              child: Row(</span><br><span class="line">                children: [</span><br><span class="line">                  <span class="keyword">const</span> SizedBox(width: <span class="number">40</span>,),</span><br><span class="line">                  <span class="keyword">const</span> Text(<span class="string">&quot;\$&quot;</span>,style: TextStyle(fontSize: <span class="number">50</span>),),</span><br><span class="line">                  Text(<span class="string">&quot;<span class="subst">$price</span>&quot;</span>,style: <span class="keyword">const</span> TextStyle(fontSize: <span class="number">50</span>),),</span><br><span class="line">                  <span class="keyword">const</span> SizedBox(width: <span class="number">50</span>,),</span><br><span class="line">                  TextButton(</span><br><span class="line">                    onPressed: ()&#123;&#125;,</span><br><span class="line">                    style: ButtonStyle(</span><br><span class="line">                      backgroundColor:MaterialStateProperty.all(Colors.white),</span><br><span class="line">                      minimumSize: MaterialStateProperty.all(<span class="keyword">const</span> Size(<span class="number">120</span>, <span class="number">50</span>))</span><br><span class="line">                    ),</span><br><span class="line">                    child: <span class="keyword">const</span> Text(<span class="string">&quot;BUY&quot;</span>),</span><br><span class="line">                  )</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/29/JQ9DN2GD.png" alt="购物车界面"></p><h3 id="总结">总结</h3><ul><li>难能可贵的综合运用</li><li>布局的思维模式和熟练度有待提升</li></ul>]]></content>
      
      
      <categories>
          
          <category> 实践 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-BottomNavigatorBar</title>
      <link href="/2022/09/29/FlutterBottomNavigatorBar.html"/>
      <url>/2022/09/29/FlutterBottomNavigatorBar.html</url>
      
        <content type="html"><![CDATA[<p>ottomNavigatorBar 是 Scaffold 组件中的，底部的导航栏。</p><h3 id="bottomnavigatorbar">BottomNavigatorBar</h3><ul><li>items：BottomNavigatorBarItem（）<ul><li>label：标签名称</li><li>icon：图标</li><li>backgroundColor：背景颜色，在 BottomNavigatorBar  的type设置为BottomNavigationBarType.shifting时生效</li></ul></li><li>currentIndex：当前选项卡的索引，当前选项卡会高亮</li><li>backgroundColor：导航栏背景图片</li><li>elevation：阴影</li><li>fixedColor：选中的 item 字体颜色和图标颜色</li><li>onTap：点击选项时触发的函数，需要传入 index （点击选项的索引），（index）{xxx}，用于更新当前索引</li></ul>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Navigator</title>
      <link href="/2022/09/28/Navigator.html"/>
      <url>/2022/09/28/Navigator.html</url>
      
        <content type="html"><![CDATA[<p>Navigator用于管理路由。</p><h3 id="三种路由-省略动态路由">三种路由（省略动态路由）</h3><ul><li><p>匿名路由</p><ul><li><pre><code class="language-dart">Navigator.push(context, MaterialPageRoute(build:(context)=&gt;diyWidget()))<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 命名路由</span><br><span class="line"></span><br><span class="line">  * ``` dart</span><br><span class="line">    Navigator.pushNamed(context, name)</span><br></pre></td></tr></table></figure></code></pre></li><li><p>name 指创建的路由表中的 key，如下所示</p></li><li><pre><code class="language-dart">var routes=&#123;  'home':(context)=&gt; const IndexPage(),  'OfficialDemo':(context)=&gt;const OfficialDemo(),  'Container':(context)=&gt;const ContainerDemo(),  'ColumnRow':(context)=&gt;const ColumnAndRow(),  'Flex':(context)=&gt;const FlexPage(),  'Wrap':(context)=&gt;const WrapPage(),  'Stack':(context)=&gt;const StackPage(),  'Card':(context)=&gt;const CardPage(),  'LayoutTest':(context)=&gt;const LayoutTest(),  'StatefulWidget':(context)=&gt;const StatefulWidgetPage(),  'Button':(context)=&gt;const ButtonPage(),  'SingleChildScrollViewPage':(context)=&gt;const SingleChildScrollViewPage(),  'ListView':(context)=&gt;const ListViewPage(),  'GridView':(context)=&gt;const GridViewPage(),&#125;;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 路由传参</span><br><span class="line"></span><br><span class="line">* 匿名路由</span><br><span class="line"></span><br><span class="line">  * 在要跳转的页面对应的组件中，写上对应的属性，标记为 required，在跳转页面的时候，传递有关参数即可。</span><br><span class="line">  * 简单来说，就是靠页面对应组件自身的属性和构造函数来进行路由传参。</span><br><span class="line"></span><br><span class="line">* 命名路由</span><br><span class="line"></span><br><span class="line">  * ```dart</span><br><span class="line">    Navigator.pushNamed(context, name, &#123;arguments&#125;)//携带参数的路由跳转</span><br></pre></td></tr></table></figure></code></pre></li><li><p>arguments 是一个 map 对象，就像上面的路由表一样。</p></li><li><pre><code class="language-dart">ModalRoute.of(context).settings.arguments;//获取传递过来的arguments</code></pre></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-InheritedWidget</title>
      <link href="/2022/09/26/InheritedWidget.html"/>
      <url>/2022/09/26/InheritedWidget.html</url>
      
        <content type="html"><![CDATA[<h3 id="inheritedwidget">InheritedWidget</h3><ul><li>flutter中用于数据共享的组件。</li><li>创建自定义类，继承 InheritedWidget ，用这个自定义类的组件实例包裹子组件，使得子组件及其后代都可以访问自定义类实例中的共享数据。</li></ul><h3 id="自定义类">自定义类</h3><p>使用 inh 简写快速生成自定义类并继承数据共享组件。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WaitingData</span> <span class="keyword">extends</span> <span class="title">InheritedWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> name; <span class="comment">//自定义共享数据，需要final前缀</span></span><br><span class="line">  <span class="keyword">const</span> WaitingData(&#123;</span><br><span class="line">    Key? key,</span><br><span class="line">    <span class="keyword">required</span> Widget child,</span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">this</span>.name</span><br><span class="line">  &#125;) : <span class="keyword">super</span>(key: key, child: child);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> WaitingData of(BuildContext context) &#123;<span class="comment">//静态方法，简化了获取共享数据的方式。不用这种就用下面这行复杂方式</span></span><br><span class="line">    <span class="keyword">final</span> WaitingData? result = context.dependOnInheritedWidgetOfExactType&lt;WaitingData&gt;();</span><br><span class="line">    <span class="keyword">assert</span>(result != <span class="keyword">null</span>, <span class="string">&#x27;No WaitingData found in context&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> result!;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">bool</span> updateShouldNotify(WaitingData old) &#123;<span class="comment">//指明什么时候重新渲染组件</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;<span class="comment">//true则当数据改变的时候，每次都重新渲染。可以写箭头函数来指明条件。</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="自定义类实例的使用">自定义类实例的使用</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;MyPage&gt; createState() =&gt; _MyPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyPage</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  WaitingData(</span><br><span class="line">        name: <span class="string">&quot;Kahvia!&quot;</span>,</span><br><span class="line">        child: Builder(<span class="comment">//用Builder才能获取到上下文</span></span><br><span class="line">            builder: (BuildContext centerContext)&#123;<span class="comment">//这个上下文的内容包括Builder（）外面的东西，即包含了name</span></span><br><span class="line">              <span class="keyword">return</span> Center(</span><br><span class="line">                child: Text(</span><br><span class="line">                    <span class="string">&quot;Hello,<span class="subst">$&#123;WaitingData.of(centerContext).name&#125;</span>&quot;</span>,<span class="comment">//如果用的的context，那context上下文中则没有name，会报错</span></span><br><span class="line">                    style: <span class="keyword">const</span> TextStyle(</span><br><span class="line">                      fontSize: <span class="number">25</span>,</span><br><span class="line">                      color: Colors.blue</span><br><span class="line">                    ),</span><br><span class="line">                ),</span><br><span class="line">              );</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="注意事项">注意事项</h4><ul><li>明确上下文（context），想要获取共享数据，就需要使用<font color=#66AFE)><strong>共享数据组件的子组件的上下文</strong></font></li><li>获取上下文可以用Builder（）</li></ul>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Provider</title>
      <link href="/2022/09/26/FlutterProvider.html"/>
      <url>/2022/09/26/FlutterProvider.html</url>
      
        <content type="html"><![CDATA[<p>Provider是第三方状态管理的库。就我目前的水平来看，它貌似能代替 StatefulWidget 和 InheritedWidget 。</p><h3 id="安装-带-表示可以自动更新">安装（带^表示可以自动更新）</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span></span><br><span class="line">  <span class="attr">provider:</span> <span class="string">^6.0.3</span></span><br></pre></td></tr></table></figure><h3 id="使用">使用</h3><ul><li><p>创建数据模型（自定义类），继承 ChangeNotifier ，暴露想要共享的数据, 以及创建可选的修改数据的方法。</p></li><li><p>创建观察者，或者说数据模型的提供者——Provider。</p><ul><li>通过Provider（）提供的数据通常是不可变的。</li><li>通过ChangeNotifierProvider（）提供的数据可以改变，并可以通过调用notifyListeners（）来更新使用到共享数据的组件。<ul><li>和 InheritedWidget 类似，包裹需要使用共享数据的子孙组件。包裹一次，子孙组件都可以作为监听者（listener）使用数据。</li><li>为 create 属性提供构造器，需要传入上下文context</li><li>child 子组件，也就是包裹的子孙组件</li></ul></li></ul></li><li><p>作为 Listener 使用共享数据。因为时常需要响应数据的变化，所以叫监听者。</p><ul><li><p>context.watch &lt; Type &gt;( ).atributeName，通过上下文的注入方法（由provider自动注入，也就是附加方法）来获取数据。</p></li><li><p>Provider.Of&lt; Type &gt;(context).atributeName, 通过Provider的静态方法来获取数据。</p></li><li><p>查看源码发现，第一种方法就是封装后的第二种方法</p></li><li><pre><code class="language-dart">T watch&lt;T&gt;() &#123;  return Provider.of&lt;T&gt;(this);&#125;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line"></span><br><span class="line">### 代码区</span><br><span class="line"></span><br><span class="line">#### 数据模型</span><br><span class="line"></span><br><span class="line">```dart</span><br><span class="line">class LikeData extends ChangeNotifier&#123;</span><br><span class="line">  int _number=520;</span><br><span class="line">  bool _liking=true;</span><br><span class="line"></span><br><span class="line">  int get number =&gt; _number;//暴露私有变量，让外部访问。</span><br><span class="line">  bool get liking =&gt; _liking;</span><br><span class="line"></span><br><span class="line">  void changeLikeState()&#123;//改变收藏状态的函数</span><br><span class="line">    if(_liking==true)&#123;</span><br><span class="line">      _liking=false;</span><br><span class="line">      _number--;</span><br><span class="line">      notifyListeners();//数据改变了，通知数据监听者（provider）去改变值</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">      _liking=true;</span><br><span class="line">      _number++;</span><br><span class="line">      notifyListeners();//数据改变了，通知数据监听者（provider）去改变值</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre></li></ul></li></ul><h4 id="观察者">观察者</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Home(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ChangeNotifierProvider(<span class="comment">//包裹需要数据的子孙组件</span></span><br><span class="line">      create: (BuildContext context)=&gt;LikeData(),<span class="comment">//构造器构造数据模型</span></span><br><span class="line">      child: Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">          title: <span class="keyword">const</span> Text(<span class="string">&#x27;Provider&#x27;</span>),</span><br><span class="line">          leading: <span class="keyword">const</span> Icon(Icons.menu),</span><br><span class="line">          actions: <span class="keyword">const</span>[Icon(Icons.settings)],</span><br><span class="line">        ),</span><br><span class="line">        body:  MyPage(),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="监听者-使用到共享数据的那一部分">监听者（使用到共享数据的那一部分）</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Widget titleSection = Builder(</span><br><span class="line">    builder: (BuildContext context)=&gt;Container(<span class="comment">//自定义组件，标题部分，即头部部分</span></span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">32</span>),</span><br><span class="line">      child: Row(<span class="comment">//一行</span></span><br><span class="line">        children: [<span class="comment">//三列</span></span><br><span class="line">          Expanded(<span class="comment">//第一列，标题和副标题</span></span><br><span class="line">            child: Column(<span class="comment">//第一列有两行</span></span><br><span class="line">              crossAxisAlignment: CrossAxisAlignment.start,<span class="comment">//交叉轴方向，此处即水平方向对齐方式，在起点处对齐，即左对齐</span></span><br><span class="line">              children: [</span><br><span class="line">                <span class="keyword">const</span> Text(<span class="comment">//第一行</span></span><br><span class="line">                  <span class="string">&quot;Hello,this is Alice!&quot;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                    fontWeight: FontWeight.bold,<span class="comment">//加粗，表明主体</span></span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                Text(<span class="comment">//第二行</span></span><br><span class="line">                  <span class="string">&quot;Good evening!&quot;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                    color: Colors.grey[<span class="number">500</span>],<span class="comment">//灰色</span></span><br><span class="line">                  ),</span><br><span class="line">                )</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">           IconButton(<span class="comment">//第二列，收藏图标</span></span><br><span class="line">             icon: Icon(context.watch&lt;LikeData&gt;().liking?Icons.star:Icons.star_border),<span class="comment">//获取共享数据的第一种方法</span></span><br><span class="line">             color: Colors.red,</span><br><span class="line">             onPressed: context.watch&lt;LikeData&gt;().changeLikeState,</span><br><span class="line">          ),</span><br><span class="line">           Text(<span class="comment">//第三列，收藏数</span></span><br><span class="line">            <span class="string">&quot;<span class="subst">$&#123;Provider.of&lt;LikeData&gt;(context).number&#125;</span>&quot;</span>,<span class="comment">//获取共享数据的第二种方法</span></span><br><span class="line">            <span class="comment">//   &quot;520&quot;</span></span><br><span class="line">          )</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="ps">ps</h3><p>代码实现的功能和之前测试的“有状态组件”一样，都是实现收藏功能和它的收藏数变化。</p><p>不同的地方是，使用provider后，没有使用状态组件进行状态管理。但是很显然，这种共享数据的模式在多重嵌套组件下，可以更好的实现状态管理，而不用通过构造函数传递所需数据，也不需要通过手动调用 setState（）进行组件的重新渲染。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-DataTable</title>
      <link href="/2022/09/24/DataTable.html"/>
      <url>/2022/09/24/DataTable.html</url>
      
        <content type="html"><![CDATA[<h3 id="datatable">DataTable</h3><ul><li>sortColumnIndex：排序的列号</li><li>sortAscending：排序方式，true为升序，false为降序，决定了排序箭头的上下，也决定了排序事件的传入值</li><li>columns：表格头部们</li><li>rows：各行数据，通常是动态生成的</li><li>详情用法见代码部分，我相信未来的我看到代码一定能秒懂。</li></ul><span id="more"></span><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">  <span class="built_in">String</span> name;</span><br><span class="line">  <span class="built_in">int</span> age;</span><br><span class="line">  <span class="built_in">String</span> school;</span><br><span class="line">  <span class="built_in">bool</span> selected;</span><br><span class="line">  <span class="comment">//学生类和它的构造函数</span></span><br><span class="line">  Student(<span class="keyword">this</span>.name,<span class="keyword">this</span>.age,<span class="keyword">this</span>.school,&#123;<span class="keyword">this</span>.selected=<span class="keyword">false</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;MyPage&gt; createState() =&gt; _MyPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">bool</span> asc=<span class="keyword">true</span>;<span class="comment">//定义排序的方式，定义true为升序，false为降序</span></span><br><span class="line">  <span class="comment">//模仿接收后台的数据</span></span><br><span class="line">  <span class="built_in">List</span>&lt;Student&gt; students=[</span><br><span class="line">    Student(<span class="string">&quot;阿东&quot;</span>, <span class="number">21</span>, <span class="string">&quot;Three Gorges&quot;</span>),</span><br><span class="line">    Student(<span class="string">&quot;阿叶&quot;</span>, <span class="number">20</span>, <span class="string">&quot;Three Gorges&quot;</span>)</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  getStudentsData()&#123;<span class="comment">//生成表单数据</span></span><br><span class="line">    <span class="built_in">List</span>&lt;DataRow&gt; dataRows=[];<span class="comment">//生成空行们</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> element <span class="keyword">in</span> students) &#123;<span class="comment">//for循环添加数据</span></span><br><span class="line">      dataRows.add(DataRow(</span><br><span class="line">          selected: element.selected,<span class="comment">//这一行默认的选中状态</span></span><br><span class="line">          onSelectChanged: (selected)&#123;<span class="comment">//单击行时调用的函数，selected是当前行点击后的状态</span></span><br><span class="line">            setState(() &#123;<span class="comment">//使用setState是为了重新渲染组件</span></span><br><span class="line">              element.selected=selected!;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          cells: [<span class="comment">//cell，也就是单元格，一行数据中固定最小单位</span></span><br><span class="line">            DataCell(Text(element.name)),</span><br><span class="line">            DataCell(Text(<span class="string">&quot;<span class="subst">$&#123;element.age&#125;</span>&quot;</span>)),<span class="comment">//因为Student定义的年龄是int类型，所以要加双引号变成字符串才能作为Text的内容</span></span><br><span class="line">            DataCell(Text(element.school))</span><br><span class="line">          ]</span><br><span class="line">      ));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dataRows;<span class="comment">//返回生成好的表单数据</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> SingleChildScrollView(</span><br><span class="line">      physics: <span class="keyword">const</span> BouncingScrollPhysics(),</span><br><span class="line">      child: DataTable(</span><br><span class="line">        sortColumnIndex: <span class="number">1</span>,<span class="comment">//指定需要排序的列号，这里的1为年龄那一列。复选框的那一列不计入。</span></span><br><span class="line">        sortAscending: asc,<span class="comment">//指定排序方式，asc为上面定义的布尔值，同时它决定了排序箭头的方向，也决定了下方点击排序后产生的toBeAsc的值</span></span><br><span class="line">        columns:  [</span><br><span class="line">          <span class="keyword">const</span> DataColumn(label: Text(<span class="string">&quot;name&quot;</span>)),</span><br><span class="line">          DataColumn(</span><br><span class="line">            label: <span class="keyword">const</span> Text(<span class="string">&quot;age&quot;</span>),</span><br><span class="line">            numeric: <span class="keyword">true</span>,<span class="comment">//需要排序的列，要把列设置为数字型的列。</span></span><br><span class="line">            onSort: (<span class="built_in">int</span> index,<span class="built_in">bool</span> toBeAsc)&#123;<span class="comment">//然后定义它的排序方式，传入的是一个匿名函数，index为列号？toBeAsc是点击排序后，传入的布尔值，即是否是升序（ASC）</span></span><br><span class="line">                setState(() &#123;<span class="comment">//自然要用到setState来重新渲染组件</span></span><br><span class="line">                  asc=toBeAsc;<span class="comment">//toBeAsc是点击排序箭头后的值。如果点击前是向上的箭头，即升序(true)，那点击后这个toBeAsc的值，就是false</span></span><br><span class="line">                  <span class="keyword">if</span>(toBeAsc)&#123;<span class="comment">//排序可以看源码注释，就是给sort函数传入一个匿名函数，自己决定如何定义它们的大小。这里是compare年龄来决定大小</span></span><br><span class="line">                    students.sort((a,b) =&gt; a.age.compareTo(b.age));</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">else</span> &#123;</span><br><span class="line">                    students.sort((a,b) =&gt; b.age.compareTo(a.age));</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">const</span> DataColumn(label: Text(<span class="string">&quot;school&quot;</span>))</span><br><span class="line">        ],</span><br><span class="line">        rows: getStudentsData(),<span class="comment">//调用函数，获取表单数据</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/24/eeefH0CF.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-ThirdPackage</title>
      <link href="/2022/09/18/ThirdPackage.html"/>
      <url>/2022/09/18/ThirdPackage.html</url>
      
        <content type="html"><![CDATA[<p>在开发中经常要用到第三方库，而 Flutter 开发经常用的第三方库可以在<a href="https://pub.dev/">pub.dev</a>中寻找。</p><p>使用方法：</p><ol><li><p>在库存中寻找想要的包</p></li><li><p>在项目的 pubspec.yaml 中添加依赖</p></li><li><pre><code class="language-bash">flutter pub get <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. 有的时候添加依赖后保存了，就自动下载了。用不到上述命令。</span><br><span class="line"></span><br><span class="line">### dio</span><br><span class="line"></span><br><span class="line">dio，跟 Axois 差不多的东西。</span><br><span class="line"></span><br><span class="line">### card_swiper</span><br><span class="line"></span><br><span class="line">做轮播图的。</span><br><span class="line"></span><br><span class="line">```dart</span><br><span class="line">class MyPage extends StatelessWidget &#123;</span><br><span class="line">   MyPage(&#123;Key? key&#125;) : super(key: key);</span><br><span class="line">  final List&lt;String&gt; pics=[</span><br><span class="line">    &quot;images/Alice.jpg&quot;,</span><br><span class="line">    &quot;images/everyone.jpg&quot;,</span><br><span class="line">    &quot;images/dawn.jpg&quot;</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return  ListView(</span><br><span class="line">      children: [</span><br><span class="line">        Container(</span><br><span class="line">          color: Colors.black,</span><br><span class="line">          height: 300,</span><br><span class="line">          child: Swiper(</span><br><span class="line">            // itemHeight: 10,//这两个属性对于默认的轮播图布局似乎没啥用</span><br><span class="line">            // itemWidth: 10,</span><br><span class="line">            itemCount: pics.length,</span><br><span class="line">            autoplay: true,</span><br><span class="line">            pagination: SwiperPagination(),//小圆点</span><br><span class="line">            // control: SwiperControl(),//手动点击的按钮</span><br><span class="line">            viewportFraction: 0.7,</span><br><span class="line">            scale: 0.6,</span><br><span class="line">            itemBuilder: (context,index)&#123;</span><br><span class="line">              return Image.asset(pics[index],fit: BoxFit.cover,);</span><br><span class="line">            &#125;,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        Container(</span><br><span class="line">          color: Colors.black,</span><br><span class="line">          height: 300,</span><br><span class="line">          child: Swiper(</span><br><span class="line">            itemCount: pics.length,</span><br><span class="line">            pagination:const SwiperPagination(),//小圆点</span><br><span class="line">            itemWidth: 300,</span><br><span class="line">            layout: SwiperLayout.STACK,//轮播图使用stack布局的时候，itemWidth不能为空</span><br><span class="line">            itemBuilder: (context,index)&#123;</span><br><span class="line">              return Image.asset(pics[index],fit: BoxFit.cover,);</span><br><span class="line">            &#125;,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        Container(</span><br><span class="line">          color: Colors.black,</span><br><span class="line">          height: 300,</span><br><span class="line">          child: Swiper(//垂直轮播图</span><br><span class="line">            itemCount: pics.length,</span><br><span class="line">            scrollDirection: Axis.vertical,//垂直</span><br><span class="line">            pagination:const SwiperPagination(),//小圆点</span><br><span class="line">            // itemWidth: 300,</span><br><span class="line">            // layout: SwiperLayout.STACK,//垂直轮播图似乎只能用默认布局</span><br><span class="line">            itemBuilder: (context,index)&#123;</span><br><span class="line">              return Image.asset(pics[index],fit: BoxFit.cover,);</span><br><span class="line">            &#125;,</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre></li></ol><p><img src="https://img1.imgtp.com/2022/09/18/qFXxXuZW.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-列表</title>
      <link href="/2022/09/13/FlutterList.html"/>
      <url>/2022/09/13/FlutterList.html</url>
      
        <content type="html"><![CDATA[<h3 id="singlechildscrollview">SingleChildScrollView</h3><ul><li>child</li><li>padding</li><li>scrollDirection ：滚动方向，水平（Axis.horizontal）或垂直（Axis.vertical）</li><li>reverse ：是否翻转，默认第一个组件作为滚动视图的起点</li><li>physics<ul><li>ClampingScrollPhysics ：安卓的微光效果</li><li>BouncingScrollPhysics ：ios的弹性效果</li></ul></li></ul><span id="more"></span><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Stack(</span><br><span class="line">      children: [</span><br><span class="line">        SingleChildScrollView(</span><br><span class="line">          physics: <span class="keyword">const</span> BouncingScrollPhysics(),</span><br><span class="line">          child: Column(</span><br><span class="line">            children: [</span><br><span class="line">              Card(),<span class="comment">//card中代码省略</span></span><br><span class="line">              Card(),</span><br><span class="line">              Card()</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/13/jlsFe5YR.png" alt="效果图"></p><h3 id="listview">ListView</h3><p>三种构造方法，常用的子组件有 ListTile</p><ul><li>ListView( )</li><li>ListView.builder( )<ul><li>itemCount</li><li>itemExtent</li><li>itemBuilder</li></ul></li><li>ListView.separated( )<ul><li>separatorBuilder ：分割线构造器</li></ul></li></ul><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Column(</span><br><span class="line">      children: [</span><br><span class="line">        demo1(),</span><br><span class="line">        demo2(),</span><br><span class="line">        demo3()</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demo1</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//默认的ListView构造</span></span><br><span class="line">  <span class="comment">// demo1(&#123;Key? key&#125;) : super(key: key);</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; tiles=<span class="built_in">List</span>.generate(<span class="number">10</span>, (index) =&gt;  ListTile(</span><br><span class="line">    title: Text(<span class="string">&quot;tile<span class="subst">$index</span>&quot;</span>),</span><br><span class="line">    subtitle: <span class="keyword">const</span> Text(<span class="string">&quot;subtitle&quot;</span>),</span><br><span class="line">    leading: <span class="keyword">const</span> Icon(Icons.account_box,size: <span class="number">40</span>,),</span><br><span class="line">    trailing: <span class="keyword">const</span> Icon(Icons.arrow_left,size: <span class="number">40</span>,),</span><br><span class="line">  ));</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.red,</span><br><span class="line">      height: <span class="number">200</span>,</span><br><span class="line">      child: ListView(</span><br><span class="line">        scrollDirection: Axis.vertical,</span><br><span class="line">        physics: <span class="keyword">const</span> BouncingScrollPhysics(),</span><br><span class="line">        children: tiles,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demo2</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//ListView的builder构造</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; tiles=<span class="built_in">List</span>.generate(<span class="number">10</span>, (index) =&gt;  ListTile(</span><br><span class="line">    title: Text(<span class="string">&quot;tile<span class="subst">$index</span>&quot;</span>),</span><br><span class="line">    subtitle: <span class="keyword">const</span> Text(<span class="string">&quot;subtitle&quot;</span>),</span><br><span class="line">    leading: <span class="keyword">const</span> Icon(Icons.account_box,size: <span class="number">40</span>,),</span><br><span class="line">    trailing: <span class="keyword">const</span> Icon(Icons.arrow_left,size: <span class="number">40</span>,),</span><br><span class="line">  ));</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.orange,</span><br><span class="line">      height: <span class="number">200</span>,</span><br><span class="line">      child: ListView.builder(</span><br><span class="line">        itemCount: <span class="number">5</span>,<span class="comment">//指定需要多少个item，按需取得</span></span><br><span class="line">        itemExtent: <span class="number">50</span>,<span class="comment">//指定item的大小，或许是高度？固定的大小会处理的更有效。</span></span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">10</span>),</span><br><span class="line">        itemBuilder: (context,index)&#123;<span class="comment">//返回单个</span></span><br><span class="line">          <span class="keyword">return</span> tiles[index];</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demo3</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//ListView的separated构造</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; tiles=<span class="built_in">List</span>.generate(<span class="number">10</span>, (index) =&gt;  ListTile(</span><br><span class="line">    title: Text(<span class="string">&quot;tile<span class="subst">$index</span>&quot;</span>),</span><br><span class="line">    subtitle: <span class="keyword">const</span> Text(<span class="string">&quot;subtitle&quot;</span>),</span><br><span class="line">    leading: <span class="keyword">const</span> Icon(Icons.account_box,size: <span class="number">40</span>,),</span><br><span class="line">    trailing: <span class="keyword">const</span> Icon(Icons.arrow_left,size: <span class="number">40</span>,),</span><br><span class="line">  ));</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.green,</span><br><span class="line">      height: <span class="number">200</span>,</span><br><span class="line">      child: ListView.separated(</span><br><span class="line">        itemCount: tiles.length,</span><br><span class="line">        itemBuilder: (context,index)&#123;</span><br><span class="line">          <span class="keyword">return</span> tiles[index];</span><br><span class="line">        &#125;,</span><br><span class="line">        separatorBuilder: (context,index)&#123;<span class="comment">//分割线构造器</span></span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">const</span> Divider(</span><br><span class="line">            color:  Colors.red,</span><br><span class="line">            height: <span class="number">30</span>,<span class="comment">//分割线的高度，也就是两个item之间的距离</span></span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/14/bmNcz0ry.png" alt="效果图"></p><h3 id="gridview">GridView</h3><p>三种构造方法</p><ul><li>GridView（默认）<ul><li>children（子组件）</li><li>scrollDirection（滚动方向）</li><li>gridDelegate（网格代表？或许可以理解为网格的总设置）<ul><li>SliverGridDelegateWithFixedCrossAxisCount（指定列数，子组件的宽度自适应）</li><li>SliverGridDelegateWithMaxCrossAxisExtent（指定子组件交叉轴方向的大小，列数自适应）</li></ul></li><li>各轴spacing（调整子组件之间的距离）</li></ul></li><li>GridView.count（列数固定）</li><li>GridView.extend（子组件宽度固定）</li><li>GridView.builder（动态网格布局）</li></ul><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  GridView(<span class="comment">//网格列表</span></span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">10</span>),<span class="comment">//内边距</span></span><br><span class="line">      scrollDirection: Axis.vertical,<span class="comment">//垂直滚动</span></span><br><span class="line">      physics: <span class="keyword">const</span> BouncingScrollPhysics(),<span class="comment">//弹性滚动</span></span><br><span class="line">      gridDelegate: <span class="keyword">const</span> SliverGridDelegateWithFixedCrossAxisCount(<span class="comment">//固定交叉轴方向组件数量</span></span><br><span class="line">        crossAxisCount: <span class="number">2</span>,<span class="comment">//数量</span></span><br><span class="line">        mainAxisSpacing: <span class="number">10</span>,<span class="comment">//主轴方向间距</span></span><br><span class="line">        crossAxisSpacing: <span class="number">10</span>,<span class="comment">//交叉轴方向间距</span></span><br><span class="line">        <span class="comment">// mainAxisExtent: 30//子组件主轴方向的大小</span></span><br><span class="line">        childAspectRatio: <span class="number">0.5</span><span class="comment">//子组件交叉轴方向和主轴方向的大小比例</span></span><br><span class="line">      ),</span><br><span class="line">      children: [</span><br><span class="line">        Container(color: Colors.red,),</span><br><span class="line">        Container(color: Colors.black,),</span><br><span class="line">        Container(color: Colors.green,),</span><br><span class="line">        Container(color: Colors.yellow,),</span><br><span class="line">        Container(color: Colors.orange,),</span><br><span class="line">        Container(color: Colors.grey,),</span><br><span class="line">        Container(color: Colors.red,),</span><br><span class="line">        Container(color: Colors.black,),</span><br><span class="line">        Container(color: Colors.green,),</span><br><span class="line">        Container(color: Colors.yellow,),</span><br><span class="line">        Container(color: Colors.orange,),</span><br><span class="line">        Container(color: Colors.grey,)</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/18/PnvONuDb.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-图片</title>
      <link href="/2022/09/13/FlutterPicture.html"/>
      <url>/2022/09/13/FlutterPicture.html</url>
      
        <content type="html"><![CDATA[<h3 id="本地图片">本地图片</h3><ul><li>Image.asset（）<ul><li>Flutter项目目录下创建存储目录，比如images</li><li>在 pubspec.yaml 中按照注释进行规范配置</li><li>在代码中引用</li></ul></li></ul><h3 id="网络图片">网络图片</h3><ul><li>Image.network</li></ul>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Button</title>
      <link href="/2022/09/12/FlutterButton.html"/>
      <url>/2022/09/12/FlutterButton.html</url>
      
        <content type="html"><![CDATA[<h3 id="普通按钮-共同的属性见代码区">普通按钮（共同的属性见代码区）</h3><ul><li>TextButton（文本按钮）</li><li>ElevatedButton（凸起按钮）</li><li>OutlinedButton（轮廓按钮）</li></ul><h3 id="图标按钮">图标按钮</h3><ul><li>IconButton<ul><li>tooltip:长按提示</li></ul></li><li>TextButton.icon()</li><li>ElevatedButton.icon()</li><li>OutlinedButton.icon()</li></ul><span id="more"></span><h3 id="按钮组">按钮组</h3><ul><li>ButtonBar</li></ul><h3 id="浮动按钮">浮动按钮</h3><ul><li>FloatingActionButton：要放在scaffold中，与appbar和body同级</li></ul><h3 id="回退按钮">回退按钮</h3><ul><li>BackButton</li></ul><h3 id="关闭按钮">关闭按钮</h3><ul><li>CloseButton</li></ul><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Home(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: <span class="keyword">const</span> Text(<span class="string">&#x27;Work&#x27;</span>),</span><br><span class="line">        leading: <span class="keyword">const</span> Icon(Icons.menu),</span><br><span class="line">        actions: <span class="keyword">const</span>[Icon(Icons.settings)],</span><br><span class="line">      ),</span><br><span class="line">      body: <span class="keyword">const</span> MyPage(),</span><br><span class="line">      floatingActionButton: FloatingActionButton(<span class="comment">//悬浮按钮要放在Scaffold中，与appbar和body同级</span></span><br><span class="line">        tooltip: <span class="string">&quot;挖草&quot;</span>,</span><br><span class="line">        backgroundColor: Colors.orange,</span><br><span class="line">        onPressed: ()&#123;</span><br><span class="line">          <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;FloatingActionButton&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        child: <span class="keyword">const</span> Icon(Icons.live_tv),<span class="comment">//悬浮按钮中的子组件，放个icon图片</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Container(</span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">2</span>),</span><br><span class="line">      child: Wrap(</span><br><span class="line">        children: [</span><br><span class="line">          TextButton(</span><br><span class="line">            style: <span class="keyword">const</span> ButtonStyle(</span><br><span class="line">            ),</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span> (kDebugMode) &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;TextButton&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: <span class="keyword">const</span> Text(</span><br><span class="line">              <span class="string">&quot;TextButton&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                  fontSize: <span class="number">25</span></span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          ElevatedButton(</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;ElevatedButton&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: <span class="keyword">const</span> Text(<span class="string">&quot;ElevatedButton&quot;</span>),</span><br><span class="line">          ),</span><br><span class="line">          OutlinedButton(</span><br><span class="line">            style:  ButtonStyle(<span class="comment">//按钮的样式</span></span><br><span class="line">              minimumSize: MaterialStateProperty.all(<span class="keyword">const</span> Size(<span class="number">400</span>,<span class="number">40</span>)),<span class="comment">//按钮最小的尺寸，按钮通常根据内容决定尺寸，故可以设定最小尺寸来决定按钮大小</span></span><br><span class="line">              foregroundColor: MaterialStateProperty.resolveWith((states)&#123;</span><br><span class="line">                <span class="keyword">if</span>(states.contains(MaterialState.pressed))&#123;<span class="comment">//当按钮的状态处于按压时</span></span><br><span class="line">                  <span class="keyword">return</span> Colors.red;<span class="comment">//前景色给出红色</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;),</span><br><span class="line">              backgroundColor: MaterialStateProperty.all(Colors.orange),</span><br><span class="line">              side: MaterialStateProperty.all(<span class="keyword">const</span> BorderSide(</span><br><span class="line">                width: <span class="number">3</span>,</span><br><span class="line">                color: Colors.green</span><br><span class="line">              )),</span><br><span class="line">              shape: MaterialStateProperty.all(<span class="keyword">const</span> StadiumBorder()),<span class="comment">//给个形状就行了，边框的颜色和宽度由side来决定</span></span><br><span class="line">              <span class="comment">// overlayColor: MaterialStateProperty.all(Colors.brown),</span></span><br><span class="line">            ),</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span>(kDebugMode) &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;OutlinedButton&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: <span class="keyword">const</span> Text(</span><br><span class="line">                <span class="string">&quot;OutlinedButton&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  color: Colors.white</span><br><span class="line">                ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          IconButton(</span><br><span class="line">            tooltip: <span class="string">&quot;小辣鸡&quot;</span>,<span class="comment">//长按提示</span></span><br><span class="line">              onPressed: ()&#123;</span><br><span class="line">                <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">                  <span class="built_in">print</span>(<span class="string">&quot;IconButton&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              icon: <span class="keyword">const</span> Icon(Icons.favorite,color: Colors.red,)</span><br><span class="line">          ),</span><br><span class="line">          TextButton.icon(</span><br><span class="line">              onPressed: ()&#123;</span><br><span class="line">                <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">                  <span class="built_in">print</span>(<span class="string">&quot;TextButton.icon&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              icon: <span class="keyword">const</span> Icon(Icons.person),</span><br><span class="line">              label: <span class="keyword">const</span> Text(<span class="string">&quot;Khvia&quot;</span>)),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/13/FTl5CnY0.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter交互实践</title>
      <link href="/2022/09/11/Flutter-test2.html"/>
      <url>/2022/09/11/Flutter-test2.html</url>
      
        <content type="html"><![CDATA[<h3 id="效果图">效果图</h3><p><img src="https://img1.imgtp.com/2022/09/11/6uhrySvk.png" alt="image-20220911202033301"></p><span id="more"></span><h3 id="代码实现">代码实现</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  Widget titleSection = Container(<span class="comment">//自定义组件，标题部分，即头部部分</span></span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">32</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行</span></span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Expanded(<span class="comment">//第一列，标题和副标题</span></span><br><span class="line">          child: Column(<span class="comment">//第一列有两行</span></span><br><span class="line">            crossAxisAlignment: CrossAxisAlignment.start,<span class="comment">//交叉轴方向，此处即水平方向对齐方式，在起点处对齐，即左对齐</span></span><br><span class="line">            children: [</span><br><span class="line">              <span class="keyword">const</span> Text(<span class="comment">//第一行</span></span><br><span class="line">                <span class="string">&quot;Hello,this is Alice!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  fontWeight: FontWeight.bold,<span class="comment">//加粗，表明主体</span></span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              Text(<span class="comment">//第二行</span></span><br><span class="line">                <span class="string">&quot;Good evening!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  color: Colors.grey[<span class="number">500</span>],<span class="comment">//灰色</span></span><br><span class="line">                ),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">const</span> LikeWidget(),<span class="comment">//这是下面写的自定义有状态组件</span></span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget options=Container(<span class="comment">//自定义组件，操作栏部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行三列</span></span><br><span class="line">      mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Column(<span class="comment">//第一列，图标加文字描述，下同</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.call,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;CALL&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第二列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.route,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;ROUTE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第三列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.share,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;SHARE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget text=Container(<span class="comment">//自定义组件，文本区域部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">30</span>),<span class="comment">//内边距30，即四周留空</span></span><br><span class="line">    child: <span class="keyword">const</span> Text(</span><br><span class="line">      <span class="string">&quot;Something exciting happened when I got up this day. Maybe, but I am not sure about the time.&quot;</span></span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Column(</span><br><span class="line">      children: [</span><br><span class="line">        Image.asset(<span class="comment">//预设图片</span></span><br><span class="line">          <span class="string">&#x27;images/Alice.jpg&#x27;</span>,</span><br><span class="line">          <span class="comment">// width: 100,</span></span><br><span class="line">          height: <span class="number">300</span>,</span><br><span class="line">          fit: BoxFit.cover,<span class="comment">//填充方式，覆盖。</span></span><br><span class="line">        ),</span><br><span class="line">        titleSection,</span><br><span class="line">        options,</span><br><span class="line">        text</span><br><span class="line">      ],</span><br><span class="line">    ) ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LikeWidget</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;<span class="comment">//这个是有状态组件的显示部分</span></span><br><span class="line">  <span class="keyword">const</span> LikeWidget(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;LikeWidget&gt; createState() =&gt; _LikeWidgetState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_LikeWidgetState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">LikeWidget</span>&gt; </span>&#123;<span class="comment">//这个是有状态组件的状态部分</span></span><br><span class="line">  <span class="built_in">bool</span> _like=<span class="keyword">true</span>;</span><br><span class="line">  <span class="built_in">int</span> _count=<span class="number">41</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _clickLike()&#123;</span><br><span class="line">    setState(() &#123;<span class="comment">//有状态组件通过执行setState（）执行组件的重新渲染，传入的参数是一个自定义函数</span></span><br><span class="line">      <span class="keyword">if</span>(_like)&#123;</span><br><span class="line">        _like=<span class="keyword">false</span>;</span><br><span class="line">        _count--;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        _like=<span class="keyword">true</span>;</span><br><span class="line">        _count++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;<span class="comment">//写组件的内容，该咋写咋写，值换动态的就行了</span></span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      children: [</span><br><span class="line">        IconButton(</span><br><span class="line">          icon: _like?<span class="keyword">const</span> Icon(Icons.star,color: Colors.red,):<span class="keyword">const</span> Icon(Icons.star_border,color: Colors.red,),</span><br><span class="line">          onPressed: _clickLike,</span><br><span class="line">        ),</span><br><span class="line">        Text(</span><br><span class="line">          <span class="string">&quot;<span class="subst">$_count</span>&quot;</span></span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结">总结</h3><ul><li>无状态组件自身无法改变，根据我的理解，它是那种事先就决定好的内容，无法在程序运行时做更改，比如Text，Icon，IconButton</li><li>有状态组件自身可以更改，通过提前设定状态量，就可以在用户交互的时候，改变状态量，重新渲染组件，比如CheckBox，Radio</li><li>有状态组件的显示部分和状态部分是分开的，build在状态部分中</li><li>有状态组件通过setState（）函数来重新渲染组件</li></ul>]]></content>
      
      
      <categories>
          
          <category> 实践 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter布局实践</title>
      <link href="/2022/09/11/Flutter-test1.html"/>
      <url>/2022/09/11/Flutter-test1.html</url>
      
        <content type="html"><![CDATA[<h3 id="效果图">效果图</h3><p><img src="https://img1.imgtp.com/2022/09/11/6moImF8u.png" alt="效果图"></p><span id="more"></span><h3 id="代码实现">代码实现</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  Widget titleSection = Container(<span class="comment">//自定义组件，标题部分，即头部部分</span></span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">32</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行</span></span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Expanded(<span class="comment">//第一列，标题和副标题</span></span><br><span class="line">          child: Column(<span class="comment">//第一列有两行</span></span><br><span class="line">            crossAxisAlignment: CrossAxisAlignment.start,<span class="comment">//交叉轴方向，此处即水平方向对齐方式，在起点处对齐，即左对齐</span></span><br><span class="line">            children: [</span><br><span class="line">              <span class="keyword">const</span> Text(<span class="comment">//第一行</span></span><br><span class="line">                <span class="string">&quot;Hello,this is Alice!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  fontWeight: FontWeight.bold,<span class="comment">//加粗，表明主体</span></span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              Text(<span class="comment">//第二行</span></span><br><span class="line">                <span class="string">&quot;Good evening!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  color: Colors.grey[<span class="number">500</span>],<span class="comment">//灰色</span></span><br><span class="line">                ),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">const</span> Icon(<span class="comment">//第二列，收藏图标</span></span><br><span class="line">          Icons.star,</span><br><span class="line">          color: Colors.red,</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">const</span> Text(<span class="comment">//第三列，收藏数</span></span><br><span class="line">          <span class="string">&quot;520&quot;</span>,</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget options=Container(<span class="comment">//自定义组件，操作栏部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行三列</span></span><br><span class="line">      mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Column(<span class="comment">//第一列，图标加文字描述，下同</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.call,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;CALL&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第二列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.route,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;ROUTE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第三列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.share,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;SHARE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget text=Container(<span class="comment">//自定义组件，文本区域部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">30</span>),<span class="comment">//内边距30，即四周留空</span></span><br><span class="line">    child: <span class="keyword">const</span> Text(</span><br><span class="line">      <span class="string">&quot;Something exciting happened when I got up this day. Maybe, but I am not sure about the time.&quot;</span></span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Column(</span><br><span class="line">      children: [</span><br><span class="line">        Image.asset(<span class="comment">//预设图片</span></span><br><span class="line">          <span class="string">&#x27;images/Alice.jpg&#x27;</span>,</span><br><span class="line">          <span class="comment">// width: 100,</span></span><br><span class="line">          height: <span class="number">300</span>,</span><br><span class="line">          fit: BoxFit.cover,<span class="comment">//填充方式，覆盖。</span></span><br><span class="line">        ),</span><br><span class="line">        titleSection,</span><br><span class="line">        options,</span><br><span class="line">        text</span><br><span class="line">      ],</span><br><span class="line">    ) ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结">总结</h3><ul><li>Flutter 的布局用熟悉了感觉很舒服</li><li>使用预设图片需要存放在项目的images文件夹中，然后在 pubsepc.yaml 中进行相关的设置。最后在代码中用<code>Image.asset</code>进行引用</li><li>布局前要好好思考才是</li></ul>]]></content>
      
      
      <categories>
          
          <category> 实践 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自动连接校园网（三峡大学）</title>
      <link href="/2022/09/09/AutoConnectCTGUweb.html"/>
      <url>/2022/09/09/AutoConnectCTGUweb.html</url>
      
        <content type="html"><![CDATA[<h3 id="代码实现">代码实现</h3><p>一切参数内容由抓包获得。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 三大校园网登录地址</span></span><br><span class="line">url = <span class="string">&#x27;http://10.170.1.2:9090/zportal/login/do&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 三大校园网是表单提交</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="comment">#校园网账号</span></span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&#x27;xxxxxxxxxx&#x27;</span>,</span><br><span class="line">    <span class="comment">#密码</span></span><br><span class="line">    <span class="string">&quot;pwd&quot;</span>: <span class="string">&#x27;xxxxxx&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;validCode&quot;</span>: <span class="string">&quot;验证码&quot;</span>,</span><br><span class="line">    <span class="string">&quot;validCodeFlag&quot;</span>: <span class="string">&quot;false&quot;</span>,</span><br><span class="line">    <span class="comment"># &quot;ssid&quot;: &quot;c24e36c874328833576d4435928a84c5&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;mac&quot;: &quot;c087135cd61a85a7cf6c99c7315776e0&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;t&quot;: &quot;wireless-v2&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;wlanacname&quot;: &quot;b0e16546b46125bff4a79cfb309fda7f&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;url&quot;: &quot;416bc8fc444bf6a0acf42dbf654ac97bb8da2acbab589e29d1bbccb6c3dd8740a89fd1d25528f66848d484798c2c5e4b&quot;,</span></span><br><span class="line">    <span class="string">&quot;nasip&quot;</span>: <span class="string">&quot;aa97548fee0077ad407c5fe8d3a7645b&quot;</span>,</span><br><span class="line">    <span class="comment"># nasip是web认证接入设备,不可省略</span></span><br><span class="line">    <span class="string">&quot;wlanuserip&quot;</span>: <span class="string">&quot;48d7f194ecf5eec0d07b001069ded8e7&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 请求登录的请求头</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Length&quot;</span>: <span class="string">&quot;461&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;10.170.1.2:9090&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://10.170.1.2:9090&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://10.170.1.2:9090/zportal/loginForWeb?wlanuserip=48d7f194ecf5eec0d07b001069ded8e7&amp;wlanacname=b0e16546b46125bff4a79cfb309fda7f&amp;ssid=c24e36c874328833576d4435928a84c5&amp;nasip=aa97548fee0077ad407c5fe8d3a7645b&amp;snmpagentip=&amp;mac=c087135cd61a85a7cf6c99c7315776e0&amp;t=wireless-v2&amp;url=416bc8fc444bf6a0acf42dbf654ac97bb8da2acbab589e29d1bbccb6c3dd8740a89fd1d25528f66848d484798c2c5e4b&amp;apmac=&amp;nasid=b0e16546b46125bff4a79cfb309fda7f&amp;vid=b02b05371bcbc4cb&amp;port=3f21ae5e15ce190e&amp;nasportid=b9d2866090de456862a975341d6574397ab2778f3751241f5ea58c9d8660fa0d52aff7761e572a00&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">    <span class="string">&quot;X-Requested-With&quot;</span>: <span class="string">&quot;XMLHttpRequest&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 查看结果</span></span><br><span class="line">response = requests.post(url, data, headers=header)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;请求结果:&quot;</span>, response.text)</span><br></pre></td></tr></table></figure><blockquote><p>参考博客：<a href="https://blog.csdn.net/winter2121/article/details/122633696">开机自动登录校园网（西安电子科技大学）</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 小工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Card</title>
      <link href="/2022/09/09/FlutterCard.html"/>
      <url>/2022/09/09/FlutterCard.html</url>
      
        <content type="html"><![CDATA[<h3 id="widget-card">Widget—Card</h3><ul><li>child 子组件</li><li>color 背景色</li><li>shadowColor 阴影色</li><li>elevation 阴影高度</li><li>shape 边框样式（可以用RoundedRectangleBorder来设置，意为圆角矩形边框）</li><li>margin 外边距</li></ul><h3 id="widget-listtile">Widget—ListTile</h3><ul><li>leading 头部组件</li><li>title 标题</li><li>subtitle 副标题</li></ul><span id="more"></span><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Column(</span><br><span class="line">      children:  [</span><br><span class="line">        Card(</span><br><span class="line">          margin: <span class="keyword">const</span> EdgeInsets.all(<span class="number">30</span>),<span class="comment">//外边距</span></span><br><span class="line">          shadowColor: Colors.black,<span class="comment">//阴影颜色</span></span><br><span class="line">          elevation: <span class="number">20</span>,<span class="comment">//阴影高度</span></span><br><span class="line">          shape:  <span class="keyword">const</span> RoundedRectangleBorder(<span class="comment">//圆角矩形边框</span></span><br><span class="line">            borderRadius: BorderRadius.all(Radius.circular(<span class="number">10</span>)),<span class="comment">//圆弧</span></span><br><span class="line">            side: BorderSide(color: Colors.lightBlueAccent)<span class="comment">//边，亮色蓝</span></span><br><span class="line">          ),</span><br><span class="line">          child: Column(<span class="comment">//card的子组件，描述信息，多个子组件用Column来包含</span></span><br><span class="line">            children: <span class="keyword">const</span> [</span><br><span class="line">              ListTile(</span><br><span class="line">                leading: CircleAvatar(<span class="comment">//leading，头部信息，用圆角头像</span></span><br><span class="line">                  radius: <span class="number">30</span>,<span class="comment">//大小</span></span><br><span class="line">                  backgroundImage: NetworkImage(<span class="string">&#x27;https://img1.imgtp.com/2022/08/23/HgJi7gyB.JPG&#x27;</span>),<span class="comment">//地址</span></span><br><span class="line">                ),</span><br><span class="line">                title: Text(<span class="string">&#x27;Kahvia!&#x27;</span>),<span class="comment">//标题，这里指人名</span></span><br><span class="line">                subtitle: Text(<span class="string">&#x27;三峡大学&#x27;</span>),<span class="comment">//副标题，这里指学校</span></span><br><span class="line">              ),</span><br><span class="line">              Divider(<span class="comment">//分割线</span></span><br><span class="line">                color: Colors.grey,</span><br><span class="line">              ),</span><br><span class="line">              ListTile(<span class="comment">//信息1，其实不用这个组件也行的</span></span><br><span class="line">                title: Text(<span class="string">&#x27;联系方式：1313131313&#x27;</span>),</span><br><span class="line">              ),</span><br><span class="line">              ListTile(<span class="comment">//信息2</span></span><br><span class="line">                title: Text(<span class="string">&#x27;QQ：914302063&#x27;</span>),</span><br><span class="line">              ),</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/09/I9GO3Qyt.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-层叠布局</title>
      <link href="/2022/09/07/FlutterStack.html"/>
      <url>/2022/09/07/FlutterStack.html</url>
      
        <content type="html"><![CDATA[<h3 id="widget-stack">Widget—Stack</h3><ul><li><p>Stack（层叠组件，类似css中的z-index）</p><ul><li>alignment（声明未定位的子组件的对齐方式）</li><li>textDirection（声明未定位的子组件的排列顺序）</li><li>未定位组件也会进行重叠</li></ul><span id="more"></span><ul><li>Stack的最小容器大小会包含所有的未定位组件的容器大小。若是stack外层容器没有设置大小，则容器大小为最小容器大小</li></ul><p><img src="https://img1.imgtp.com/2022/09/08/yCkagei1.png" alt="image-20220908171102819"></p><ul><li>若是外层容器有设置大小，则stack大小为外层容器大小（蓝色为外层容器大小，红色为未定位容器大小）</li></ul><p><img src="https://img1.imgtp.com/2022/09/08/ImckUH47.png" alt="image-20220908171621720"></p><ul><li>如果未定位组件不设置容器大小，外层容器也不设置大小，则填充整个屏幕（没有红色是因为这次我设了透明）</li></ul><p><img src="https://img1.imgtp.com/2022/09/08/AeSr8bG6.png" alt="image-20220908170753793"></p></li><li><p>Positioned（绝对定位组件）</p><ul><li>child（声明子组件）</li><li>left，top，right，bottom</li><li>width，height</li></ul></li><li><p>NetworkImage（网络图片组件）</p><ul><li>NetworkImage（‘图片地址’）</li><li>在 AndroidManifest.xml 文件中添加<code>&lt;use-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;</code></li></ul></li></ul><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Container(</span><br><span class="line">      width: <span class="number">400</span>,</span><br><span class="line">      height: <span class="number">400</span>,</span><br><span class="line">      color: Colors.orange,</span><br><span class="line">      child:Container(</span><br><span class="line">        color: Colors.lightBlueAccent,</span><br><span class="line">        child:  Stack(<span class="comment">//按顺序进行渲染，先渲染的组件在下面，后渲染的在上面，我指的是垂直屏幕方向。</span></span><br><span class="line">          alignment: AlignmentDirectional.bottomCenter,<span class="comment">//未定位组件的对齐方式，底部居中</span></span><br><span class="line">          textDirection: TextDirection.rtl,<span class="comment">//未定位组件的排列顺序，从右到左，这会决定alignment对齐的起点和终点</span></span><br><span class="line">          children:   [</span><br><span class="line">            Container(</span><br><span class="line">              color: Colors.red,<span class="comment">//红色</span></span><br><span class="line">              width: <span class="number">250</span>,</span><br><span class="line">              height: <span class="number">250</span>,</span><br><span class="line">            ),</span><br><span class="line">            Container(</span><br><span class="line">              color: Colors.yellowAccent,<span class="comment">//黄色</span></span><br><span class="line">              width: <span class="number">200</span>,</span><br><span class="line">              height: <span class="number">200</span>,</span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">const</span> Positioned(</span><br><span class="line">                top: <span class="number">40</span>,<span class="comment">//距离stack容器顶部40单位处</span></span><br><span class="line">                left: <span class="number">60</span>,<span class="comment">//距离stack容器左边60单位处</span></span><br><span class="line">                child: CircleAvatar(<span class="comment">//圆形头像，在流式布局中有提及</span></span><br><span class="line">                  backgroundImage: NetworkImage(<span class="string">&#x27;https://img1.imgtp.com/2022/09/03/svQ5krdh.jpg&#x27;</span>),</span><br><span class="line">                  radius: <span class="number">50</span>,<span class="comment">//圆的半径</span></span><br><span class="line">                )</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/08/Kb7B9qig.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-流式布局</title>
      <link href="/2022/09/06/FlutterWrap.html"/>
      <url>/2022/09/06/FlutterWrap.html</url>
      
        <content type="html"><![CDATA[<h3 id="widget-wrap">Widget—Wrap</h3><p>Wrap（解决内容溢出）：在flutter中，默认不是流式布局，内容溢出不会自动换行，需要使用流式布局来进行自动换行。</p><ul><li>spacing（主轴方向子组件之间的间距）</li><li>alignment（主轴方向的对齐方式）</li><li>runSpacing（纵轴方向子组件的间距）</li><li>runAlignment（纵轴方向的对齐方式）</li></ul><p>Chip（标签）</p><p>CircleAvatar（圆形的“化身”）（圆形头像）</p><span id="more"></span><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Column(</span><br><span class="line">      mainAxisAlignment: MainAxisAlignment.spaceBetween,</span><br><span class="line">      children: [</span><br><span class="line">        Row(<span class="comment">//在线性布局中，不会自动换行，内容超出会报错</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&#x27;hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh&#x27;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                fontSize: <span class="number">40</span></span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Wrap(<span class="comment">//流式布局就换行了，莫得问题</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&#x27;hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh&#x27;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                  fontSize: <span class="number">40</span>,</span><br><span class="line">                  color: Colors.red</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/06/117HUTKP.png" alt="image-20220906210846453"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-弹性布局</title>
      <link href="/2022/09/06/FlutterFlex.html"/>
      <url>/2022/09/06/FlutterFlex.html</url>
      
        <content type="html"><![CDATA[<h3 id="widget-flex">Widget—Flex</h3><p>Flex</p><ul><li>direction(主轴方向)</li><li>mainAxisAlignment（主轴对齐方式）</li><li>crossAxisAlignment（交叉轴对齐方式）</li><li>textDirection（水平方向上的排列顺序）</li><li>verticalDirection（垂直方向上的排列顺序）</li><li>children（子组件）</li></ul><p>Expended（可伸缩组件，放在弹性布局组件中）</p><ul><li>flex（声明弹性布局所占比例）</li><li>child（子组件）</li></ul><span id="more"></span><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Flex(</span><br><span class="line">      direction: Axis.horizontal,<span class="comment">//主轴方向为水平</span></span><br><span class="line">      textDirection: TextDirection.rtl,<span class="comment">//内容方向从右往左排列，故设置的图标在右，溜冰鞋在左</span></span><br><span class="line">      crossAxisAlignment: CrossAxisAlignment.start,<span class="comment">//交叉轴对齐方式是从起点开始对齐，这里起点就是垂直方向的上边缘吧</span></span><br><span class="line">      children:  [</span><br><span class="line">        Expanded(</span><br><span class="line">          flex: <span class="number">2</span>,<span class="comment">//这个部分的组件占两份</span></span><br><span class="line">          child: Container(</span><br><span class="line">            color: Colors.orange,<span class="comment">//橘色</span></span><br><span class="line">            height: <span class="number">60</span>,</span><br><span class="line">            child: <span class="keyword">const</span> Icon(Icons.settings,size: <span class="number">40</span>,),<span class="comment">//图标：设置</span></span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        Expanded(</span><br><span class="line">          flex: <span class="number">1</span>,<span class="comment">//这个部分的组件占一份</span></span><br><span class="line">          child: Container(</span><br><span class="line">            color: Colors.lightBlue,<span class="comment">//亮蓝色</span></span><br><span class="line">            height: <span class="number">40</span>,</span><br><span class="line">            child: <span class="keyword">const</span> Icon(Icons.ice_skating,size: <span class="number">40</span>,),<span class="comment">//图标：溜冰鞋</span></span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/06/VMjYtNO4.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-线性布局</title>
      <link href="/2022/09/05/ColumAndRow.html"/>
      <url>/2022/09/05/ColumAndRow.html</url>
      
        <content type="html"><![CDATA[<h3 id="widget-column">Widget—Column</h3><ul><li>Column中主轴方向是垂直方向</li><li>mainAxisAlignment设置主轴对齐方式</li><li>crossAxisAlignment设置交叉轴对齐方式</li><li>children设置内容</li></ul><h3 id="widget-row">Widget—Row</h3><p>主轴方向为水平方向，其余属性一致</p><span id="more"></span><h3 id="代码区">代码区</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Center(<span class="comment">//居中组件,当没有指定widthFactor和heightFactor的时候，会尽可能的大</span></span><br><span class="line">      child: Container(<span class="comment">//用有颜色属性的Container包裹部件，加上背景色，方便识别</span></span><br><span class="line">        color: Colors.orange,<span class="comment">//橘色为大部件</span></span><br><span class="line">        child: Column(<span class="comment">//包含了一个线性布局的大部件</span></span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.spaceEvenly,<span class="comment">//部件之间的距离，与部件和边框的距离，相等</span></span><br><span class="line">          crossAxisAlignment: CrossAxisAlignment.center,<span class="comment">//因为外面有Center部件包裹了，所以这里写不写都一样的居中效果。</span></span><br><span class="line">          children:  [<span class="comment">//以下四个Container是线性布局中的四个小部件</span></span><br><span class="line">            Container(</span><br><span class="line">              color: Colors.white,</span><br><span class="line">              child: <span class="keyword">const</span> Icon(Icons.settings,size: <span class="number">50</span>,),</span><br><span class="line">            ),</span><br><span class="line">             Container(</span><br><span class="line">              color: Colors.red,</span><br><span class="line">              child: <span class="keyword">const</span> Icon(Icons.access_alarm,size: <span class="number">50</span>,),</span><br><span class="line">            ),</span><br><span class="line">            Container(</span><br><span class="line">              color: Colors.blueAccent,</span><br><span class="line">              child: <span class="keyword">const</span> Icon(Icons.account_box,size: <span class="number">50</span>,),</span><br><span class="line">            ),</span><br><span class="line">            Container(<span class="comment">//这个部件是Row布局部件，其中的小部件水平排列，即一行里面分列展示</span></span><br><span class="line">              color: Colors.grey,<span class="comment">//灰色区域，Row布局自然是一行灰色了</span></span><br><span class="line">              child: Row(</span><br><span class="line">                mainAxisAlignment: MainAxisAlignment.spaceAround,<span class="comment">//部件之间的距离，与部件和边框的距离，是二比一的关系</span></span><br><span class="line">                children: <span class="keyword">const</span> [</span><br><span class="line">                  Icon(Icons.settings,size: <span class="number">50</span>,),</span><br><span class="line">                  Icon(Icons.access_alarm,size: <span class="number">50</span>,),</span><br><span class="line">                  Icon(Icons.account_box,size: <span class="number">50</span>,),</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/05/tLu0Raxd.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>读 Unix Time Sharing System 有感</title>
      <link href="/2022/09/04/UnixTtimeSharingSystem.html"/>
      <url>/2022/09/04/UnixTtimeSharingSystem.html</url>
      
        <content type="html"><![CDATA[<h3 id="文件系统包含三种文件">文件系统包含三种文件</h3><ol><li>普通文件：程序控制的文件</li><li>目录文件：目录提供了文件名称和文件本身之间的映射</li><li>特殊文件：I/O相关文件</li></ol><span id="more"></span><h4 id="普通文件">普通文件</h4><p>由应用程序控制。从Windows操作系统来看，就类似于word文档这个程序生成了以.doc为后缀的文件。这种文件想要被正确地读取也需要应用程序来操作。</p><h4 id="目录文件">目录文件</h4><ul><li>简单地理解，目录是一种文件，这种文件记录了其它文件的“家”。这种记录至少包含两个，一个是目录本身，一个是它的父目录。通过父目录来返回上一级，通过目录本身来访问该目录下的文件。</li><li>根据原论文，“相同的非目录文件可能出现在多个目录中，名称可能不同，这个特性被称为链接。”或许我们可以理解为windows的快捷方式？</li></ul><blockquote><p>The same nondirectory file may appear in severaldirectories under possibly different names. This feature is called linking; a directory entry for a file is sometimes called a link.</p></blockquote><h4 id="特殊文件">特殊文件</h4><p>与输入输出设备（I/O）有关的文件。对它的读写请求会激活相关的设备。</p><blockquote><p>好吧，这篇论文太难了，对于我来说实在是难以看懂。能理解的差不多就上面那些。</p><p>参考文献：<a href="http://www.lib.ctgu.edu.cn/asset/detail/0/203156716660">《Unix Time Sharing System》</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unix </tag>
            
            <tag> 操作系统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图床测试</title>
      <link href="/2022/09/03/tt.html"/>
      <url>/2022/09/03/tt.html</url>
      
        <content type="html"><![CDATA[<h3 id="图床测试">图床测试</h3><p>github</p><p><img src="https://cdn.jsdelivr.net/gh/kahvia-d/imgs/kahviablog/image-20220903210223638.png" alt="image-20220903210223638"></p><p>smms</p><p><img src="https://img1.imgtp.com/2022/09/03/xiHwP629.png" alt="image-20220903211936956"></p><p>imgTP</p><p><img src="https://img1.imgtp.com/2022/09/03/svQ5krdh.jpg" alt="everyone"></p>]]></content>
      
      
      <categories>
          
          <category> 测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Layout</title>
      <link href="/2022/09/03/Flutter-Layout.html"/>
      <url>/2022/09/03/Flutter-Layout.html</url>
      
        <content type="html"><![CDATA[<h3 id="container">Container</h3><ul><li><p>child(子组件)</p></li><li><p>padding(margin)</p><ul><li>EdgeInsets. ( all( ),fromLTRB( ),only( ) )</li></ul></li><li><p>decoration</p><ul><li>BoxDecoration(边框、圆角、渐变、阴影、背景色、背景图片)</li></ul></li><li><p>alignment</p><ul><li>Alignment(内容对齐)</li></ul></li><li><p>transform</p><ul><li>Matrix4（平移-translate、旋转rotate、缩放-scale、斜切、skew）</li></ul></li><li><p>Container没有子组件的时候会尽可能大，但是如果Container的父组件有传递一个无限大（无边界）的约束给它，那Container就会尽可能小。</p></li></ul><span id="more"></span><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Center(<span class="comment">//居中组件</span></span><br><span class="line">      child: Container(</span><br><span class="line">        width: <span class="number">100</span>,</span><br><span class="line">        height: <span class="number">100</span>,</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">2</span>),</span><br><span class="line">        <span class="comment">// color: Colors.red, //不能同时使用color和decoration，想都用的话，color只能在decoration里面使用</span></span><br><span class="line">        alignment: Alignment.center, <span class="comment">//容器内容居中</span></span><br><span class="line">        <span class="comment">// transform: Matrix4.rotationZ(2),//旋转，X是竖直方向，Y是水平方向，Z是垂直屏幕方向</span></span><br><span class="line">        decoration: <span class="keyword">const</span> BoxDecoration(</span><br><span class="line">          color: Colors.amber,</span><br><span class="line">          borderRadius: BorderRadius.all(Radius.circular(<span class="number">20.0</span>))</span><br><span class="line">        ),</span><br><span class="line">        child: <span class="keyword">const</span> Text(</span><br><span class="line">          <span class="string">&#x27;Hello Kahvia !&#x27;</span></span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/03/PqlAbOMI.png" alt="效果如图所示" title="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xxx</title>
      <link href="/2022/09/03/FlutterColor.html"/>
      <url>/2022/09/03/FlutterColor.html</url>
      
        <content type="html"><![CDATA[<h3 id="color">Color</h3><ul><li>Color<ul><li>Color(0xFF42A5F5)</li><li>Color.fromARGB(x,y,z,f)</li><li>Color.fromRGBO(255,255,255,1.0)      //Opacity</li></ul></li><li>Colors(通过单词声明)<ul><li>如Colors.red</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> xxx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Icon</title>
      <link href="/2022/09/03/Icon.html"/>
      <url>/2022/09/03/Icon.html</url>
      
        <content type="html"><![CDATA[<h3 id="icon">Icon</h3><p>Icon是Flutter的图标库，使用方法Icon(Icons.icoName)<br>预览官网：<a href="https://material-io.cn/resources">https://material-io.cn/resources</a></p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter-Text</title>
      <link href="/2022/09/03/Flutter-Text.html"/>
      <url>/2022/09/03/Flutter-Text.html</url>
      
        <content type="html"><![CDATA[<h3 id="flutter-text">Flutter-Text</h3><ul><li>Text<ul><li>TextDirection(文本方向)</li><li>TextStyle(文本样式)<ul><li>Clolors</li><li>FontWeight</li><li>FontStyle</li><li>TextDecoration(文本修饰：删除线等)</li></ul></li><li>TextAlign</li><li>TextOverflow</li><li>maxLines</li></ul></li><li>RichText和TextSpan    给文本生成多种样式</li></ul><span id="more"></span><h3 id="自定义字体">自定义字体</h3><ol><li>在<a href="fonts.google.com">https://fonts.google.com/</a>下载</li><li>将解压后的字体文件夹放到项目下的fonts文件夹中</li><li>在pubspec.yaml中按注释示例进行配置</li><li>在全局层面设置字体：在MaterialApp中配置theme : ThemeData(fontFamily: ‘xxx’);</li><li>局部设置：在Text的style中设置fontFamily : ‘xxx’</li></ol>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dart数据类型</title>
      <link href="/2022/08/31/dart2.html"/>
      <url>/2022/08/31/dart2.html</url>
      
        <content type="html"><![CDATA[<p>这个笔记写下了Dart语言中一些常见的数据类型。</p><span id="more"></span><h3 id="number">Number</h3><ul><li>Dart的数字有三个关键字<ul><li>num(整数或小数)</li><li>int表示整数，声明变量时就不能输入浮点数，不然会报错。</li><li>double表示浮点数，即便声明变量时给的是整数，输出也是3.0之类。</li></ul></li></ul><p>一些少见的类型转换</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">double</span> a=<span class="number">3.14159</span>;</span><br><span class="line"><span class="built_in">double</span> b；</span><br><span class="line">b=a.round();<span class="comment">//保留整数的四舍五入</span></span><br><span class="line">b=a.toStringAsFixed(<span class="number">4</span>);<span class="comment">//保留四位小数的四舍五入</span></span><br></pre></td></tr></table></figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> a=<span class="number">10</span>;</span><br><span class="line"><span class="built_in">double</span> b;</span><br><span class="line">b=a.compareTo(<span class="number">10</span>);<span class="comment">//b为0则相同，1大于，-1小于</span></span><br><span class="line">b=a.remainder(<span class="number">4</span>);<span class="comment">//结果为a除以4的余数</span></span><br><span class="line">b=a.gcd(<span class="number">19</span>);<span class="comment">//结果为a和19的最大公约数</span></span><br></pre></td></tr></table></figure><h3 id="string">String</h3><ul><li>声明字符串<ul><li>单引号、双引号</li><li>三个引号可声明带换行符的字符串</li></ul></li><li>正则表达式<ul><li>RegExp(r’正则表达式’)</li></ul></li><li>常见API<ul><li>replaceAll(str1,str2);  支持正则替换，即str1可以用正则表达式</li><li>isEmpty</li><li>isNotEmpty</li><li>contains(str)  查找字符串</li><li>indexOf(str) 定位字符串</li></ul></li></ul><h3 id="boolean">Boolean</h3><ul><li>关键字为bool</li><li>值只有true和false</li><li>使用变量进行条件语句的判断时，尽量使用显式的判断，如if(a==0)，而不是if(!a),因为dart中，变量的值不会进行隐式转换。</li></ul><h3 id="list">List</h3><ul><li>Dart中的数组，由List对象表示。有两种声明方式。<ul><li>字面量方式<ul><li><code>List list=[] //不限数据类型</code></li><li><code>List list=&lt;int&gt;[] //指定数据类型</code></li></ul></li><li>构造函数方式<ul><li><code> List list=new List.empty(growable:true)//不限制长度的空列表</code></li><li><code> List list=new List.filled(3,0)//前一个参数指定长度，后一个指定填充值，这里创建出来为[0,0,0]</code></li></ul></li></ul></li><li>常见API<ul><li>addAll([x,y,…,z ])</li><li>remove(element)</li><li>removeAt(int i)  删除指定下标的元素</li><li>insert(index,element) 在指定下标的位置添加元素</li><li>clear( )  清空</li><li>join(str) 将列表中的元素用str连接合并起来</li></ul></li><li>遍历List<ul><li>forEach()</li><li>map()<ul><li>var newList=nums.map((e) {<br>return e*e;<br>});</li></ul></li><li>where()  返回包含满足要求的元素的新列表</li><li>any()  有一个元素满足要求就返回true</li><li>every() 都满足要求才返回true</li></ul></li></ul><h3 id="set">Set</h3><ul><li>set是无序的，元素唯一的集合</li><li>set同样有字面量和构造函数两种声明方式，字面量用大括号{ }</li><li>对List变量使用toSet( )方法，将重复元素去除</li><li>交集：map1.intersection(map2)</li><li>并集：map1.union(map2)</li><li>差集：map1.difference(map2)</li><li>第一个元素：map1.first</li><li>最后一个元素：map1.last</li></ul><h3 id="map">Map</h3><ul><li>Map是无序的键值对映射。又称哈希或字典。</li><li>声明方式<ul><li>var map={key1:value1,…};</li><li>var map=new Map( );</li><li>map[‘key’]=value;</li></ul></li><li>常用API<ul><li>map1.containsKey(str)     判断key存在与否</li><li>map1.putIfAbsent(key,( )-&gt;value )    key不存在则赋值</li><li>map1.keys</li><li>map1.values</li><li>map1.removeWhere( )    按条件删除</li></ul></li></ul><h3 id="其它数据类型">其它数据类型</h3><ul><li>Runes （符文）    Runes对象是一个32位的字符对象。可以把文字转换成符号表情或者特定的文字。<a href="https://copychar.cc/">CopyChar</a></li><li>Symbol    在Dart中用#开头来表示的标识符</li><li>dynamic    动态数据类型</li></ul>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dart </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dart入门</title>
      <link href="/2022/08/31/dart1.html"/>
      <url>/2022/08/31/dart1.html</url>
      
        <content type="html"><![CDATA[<p>这里是Dart的小小语法基础。</p><span id="more"></span><h3 id="语法基础">语法基础</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> fun1(<span class="built_in">int</span> age)&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;this is <span class="subst">$age</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">    fun1(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在js中声明函数使用function，而dart中则不用。更贴近c语言的函数形式。</li><li>打印用print而不是console.log</li><li>语句后面的分号不可省略</li><li>支持模板字符串，即字符串中添加$+变量名来展示。</li><li>void main( ){}是主函数入口。</li></ol><h3 id="注释">注释</h3><p>单行注释和多行注释同js一样。<br>///三斜杠是文档注释，支持markdown语法。</p><h3 id="变量">变量</h3><ul><li>变量是一个引用，变量存储的是对象的引用。</li><li>声明变量：<ol><li>明确指定类型：<code>int age=18;</code></li><li>不明确类型：<code>var age=18;</code>或<code> dynamic age=18;</code></li></ol></li><li>变量名大小写敏感</li><li>变量默认值为null，js中默认为undefined</li><li>dart变量的值不会进行隐式转换，即null不会自动转成false</li></ul><h3 id="常量">常量</h3><ul><li>常量是不可变的变量</li><li>声明常量<ol><li><code>const age=18;</code></li><li><code>final age=18;</code></li></ol></li><li>无法将运行时的值分配给const变量，但是可以分配给final变量。比如说 DateTime.now()</li></ul>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dart </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>svg的strokeDasharray和strokeDashoffset</title>
      <link href="/2022/08/29/svgStroke.html"/>
      <url>/2022/08/29/svgStroke.html</url>
      
        <content type="html"><![CDATA[<p>这一块知识在前端中有时会用到，比如说制作描边图展示的时候。</p><span id="more"></span><h3 id="strokedasharray">strokeDasharray</h3><p>它指的是svg图中，每一条边的描边的线长，也可以说是线宽。可以设置一个值，或者两个以及两个以上的值。</p><p>设置一个值的时候，它是指虚线的长和虚线之间的距离相等，都等于那个值。<br>设置两个值的时候，它是分别指虚线和的宽和虚线之间的距离。<br>两个以上，则宽、间距、宽循环。</p><h3 id="strokedashoffset">strokeDashoffset</h3><p>它指的是描边虚线的起点偏移量。如果说边的起点和终点为A、B，描边的起点为C、D，那么偏移量就是AC的长度。AC==0的时候，描边刚好和边。反之，只看得见部分描边。</p><h3 id="描边图展示">描边图展示</h3><p>strokeDasharray设置为边长，strokeDashoffset也设置为边长。此时描边虚线的长度等于边长，且虚线部分刚好完全偏移起点。svg边的部分刚好是虚线和虚线之间的距离（也就是空白），只要通过动画让偏移慢慢归零，即可实现虚线缓缓顺着边出现，即描边动画。</p>]]></content>
      
      
      <categories>
          
          <category> 知识 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> svg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>anime.js动画库的使用</title>
      <link href="/2022/08/29/animejs.html"/>
      <url>/2022/08/29/animejs.html</url>
      
        <content type="html"><![CDATA[<p>anime.js是一个方便好用的动画库。一些使用方法将记录在此。</p><span id="more"></span><h3 id="引入vue项目">引入vue项目</h3><p>先在终端安装依赖</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ npm install animejs --save</span><br><span class="line">```  </span><br><span class="line">再在script代码块中引入</span><br><span class="line">```js</span><br><span class="line">import anime from <span class="string">&#x27;animejs/lib/anime.es.js&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="选择动画目标">选择动画目标</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">anime</span>(&#123;</span><br><span class="line">    <span class="attr">targets</span>:<span class="string">&#x27;#circle&#x27;</span>,   <span class="comment">//可以使用css选择器，也可以先选完了在这里直接用</span></span><br><span class="line">    <span class="attr">translateX</span>:<span class="number">0</span>  <span class="comment">//水平移动</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h3 id="设定动画初始值">设定动画初始值</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">anime</span>(&#123;</span><br><span class="line">        <span class="attr">targets</span>:<span class="string">&#x27;#circle&#x27;</span>,   </span><br><span class="line">        <span class="attr">translateX</span>:[start,end]  <span class="comment">//在指定的位置start开始动画，在end处结束动画</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h3 id="属性关键帧">属性关键帧</h3><p>当设定不同属性的动画时，同时开始执行。如下，两组关键帧同时开始执行。x向右立刻偏移100，偏移开始时，y偏移的前摇开始，在x偏移完毕后，执行x向左偏移的前摇，同时y向右偏移的前摇时间结束，开始偏移，偏移结束时，x向左偏移的前摇结束，x向左偏移。从而，偏移顺序是，右，下，左，上。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">anime</span>(&#123;</span><br><span class="line">        <span class="attr">targets</span>:<span class="string">&#x27;#circle&#x27;</span>,</span><br><span class="line">        <span class="attr">translateX</span>:[</span><br><span class="line">            &#123;<span class="attr">value</span>:<span class="number">100</span>,<span class="attr">duration</span>:<span class="number">1000</span>&#125;,</span><br><span class="line">            &#123;<span class="attr">value</span>:<span class="number">0</span>,<span class="attr">duration</span>: <span class="number">1000</span>,<span class="attr">delay</span>:<span class="number">1000</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">translateY</span>:[</span><br><span class="line">            &#123;<span class="attr">value</span>:<span class="number">100</span>,<span class="attr">duration</span>:<span class="number">1000</span>,<span class="attr">delay</span>:<span class="number">1000</span>&#125;,</span><br><span class="line">            &#123;<span class="attr">value</span>:<span class="number">0</span>,<span class="attr">duration</span>: <span class="number">1000</span>,<span class="attr">delay</span>: <span class="number">1000</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">easing</span>: <span class="string">&#x27;easeOutElastic(1, .8)&#x27;</span>,</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h3 id="描边动画">描边动画</h3><p>svg图片的边长可以通过对path标签对应的dom对象调用方法getTotalLength( )来获得。设置描边的虚线长度和偏移量等于边长，前者可以使得描边的虚线很长，看起来就像实线，后者可以让这个虚线部分完全偏移起点，展现出的是虚线之间的空白距离，也就是透明线。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> paths=<span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;paths.<span class="property">length</span>;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    paths[i].<span class="property">style</span>.<span class="property">strokeDasharray</span>=paths[i].<span class="title function_">getTotalLength</span>()+<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    paths[i].<span class="property">style</span>.<span class="property">strokeDashoffset</span>=paths[i].<span class="title function_">getTotalLength</span>()+<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过动画缓慢调整虚线的偏移值，一点点露出来，就能看见这个虚线顺着边描线了。offset为0时，虚线刚好就能展示完毕，也就是描边完成。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">anime</span>(&#123;</span><br><span class="line">    <span class="attr">targets</span>: <span class="string">&#x27;#msg path&#x27;</span>,</span><br><span class="line">    <span class="attr">strokeDashoffset</span>: [anime.<span class="property">setDashoffset</span>, <span class="number">0</span>],<span class="comment">//anime.setDashoffset会得到边长，作为offset时，刚好没开始描边，这里作为起点。终点是0，也就是完全画好的状态</span></span><br><span class="line">    <span class="attr">easing</span>: <span class="string">&#x27;easeInOutSine&#x27;</span>,<span class="comment">//匀速</span></span><br><span class="line">    <span class="attr">duration</span>: <span class="number">1500</span>, <span class="comment">//描线的持续时间</span></span><br><span class="line">    <span class="attr">delay</span>: <span class="keyword">function</span>(<span class="params">el, i</span>) &#123; <span class="keyword">return</span> i * <span class="number">250</span> &#125;,  <span class="comment">//不同时描线，会更好看</span></span><br><span class="line">    <span class="attr">direction</span>: <span class="string">&#x27;alternate&#x27;</span>,<span class="comment">//正向动画做完再反着来一遍。</span></span><br><span class="line">    <span class="attr">loop</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 工具使用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> animejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gitalk的问题集</title>
      <link href="/2022/08/25/helpForGitalk.html"/>
      <url>/2022/08/25/helpForGitalk.html</url>
      
        <content type="html"><![CDATA[<p>问题集1：<a href="https://blog.csdn.net/gaocongzhi/article/details/116567800">前往此处</a><br>问题集2：<a href="https://www.dazhuanlan.com/flyex/topics/1193058">前往此处</a></p>]]></content>
      
      
      <categories>
          
          <category> 工具使用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gitalk </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xxx</title>
      <link href="/2022/08/25/CommentTest.html"/>
      <url>/2022/08/25/CommentTest.html</url>
      
        <content type="html"><![CDATA[<h3 id="测试gitalk">测试GITALK</h3>]]></content>
      
      
      <categories>
          
          <category> xxx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xxx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo的部分用法</title>
      <link href="/2022/08/25/usageOfHexo.html"/>
      <url>/2022/08/25/usageOfHexo.html</url>
      
        <content type="html"><![CDATA[<p>hexo安装完成后，需要进行一些小小的配置，才能拥有全部功能。比如分类啊，标签呀。还有about，也就是个人主页呀。</p> <span id="more"></span><h3 id="创建about页面">创建about页面</h3> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new page about</span><br></pre></td></tr></table></figure><p>生成后，在source目录下的about中，编辑默认的md文件即可展示。</p><h3 id="hexo配置自己的categories和tags">hexo配置自己的categories和tags</h3><p>在hexo自动生成的文件夹根目录下，比如我是自己创建的kahviaBlog文件夹，hexo在里面生成了诸如source这类的文件夹。那我就在kahviaBlog文件夹中，打开控制台。输入以下命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new page categories </span><br><span class="line">$ hexo new page tags</span><br></pre></td></tr></table></figure><p>指令执行完毕后，将在source目录下生成categories、tags文件夹。用编辑器打开其中的md文件。比如我的长下面这样。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2022-08-25 14:08:25</span><br><span class="line">---</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2022-08-25 14:39:58</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>那么我只需要分别在它们的后面添加 type: categories 和 type: tags 即可。需要注意的是，冒号后面有一个空格，这是必须的。经过测试，空格后的 type 名可以加引号，也可以不加引号。<br>正确的格式如下。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2022-08-25 14:08:25</span><br><span class="line">type: categories</span><br><span class="line">---</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2022-08-25 14:39:58</span><br><span class="line">type: tags</span><br><span class="line">---</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="创建自己的博客">创建自己的博客</h3><p>在source目录下的 _post 文件夹中，创建自己的 md 文件。md 指的是markdown。可以用自己喜欢的编辑器区写博客。我使用的是 <a href="https://github.com/vnotex/vnote">VNote</a> 。<br>用VNote选择“从文件夹中新建笔记本”，打开自己的source文件夹下的 _post 创建自己的笔记本。再新建笔记即可。<br>我自己的模板长这样。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: xxx</span><br><span class="line">categories: xxx</span><br><span class="line">tags:</span><br><span class="line">     - xxx</span><br><span class="line">---</span><br><span class="line">分割线以下为正文区</span><br></pre></td></tr></table></figure><p>值得一提的是，如果要为某篇博客添加多个标签，应当换行后，以减号开头，加一个空格，其后接一个标签名，再重复上述操作直到满意为止。这时，tags的冒号后面的空格可以省略，因为有了换行。<br>如果是单标签，也可以，tags: name,冒号后有空格。</p><h3 id="选择不进行页面渲染的文件">选择不进行页面渲染的文件</h3><p>当命令行输入 hexo g 后，hexo会自动将source目录下的所有文件都进行渲染，生成新的public文件夹。最好先用 hexo cl 清理掉以前的public文件夹，再用g命令生成比较好。</p><p>如果使用了VNote进行创建笔记，那么它会在你的 _post 文件夹下生成一些与软件相关的文件夹或者文件，比如vx_notebook，vx_recycle_bin，vx.json等。</p><p>你也不希望这些无关的文件被当成博客展示在页面上吧？这时候就需要用到hexo 自己的配置文件_config.yml了，注意，不是主题下面的_config.yml。</p><p>在其中找到skip_render: [ ],在里面添加不想渲染的东西就可以了。路径是以source为准的相对路径。比如我source下面的 _post 里有个 vx_notebook 文件夹，我就在数组中加一个 _posts/vx_notebook/** 就可以了，用不用引号包裹都可以，我试过了。选择具体的文件的话，像 _posts/vx.json 这样就行了。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">skip_render: [_posts/vx_notebook/**,_posts/vx.json,_posts/vx_recycle_bin/**,about/vx_notebook/**,about/vx.json,about/vx_recycle_bin/**]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 工具使用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前后端分离，后端无法获取正确的session</title>
      <link href="/2022/08/23/TestBlog.html"/>
      <url>/2022/08/23/TestBlog.html</url>
      
        <content type="html"><![CDATA[<p>当我在前后端分离的开发中，遇到了前端请求后端数据，后端却无法判断请求的session id。经查阅和浏览器开发者工具抓包，发现每次请求都没有正常携带cookie，因而后端无法根据cookie中的session id 查找到正确的session。</p><p>在vue项目中，前端的main.js中添加如下代码即可正常携带cookie。</p><pre><code class="language-js">    axios.defaults.withCredentials = true;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 小问题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/08/22/hello-world.html"/>
      <url>/2022/08/22/hello-world.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p> <span id="more"></span><h2 id="quick-start">Quick Start</h2><h3 id="create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>about</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[<h1 id="hello-it-s-kahvia">Hello, It’s <a href="#">Kahvia</a> .</h1><hr><h3 id="作者">作者</h3><p>Kahvia。</p><blockquote><p><strong>不骄不躁，努力生活。</strong></p></blockquote><h3 id="now">Now</h3><p>Tring to improve myself, struggling for the future life.</p>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/custom.css"/>
      <url>/css/custom.css</url>
      
        <content type="html"><![CDATA[/* @font-face {  font-family: Candyhome;  src: url(https://npm.elemecdn.com/anzhiyu-blog@1.1.6/fonts/Candyhome.ttf);  font-display: swap;  font-weight: lighter;} */@font-face {    font-family: ZhuZiAYuanJWD;    src: url(https://npm.elemecdn.com/anzhiyu-blog@1.1.6/fonts/ZhuZiAWan.woff2);    font-display: swap;    font-weight: lighter;}div#menus {    font-family: "ZhuZiAYuanJWD";}h1#site-title {    font-family: ZhuZiAYuanJWD;    font-size: 3em !important;}a.article-title,a.blog-slider__title,a.categoryBar-list-link,h1.post-title {    font-family: ZhuZiAYuanJWD;}.iconfont {    font-family: "iconfont" !important;    font-size: 3em;    /* 可以定义图标大小 */    font-style: normal;    -webkit-font-smoothing: antialiased;    -moz-osx-font-smoothing: grayscale;}/* 时间轴生肖icon */svg.icon {    /* 这里定义svg.icon，避免和Butterfly自带的note标签冲突 */    width: 1em;    height: 1em;    /* width和height定义图标的默认宽度和高度*/    vertical-align: -0.15em;    fill: currentColor;    overflow: hidden;}.icon-zhongbiao::before {    color: #f7c768;}/* bilibli番剧插件 */#article-container .bangumi-tab.bangumi-active {    background: var(--anzhiyu-theme);    color: var(--anzhiyu-ahoverbg);    border-radius: 10px;}a.bangumi-tab:hover {    text-decoration: none !important;}.bangumi-button:hover {    background: var(--anzhiyu-theme) !important;    border-radius: 10px !important;    color: var(--anzhiyu-ahoverbg) !important;}a.bangumi-button.bangumi-nextpage:hover {    text-decoration: none !important;}.bangumi-button {    padding: 5px 10px !important;}a.bangumi-tab {    padding: 5px 10px !important;}svg.icon.faa-tada {    font-size: 1.1em;}.bangumi-info-item {    border-right: 1px solid #f2b94b;}.bangumi-info-item span {    color: #f2b94b;}.bangumi-info-item em {    color: #f2b94b;}/* 解决artitalk的图标问题 */#uploadSource>svg {    width: 1.19em;    height: 1.5em;}/*top-img黑色透明玻璃效果移除，不建议加，除非你执着于完全一图流或者背景图对比色明显 */#page-header:not(.not-top-img):before {    background-color: transparent !important;}/* 首页文章卡片 */#recent-posts>.recent-post-item {    background: rgba(255, 255, 255, 0.9);}/* 首页侧栏卡片 */#aside-content .card-widget {    background: rgba(255, 255, 255, 0.9);}/* 文章页面正文背景 */div#post {    background: rgba(255, 255, 255, 0.9);}/* 分页页面 */div#page {    background: rgba(255, 255, 255, 0.9);}/* 归档页面 */div#archive {    background: rgba(255, 255, 255, 0.9);}/* 标签页面 */div#tag {    background: rgba(255, 255, 255, 0.9);}/* 分类页面 */div#category {    background: rgba(255, 255, 255, 0.9);}/*夜间模式伪类遮罩层透明*/[data-theme="dark"] #recent-posts>.recent-post-item {    background: #121212;}[data-theme="dark"] .card-widget {    background: #121212 !important;}[data-theme="dark"] div#post {    background: #121212 !important;}[data-theme="dark"] div#tag {    background: #121212 !important;}[data-theme="dark"] div#archive {    background: #121212 !important;}[data-theme="dark"] div#page {    background: #121212 !important;}[data-theme="dark"] div#category {    background: #121212 !important;}[data-theme="dark"] div#category {    background: transparent !important;}/* 页脚透明 */#footer {    background: transparent !important;}/* 头图透明 */#page-header {    background: transparent !important;}#rightside>div>button {    border-radius: 5px;}/* 滚动条 */::-webkit-scrollbar {    width: 10px;    height: 10px;}::-webkit-scrollbar-thumb {    background-color: #425aef;    border-radius: 2em;}::-webkit-scrollbar-corner {    background-color: transparent;}::-moz-selection {    color: #fff;    background-color: #425aef;}/* 音乐播放器 *//* .aplayer .aplayer-lrc {    display: none !important;  } */.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {    left: -66px !important;    transition: all 0.3s;    /* 默认情况下缩进左侧66px，只留一点箭头部分 */}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {    left: 0 !important;    transition: all 0.3s;    /* 鼠标悬停是左侧缩进归零，完全显示按钮 */}.aplayer.aplayer-fixed {    z-index: 999999 !important;}/* 评论框  */.vwrap {    box-shadow: 2px 2px 5px #bbb;    background: rgba(255, 255, 255, 0.3);    border-radius: 8px;    padding: 30px;    margin: 30px 0px 30px 0px;}/* 设置评论框 */.vcard {    box-shadow: 2px 2px 5px #bbb;    background: rgba(255, 255, 255, 0.3);    border-radius: 8px;    padding: 30px;    margin: 30px 0px 0px 0px;}/* 鼠标图标 */body {    cursor: url("/img/x1.cur"), auto;}a,[type="button"]:not(:disabled),[type="reset"]:not(:disabled),[type="submit"]:not(:disabled),button:not(:disabled) {    cursor: url("/img/x2.cur"), auto !important;}/* md网站下划线 */#article-container a:hover {    text-decoration: none !important;}#article-container #hpp_talk p img {    display: inline;}/* 404页面 */#error-wrap {    position: absolute;    top: 40%;    right: 0;    left: 0;    margin: 0 auto;    padding: 0 1rem;    max-width: 1000px;    transform: translate(0, -50%);}#error-wrap .error-content {    display: flex;    flex-direction: row;    justify-content: center;    align-items: center;    margin: 0 1rem;    height: 18rem;    border-radius: 8px;    background: var(--card-bg);    box-shadow: var(--card-box-shadow);    transition: all 0.3s;}#error-wrap .error-content .error-img {    box-flex: 1;    flex: 1;    height: 100%;    border-top-left-radius: 8px;    border-bottom-left-radius: 8px;    background-color: #425aef;    background-position: center;    background-size: cover;}#error-wrap .error-content .error-info {    box-flex: 1;    flex: 1;    padding: 0.5rem;    text-align: center;    font-size: 14px;    font-family: Titillium Web, "PingFang SC", "Hiragino Sans GB", "Microsoft JhengHei", "Microsoft YaHei", sans-serif;}#error-wrap .error-content .error-info .error_title {    margin-top: -4rem;    font-size: 9em;}#error-wrap .error-content .error-info .error_subtitle {    margin-top: -3.5rem;    word-break: break-word;    font-size: 1.6em;}#error-wrap .error-content .error-info a {    display: inline-block;    margin-top: 0.5rem;    padding: 0.3rem 1.5rem;    background: var(--btn-bg);    color: var(--btn-color);}#body-wrap.error .aside-list {    display: flex;    flex-direction: row;    flex-wrap: nowrap;    bottom: 0px;    position: absolute;    padding: 1rem;    width: 100%;    overflow: scroll;}#body-wrap.error .aside-list .aside-list-group {    display: flex;    flex-direction: row;    flex-wrap: nowrap;    max-width: 1200px;    margin: 0 auto;}#body-wrap.error .aside-list .aside-list-item {    padding: 0.5rem;}#body-wrap.error .aside-list .aside-list-item img {    width: 100%;    object-fit: cover;    border-radius: 12px;}#body-wrap.error .aside-list .aside-list-item .thumbnail {    overflow: hidden;    width: 230px;    height: 143px;    background: var(--anzhiyu-card-bg);    display: flex;}#body-wrap.error .aside-list .aside-list-item .content .title {    -webkit-line-clamp: 2;    overflow: hidden;    display: -webkit-box;    -webkit-box-orient: vertical;    line-height: 1.5;    justify-content: center;    align-items: flex-end;    align-content: center;    padding-top: 0.5rem;    color: white;}#body-wrap.error .aside-list .aside-list-item .content time {    display: none;}/* 代码框主题 */#article-container figure.highlight {    border-radius: 10px;}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>categories</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>留言板</title>
      <link href="/comment/index.html"/>
      <url>/comment/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>分类</title>
      <link href="/category/index.html"/>
      <url>/category/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/flash.css"/>
      <url>/css/flash.css</url>
      
        <content type="html"><![CDATA[.pace {-webkit-pointer-events: none;pointer-events: none;-webkit-user-select: none;-moz-user-select: none;user-select: none;}.pace-inactive {display: none;}.pace .pace-progress {background: #29d;position: fixed;z-index: 2000;top: 0;right: 100%;width: 100%;height: 2px;}.pace .pace-progress-inner {display: block;position: absolute;right: 0px;width: 100px;height: 100%;box-shadow: 0 0 10px #29d, 0 0 5px #29d;opacity: 1.0;-webkit-transform: rotate(3deg) translate(0px, -4px);-moz-transform: rotate(3deg) translate(0px, -4px);-ms-transform: rotate(3deg) translate(0px, -4px);-o-transform: rotate(3deg) translate(0px, -4px);transform: rotate(3deg) translate(0px, -4px);}.pace .pace-activity {display: block;position: fixed;z-index: 2000;top: 15px;right: 15px;width: 14px;height: 14px;border: solid 2px transparent;border-top-color: #29d;border-left-color: #29d;border-radius: 10px;-webkit-animation: pace-spinner 400ms linear infinite;-moz-animation: pace-spinner 400ms linear infinite;-ms-animation: pace-spinner 400ms linear infinite;-o-animation: pace-spinner 400ms linear infinite;animation: pace-spinner 400ms linear infinite;}@-webkit-keyframes pace-spinner {0% { -webkit-transform: rotate(0deg); transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); }}@-moz-keyframes pace-spinner {0% { -moz-transform: rotate(0deg); transform: rotate(0deg); }100% { -moz-transform: rotate(360deg); transform: rotate(360deg); }}@-o-keyframes pace-spinner {0% { -o-transform: rotate(0deg); transform: rotate(0deg); }100% { -o-transform: rotate(360deg); transform: rotate(360deg); }}@-ms-keyframes pace-spinner {0% { -ms-transform: rotate(0deg); transform: rotate(0deg); }100% { -ms-transform: rotate(360deg); transform: rotate(360deg); }}@keyframes pace-spinner {0% { transform: rotate(0deg); transform: rotate(0deg); }100% { transform: rotate(360deg); transform: rotate(360deg); }}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>友情链接</title>
      <link href="/friend/index.html"/>
      <url>/friend/index.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>欢迎交换友链</p></blockquote>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>赞赏</title>
      <link href="/donate/index.html"/>
      <url>/donate/index.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>如果喜欢我的博客，或者喜欢我的博客主题，可以考虑赞赏一下哦，非常感激！<br>网站所需的服务器和 CDN 都是不小的开支，日常维护也需要大量精力。 <br>你们的支持是我前进的最大动力！</p></blockquote>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>link</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>tags</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>标签</title>
      <link href="/tag/index.html"/>
      <url>/tag/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
