<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Kahvia&#39;s Home</title>
  
  <subtitle>Never give up!</subtitle>
  <link href="https://blog.kahvia.cn/atom.xml" rel="self"/>
  
  <link href="https://blog.kahvia.cn/"/>
  <updated>2022-10-24T11:37:12.628Z</updated>
  <id>https://blog.kahvia.cn/</id>
  
  <author>
    <name>Kahvia</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Flutter-Slidable</title>
    <link href="https://blog.kahvia.cn/2022/10/23/FlutterSlidable.html"/>
    <id>https://blog.kahvia.cn/2022/10/23/FlutterSlidable.html</id>
    <published>2022-10-23T09:57:18.396Z</published>
    <updated>2022-10-24T11:37:12.628Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Slidable"><a href="#Slidable" class="headerlink" title="Slidable"></a>Slidable</h3><p>滑动选项卡组件。</p><h3 id="依赖引入"><a href="#依赖引入" class="headerlink" title="依赖引入"></a>依赖引入</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter_slidable: ^<span class="number">2.0</span><span class="number">.0</span></span><br></pre></td></tr></table></figure><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Slidable(<span class="comment">//可滑动的组件</span></span><br><span class="line">  <span class="comment">//end代表从右边往左边滑动</span></span><br><span class="line">  endActionPane: ActionPane(<span class="comment">//滑动选项面板</span></span><br><span class="line">    motion: <span class="keyword">const</span> StretchMotion(),<span class="comment">//滑动动画</span></span><br><span class="line">    children: [</span><br><span class="line">      <span class="comment">//SlidableAction是单个滑动选项</span></span><br><span class="line">      SlidableAction(</span><br><span class="line">        onPressed: onDelete,<span class="comment">//触发删除的函数</span></span><br><span class="line">        icon: Icons.delete,<span class="comment">//图标</span></span><br><span class="line">        backgroundColor: Colors.redAccent,<span class="comment">//背景色</span></span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">12</span>),<span class="comment">//圆角</span></span><br><span class="line">      )</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">  child: Container(</span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">24</span>),</span><br><span class="line">    <span class="comment">// height: 60,</span></span><br><span class="line">    decoration:  BoxDecoration(</span><br><span class="line">        color: Colors.orange,</span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">12</span>)</span><br><span class="line">    ),</span><br><span class="line">    child: Row(</span><br><span class="line">      children: [</span><br><span class="line">        Checkbox(</span><br><span class="line">          value: finished,</span><br><span class="line">          onChanged: onChanged,</span><br><span class="line">          activeColor: Colors.black,</span><br><span class="line">        ),</span><br><span class="line">        Text(</span><br><span class="line">          taskName,</span><br><span class="line">          style: TextStyle(decoration: finished?TextDecoration.lineThrough:TextDecoration.none),</span><br><span class="line">          overflow: TextOverflow.ellipsis,</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><img src="https://pics-1312295925.cos.ap-chengdu.myqcloud.com/img/Screenshot_20221023_180755.png" alt="Screenshot_20221023_180755"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;Slidable&quot;&gt;&lt;a href=&quot;#Slidable&quot; class=&quot;headerlink&quot; title=&quot;Slidable&quot;&gt;&lt;/a&gt;Slidable&lt;/h3&gt;&lt;p&gt;滑动选项卡组件。&lt;/p&gt;
&lt;h3 id=&quot;依赖引入&quot;&gt;&lt;a href=&quot;#依赖引入&quot; cla</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-CircularProgressIndicator</title>
    <link href="https://blog.kahvia.cn/2022/10/20/FlutterCircularProgressIndicator.html"/>
    <id>https://blog.kahvia.cn/2022/10/20/FlutterCircularProgressIndicator.html</id>
    <published>2022-10-20T08:29:31.068Z</published>
    <updated>2022-10-24T11:37:11.920Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CircularProgressIndicator"><a href="#CircularProgressIndicator" class="headerlink" title="CircularProgressIndicator"></a>CircularProgressIndicator</h3><p>圆形的进度指示。可以用于等待加载的时候。</p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>常配合 showDialog( ) 使用。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">showDialog(</span><br><span class="line">    context: context,</span><br><span class="line">    builder: (context)&#123;</span><br><span class="line">      <span class="keyword">return</span> Center(</span><br><span class="line">        child: CircularProgressIndicator(color: MyColors.rgbRed,),</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>用完以后用 Navigator 回退页面就行了。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Navigator.of(context).pop();<span class="comment">//这样</span></span><br><span class="line">Navigator.pop(context);<span class="comment">//或这样</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;CircularProgressIndicator&quot;&gt;&lt;a href=&quot;#CircularProgressIndicator&quot; class=&quot;headerlink&quot; title=&quot;CircularProgressIndicator&quot;&gt;&lt;/a&gt;CircularPro</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-ImagePicker-ImageCropper</title>
    <link href="https://blog.kahvia.cn/2022/10/20/FlutterImagePickerAndCropper.html"/>
    <id>https://blog.kahvia.cn/2022/10/20/FlutterImagePickerAndCropper.html</id>
    <published>2022-10-20T05:49:22.508Z</published>
    <updated>2022-10-24T11:37:11.180Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ImagePicker"><a href="#ImagePicker" class="headerlink" title="ImagePicker"></a>ImagePicker</h3><p>Flutter用于选择图片的工具包。</p><h4 id="依赖引入"><a href="#依赖引入" class="headerlink" title="依赖引入"></a>依赖引入</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image_picker:</span> <span class="string">^0.8.6</span></span><br></pre></td></tr></table></figure><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> ImagePicker _picker=ImagePicker();<span class="comment">//创建选择器实例</span></span><br><span class="line">onPressed: ()<span class="keyword">async</span>&#123;</span><br><span class="line">        <span class="comment">//从相册选择图片</span></span><br><span class="line">        <span class="keyword">final</span> image=<span class="keyword">await</span> _picker.pickImage(source: ImageSource.gallery);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h3 id="ImageCropper"><a href="#ImageCropper" class="headerlink" title="ImageCropper"></a>ImageCropper</h3><p>用于图片裁剪的工具包</p><h4 id="依赖引入-1"><a href="#依赖引入-1" class="headerlink" title="依赖引入"></a>依赖引入</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image_cropper:</span> <span class="string">^3.0.0</span></span><br></pre></td></tr></table></figure><h4 id="相关配置-安卓需要配置，ios不需要"><a href="#相关配置-安卓需要配置，ios不需要" class="headerlink" title="相关配置(安卓需要配置，ios不需要)"></a>相关配置(安卓需要配置，ios不需要)</h4><p>在AndroidManifest.xml加入以下信息。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.yalantis.ucrop.UCropActivity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:screenOrientation</span>=<span class="string">&quot;portrait&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.AppCompat.Light.NoActionBar&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CroppedFile? croppedImage=<span class="keyword">await</span> ImageCropper().cropImage(sourcePath: image.path);<span class="comment">//创建裁剪器给定图片源进行裁剪</span></span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="两者结合"><a href="#两者结合" class="headerlink" title="两者结合"></a>两者结合</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="comment">//创建图片选择器实例</span></span><br><span class="line">  <span class="keyword">final</span> ImagePicker _picker=ImagePicker();</span><br><span class="line">  <span class="keyword">return</span> ElevatedButton(</span><br><span class="line">    <span class="comment">//单击按钮触发选择</span></span><br><span class="line">    onPressed: ()<span class="keyword">async</span>&#123;</span><br><span class="line">      <span class="comment">//从相册选择图片</span></span><br><span class="line">      <span class="keyword">final</span> image=<span class="keyword">await</span> _picker.pickImage(source: ImageSource.gallery); <span class="comment">//返回的是XFile对象</span></span><br><span class="line">      <span class="comment">//选择了图片则创建裁剪器实例进入裁剪环节</span></span><br><span class="line">      <span class="keyword">if</span>(image!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        CroppedFile? croppedImage=<span class="keyword">await</span> ImageCropper().cropImage(sourcePath: image.path);<span class="comment">//根据XFile对象的路径获得图片进行裁剪</span></span><br><span class="line">        <span class="comment">//裁剪了则把裁剪后的图片设置为预览的文件源</span></span><br><span class="line">        <span class="keyword">if</span>(croppedImage!=<span class="keyword">null</span>)&#123;</span><br><span class="line">          context.read&lt;ImageData&gt;().setImage(File(croppedImage.path));<span class="comment">//CroppedFile转File，上传图片的时候根据File转MultipartFile即可</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//未裁剪则设置裁剪之前选择的图片作为预览的文件源</span></span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">          context.read&lt;ImageData&gt;().setImage(File(image.path));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    style: ButtonStyle(</span><br><span class="line">        shape: MaterialStateProperty.all(<span class="keyword">const</span> RoundedRectangleBorder(</span><br><span class="line">            borderRadius: BorderRadius.all(Radius.circular(<span class="number">30</span>))</span><br><span class="line">        )),</span><br><span class="line">        <span class="comment">//设置按钮宽度高度等</span></span><br><span class="line">        minimumSize: MaterialStateProperty.all(<span class="keyword">const</span> Size(<span class="number">300</span>, <span class="number">40</span>)),</span><br><span class="line">        backgroundColor: MaterialStateProperty.all(MyColors.rgbRed)</span><br><span class="line">    ),</span><br><span class="line">    child: <span class="keyword">const</span> Text(<span class="string">&quot;Select a photo from gallery&quot;</span>),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="图片上传"><a href="#图片上传" class="headerlink" title="图片上传"></a>图片上传</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//图片选择或裁剪完毕后，单击完成上传</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FinishedButton</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> FinishedButton(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">//创建dio实例，用于发送http请求</span></span><br><span class="line">    <span class="keyword">final</span> dio=Dio();</span><br><span class="line">    <span class="comment">//获取已经准备好的图片文件源</span></span><br><span class="line">    File? image=context.watch&lt;ImageData&gt;().image;</span><br><span class="line">    <span class="keyword">return</span> ElevatedButton(</span><br><span class="line">      onPressed: image==null?<span class="comment">//没有文件源代表没有选图片，不进行上传操作</span></span><br><span class="line">      ()&#123;&#125;:<span class="comment">//有文件源就进入上传阶段</span></span><br><span class="line">      ()<span class="keyword">async</span>&#123;</span><br><span class="line">        <span class="keyword">final</span> multipartImg=<span class="keyword">await</span> MultipartFile.fromFile(image.path);<span class="comment">//根据文件源生成媒体图片</span></span><br><span class="line">        <span class="keyword">final</span> map=&lt;<span class="built_in">String</span>,<span class="built_in">dynamic</span>&gt;&#123;&#125;;<span class="comment">//创建map存储图片</span></span><br><span class="line">        map[<span class="string">&#x27;file&#x27;</span>]=<span class="keyword">await</span> MultipartFile.fromFile(image.path);</span><br><span class="line">        <span class="comment">//将map转为表单数据后，发送post请求，上传服务器，并接收返回的数据</span></span><br><span class="line">        <span class="keyword">var</span> response=<span class="keyword">await</span> dio.post(<span class="string">&quot;<span class="subst">$serviceUploadHeader</span>/<span class="subst">$&#123;context.read&lt;UserMsg&gt;().userId&#125;</span>&quot;</span>,data: FormData.fromMap(map));</span><br><span class="line">        context.read&lt;UserMsg&gt;().setHeadImg(response.data);<span class="comment">//及时更新头像的链接</span></span><br><span class="line">        Navigator.pop(context);<span class="comment">//上传完毕即退回首页</span></span><br><span class="line">      &#125;,</span><br><span class="line">      style: ButtonStyle(</span><br><span class="line">          backgroundColor: image==null?</span><br><span class="line">          MaterialStateProperty.all(Colors.grey):</span><br><span class="line">          MaterialStateProperty.all(MyColors.rgbRed)</span><br><span class="line">      ),</span><br><span class="line">      child:  <span class="keyword">const</span> Text(<span class="string">&quot;Finished&quot;</span>,),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;ImagePicker&quot;&gt;&lt;a href=&quot;#ImagePicker&quot; class=&quot;headerlink&quot; title=&quot;ImagePicker&quot;&gt;&lt;/a&gt;ImagePicker&lt;/h3&gt;&lt;p&gt;Flutter用于选择图片的工具包。&lt;/p&gt;
&lt;h4 id=&quot;依赖引入&quot;&gt;&lt;a href=&quot;#依赖引入&quot; class=&quot;headerlink&quot; title=&quot;依赖引入&quot;&gt;&lt;/a&gt;依赖引入&lt;/h4&gt;&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;image_picker:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;^0.8.6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&quot;使用&quot;&gt;&lt;a href=&quot;#使用&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h4&gt;&lt;figure class=&quot;highlight dart&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; ImagePicker _picker=ImagePicker();&lt;span class=&quot;comment&quot;&gt;//创建选择器实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;onPressed: ()&lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//从相册选择图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; image=&lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; _picker.pickImage(source: ImageSource.gallery);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;ImageCropper&quot;&gt;&lt;a href=&quot;#ImageCropper&quot; class=&quot;headerlink&quot; title=&quot;ImageCropper&quot;&gt;&lt;/a&gt;ImageCropper&lt;/h3&gt;&lt;p&gt;用于图片裁剪的工具包&lt;/p&gt;
&lt;h4 id=&quot;依赖引入-1&quot;&gt;&lt;a href=&quot;#依赖引入-1&quot; class=&quot;headerlink&quot; title=&quot;依赖引入&quot;&gt;&lt;/a&gt;依赖引入&lt;/h4&gt;&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;image_cropper:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;^3.0.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&quot;相关配置-安卓需要配置，ios不需要&quot;&gt;&lt;a href=&quot;#相关配置-安卓需要配置，ios不需要&quot; class=&quot;headerlink&quot; title=&quot;相关配置(安卓需要配置，ios不需要)&quot;&gt;&lt;/a&gt;相关配置(安卓需要配置，ios不需要)&lt;/h4&gt;&lt;p&gt;在AndroidManifest.xml加入以下信息。&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;activity&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;quot;com.yalantis.ucrop.UCropActivity&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;android:screenOrientation&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;quot;portrait&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;android:theme&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;quot;@style/Theme.AppCompat.Light.NoActionBar&amp;quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h4 id=&quot;使用-1&quot;&gt;&lt;a href=&quot;#使用-1&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h4&gt;&lt;figure class=&quot;highlight dart&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CroppedFile? croppedImage=&lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; ImageCropper().cropImage(sourcePath: image.path);&lt;span class=&quot;comment&quot;&gt;//创建裁剪器给定图片源进行裁剪&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>MicroService-Nacos</title>
    <link href="https://blog.kahvia.cn/2022/10/16/MicroserviceNacos.html"/>
    <id>https://blog.kahvia.cn/2022/10/16/MicroserviceNacos.html</id>
    <published>2022-10-16T04:52:16.493Z</published>
    <updated>2022-10-24T11:37:09.201Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Nacos"><a href="#Nacos" class="headerlink" title="Nacos"></a>Nacos</h3><p>用于替代已经停止维护的 Eureka 。</p><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><p>在<a href="https://github.com/alibaba/nacos">AlibabaNacos</a>的里程碑中选择版本进行下载。</p><p>下载解压后，在 bin 目录下打开终端，输入指令启动。Windows 运行cmd文件，Linux运行sh文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./startup.cmd -m standalone</span><br></pre></td></tr></table></figure><p>默认服务端口为8848，可在 conf 目录下配置文件 application.properties 中更改。</p><span id="more"></span><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><p>在父工程的pom文件中添加依赖管理。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Hoxton.SR9<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            包含nacos的项目依赖管理--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在子工程（各微服务对应的spring boot项目）pom文件中添加 nacos 依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在子工程配置文件yml中配置服务端地址</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">UserService</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">39940</span></span><br></pre></td></tr></table></figure><h3 id="服务多级存储模型"><a href="#服务多级存储模型" class="headerlink" title="服务多级存储模型"></a>服务多级存储模型</h3><p>微服务分集群部署。分集群部署，服务不容易同时挂掉。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://www.kahvia.cn:3306/Blogs?serverTimezone=GMT%2B8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">Mysql3306@.com</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">UserService</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">      <span class="attr">discovery:</span> </span><br><span class="line">        <span class="attr">cluster-name:</span> <span class="string">YC</span> <span class="comment">#集群名称，常按地名划分，YC为宜昌</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">39940</span></span><br></pre></td></tr></table></figure><h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>局部策略（在某个微服务中调用指定微服务的负载均衡策略）</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">UserService:</span> <span class="comment">#为某个微服务配置负载均衡的规则</span></span><br><span class="line">  <span class="attr">ribbon:</span></span><br><span class="line">    <span class="attr">NFLoadBalancerRuleClassName:</span> <span class="string">com.alibaba.cloud.nacos.ribbon.NacosRule</span> <span class="comment">#该策略优先远程调用同集群的微服务，同集群挂掉会访问其它集群</span></span><br></pre></td></tr></table></figure><h3 id="权重"><a href="#权重" class="headerlink" title="权重"></a>权重</h3><p>在nacos管理页面中，可以为同一微服务同一集群的不同实例设置权重。权重越大，负载均衡选中的几率越大。</p><p>可以通过将权重置零来进行服务的升级，升级完成后设置较小权重进行服务测试。</p><h3 id="环境隔离"><a href="#环境隔离" class="headerlink" title="环境隔离"></a>环境隔离</h3><p>不同环境（不同命名空间）的服务无法互相调用。可用于开发环境与上线后的环境隔离，大概？</p><p>在nacos管理页面中，可新建命名空间，获取它的id后，在需要配置环境隔离的服务项目的 application.yml 中，如下配置。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">AchatWs</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment">#nacos服务端地址</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">cluster-name:</span> <span class="string">YC</span> <span class="comment">#集群模拟，宜昌</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">id</span> <span class="comment">#命名空间的id</span></span><br></pre></td></tr></table></figure><h3 id="Nacos配置管理"><a href="#Nacos配置管理" class="headerlink" title="Nacos配置管理"></a>Nacos配置管理</h3><p>客户端引入nacos配置管理的依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>需要进行配置管理的项目新建 bootstrap.yml 文件，在其中写入与nacos有关的属性，如开发环境、服务端地址、微服务名称等。这些信息在 application.yml 中就可以不写了。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bootstrap.yml</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">UserService</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span> <span class="comment">#开发环境</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">cluster-name:</span> <span class="string">YC</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span> <span class="comment">#要获取的配置文件后缀名</span></span><br></pre></td></tr></table></figure><p>项目启动的时候，会优先读取 bootstrap.yml 中的配置信息，再根据其中的信息去nacos服务端获取nacos管理的配置，将这个获取到的配置与之后读取的 application.yml 作合并，最后才完整地启动项目。</p><p>nacos服务端新建配置，ID由“服务名-环境.后缀”组成最好。</p><p><img src="https://img1.imgtp.com/2022/10/16/wDZtkR8c.png" alt="自定义配置"></p><h3 id="Nacos配置管理的热更新"><a href="#Nacos配置管理的热更新" class="headerlink" title="Nacos配置管理的热更新"></a>Nacos配置管理的热更新</h3><h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h4><p>哪里使用就为那里的类添加热更新注释。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RefreshScope</span> <span class="comment">//加这个注解才能实现配置的热更新</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;pattern.dateformat&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String format;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/time&quot;)</span></span><br><span class="line">    String <span class="title function_">getTime</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.now().format(DateTimeFormatter.ofPattern(format));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>官方对@RefreshScope的解释是</p><blockquote><p>Convenience annotation to put a @Bean definition in refresh scope. Beans annotated this way can be refreshed at runtime and any components that are using them will get a new instance on the next method call, fully initialized and injected with all dependencies.</p></blockquote><h4 id="方式二-推荐"><a href="#方式二-推荐" class="headerlink" title="方式二(推荐)"></a>方式二(推荐)</h4><p>自定义配置类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.userservice.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;pattern&quot;)</span><span class="comment">//prefix是前缀的意思，前缀和属性名拼接之后的属性若是在配置文件中，就可以实现自动注入</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PropertiesFromNacos</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String dateformat;<span class="comment">//属性名。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDateformat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dateformat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDateformat</span><span class="params">(String dateformat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.dateformat = dateformat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>@ConfigurationProperties(prefix &#x3D; “xxx”)源码注释</p><blockquote><p>The prefix of the properties that are valid to bind to this object. Synonym for prefix(). A valid prefix is defined by one or more words separated with dots (e.g. “acme.system.feature”).<br>Returns: the prefix of the properties to bind</p></blockquote><p>使用该注释，需要引入依赖</p><blockquote><p>You can easily generate your own configuration metadata file from items annotated with <code>@ConfigurationProperties</code> by using the <code>spring-boot-configuration-processor</code> jar. The jar includes a Java annotation processor which is invoked as your project is compiled.</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="多环境共享配置"><a href="#多环境共享配置" class="headerlink" title="多环境共享配置"></a>多环境共享配置</h3><p>在nacos管理页面创建配置文件的名字，只需要用服务的名字就可以了。比如，UserService,而不是UserService-dev.</p><p>项目启动时，会同时从nacos读取上述两种配置，后者的优先级大于前者，前者大于本地。同名属性则覆盖。</p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;Nacos&quot;&gt;&lt;a href=&quot;#Nacos&quot; class=&quot;headerlink&quot; title=&quot;Nacos&quot;&gt;&lt;/a&gt;Nacos&lt;/h3&gt;&lt;p&gt;用于替代已经停止维护的 Eureka 。&lt;/p&gt;
&lt;h3 id=&quot;服务端&quot;&gt;&lt;a href=&quot;#服务端&quot; class=&quot;headerlink&quot; title=&quot;服务端&quot;&gt;&lt;/a&gt;服务端&lt;/h3&gt;&lt;p&gt;在&lt;a href=&quot;https://github.com/alibaba/nacos&quot;&gt;AlibabaNacos&lt;/a&gt;的里程碑中选择版本进行下载。&lt;/p&gt;
&lt;p&gt;下载解压后，在 bin 目录下打开终端，输入指令启动。Windows 运行cmd文件，Linux运行sh文件&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;./startup.cmd -m standalone&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;默认服务端口为8848，可在 conf 目录下配置文件 application.properties 中更改。&lt;/p&gt;</summary>
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="MicroService" scheme="https://blog.kahvia.cn/tags/MicroService/"/>
    
  </entry>
  
  <entry>
    <title>Springboot项目打 jar 包没有webapp中的静态资源</title>
    <link href="https://blog.kahvia.cn/2022/10/07/SpringbootWithoutWebapp.html"/>
    <id>https://blog.kahvia.cn/2022/10/07/SpringbootWithoutWebapp.html</id>
    <published>2022-10-07T03:21:50.351Z</published>
    <updated>2022-10-24T04:13:33.074Z</updated>
    
    <content type="html"><![CDATA[<h3 id="问题发生场景"><a href="#问题发生场景" class="headerlink" title="问题发生场景"></a>问题发生场景</h3><p>以下场景都建立在 maven 打 jar 包的基础上。</p><p>昨日我如往常一样，在springboot项目中新建 webapp 文件夹，然后在里面放俩空文件夹，作为项目里文件上传中转的地方。然后发现打包后程序运行时并不能找到webapp文件夹中的静态资源。查看编译后产生的 target 目录发现，webapp并没有被编译。如下图所示。</p><p><img src="https://img1.imgtp.com/2022/10/09/KyQk4s01.png" alt="webapp未编译"></p><p>而平时开发，直接通过 idea 运行的时候，却会编译 webapp 下的资源文件到 classes 目录下。如下图所示。</p><p><img src="https://img1.imgtp.com/2022/10/09/0NJ4MtZB.png" alt="idea直接运行"></p><span id="more"></span><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>如果跟我一样不愿意放弃 webapp 的使用，那么想要解决这个问题，就需要手动指定项目构建时的资源路径。</p><p>在 pom.xml 文件的 build 标签中，添加以下代码，手动指定资源路径。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/webapp<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">targetPath</span>&gt;</span>META-INF/resources<span class="tag">&lt;/<span class="name">targetPath</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/**<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ps：这样只指定webapp的路径的话，resource 中的 static 和 template 就不会被编译了。要是都想要的话，就得都手动指定。</p><p>也就是说，springboot 使用 maven编译时，默认只寻找 resources 中的静态资源，而忽略 webapp。</p><h3 id="附加"><a href="#附加" class="headerlink" title="附加"></a>附加</h3><p>自问：为什么我以前学习 spring mvc 的时候，用 webapp 文件夹存放静态资源没有任何问题呢？</p><p>自答：非要说 springboot 和 spring mvc 直观上有哪里不太一样的话，那就是打包方式了。以前学习 spring mvc 的时候，都是打 war 包，然后部署到自己的 tomcat 服务器上。静态资源放在 webapp 中，而我似乎也一直是这么用的。但是当我学了spring boot后，项目都是在本地的idea直接运行，并没有正儿八经打包，然后手动部署过。因为 idea 自身会编译 webapp 下的文件，所以一直没有发现过问题。</p><p>所以另一种解决方案就是把 spring boot 打成 war 包。</p><h3 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h3><p>究其原因还是项目打成 jar 包和 war 包的区别。这里采用网上的描述。</p><ul><li><p>jar文件包括java普通类、资源文件和普通文件，在maven中即是打包 src&#x2F;main&#x2F;java 和 src&#x2F;main&#x2F;resources 资源文件夹下的所有文件。在打包的时候会自动生成 META-INF 文件夹，用于存储 maven 的 pom 信息和 MANIFEST.MF 文件。（未包含 webapp 文件夹）</p></li><li><p>war文件包含全部的web应用程序，即所有的java类，配置信息和jsp、js等静态资源。（也就是说 webapp 文件夹也包含了）</p></li></ul><p>或许这就是为什么学习 spring mvc 的时候我还在前后端一体， 而学习 spring boot 后却下意识的用起了前后端分离吧。码农的直觉？</p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;问题发生场景&quot;&gt;&lt;a href=&quot;#问题发生场景&quot; class=&quot;headerlink&quot; title=&quot;问题发生场景&quot;&gt;&lt;/a&gt;问题发生场景&lt;/h3&gt;&lt;p&gt;以下场景都建立在 maven 打 jar 包的基础上。&lt;/p&gt;
&lt;p&gt;昨日我如往常一样，在springboot项目中新建 webapp 文件夹，然后在里面放俩空文件夹，作为项目里文件上传中转的地方。然后发现打包后程序运行时并不能找到webapp文件夹中的静态资源。查看编译后产生的 target 目录发现，webapp并没有被编译。如下图所示。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img1.imgtp.com/2022/10/09/KyQk4s01.png&quot; alt=&quot;webapp未编译&quot;&gt;&lt;/p&gt;
&lt;p&gt;而平时开发，直接通过 idea 运行的时候，却会编译 webapp 下的资源文件到 classes 目录下。如下图所示。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img1.imgtp.com/2022/10/09/0NJ4MtZB.png&quot; alt=&quot;idea直接运行&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="小问题" scheme="https://blog.kahvia.cn/categories/%E5%B0%8F%E9%97%AE%E9%A2%98/"/>
    
    
    <category term="Springboot" scheme="https://blog.kahvia.cn/tags/Springboot/"/>
    
  </entry>
  
  <entry>
    <title>MicroService-Eureka</title>
    <link href="https://blog.kahvia.cn/2022/10/05/MicroserviceEureka.html"/>
    <id>https://blog.kahvia.cn/2022/10/05/MicroserviceEureka.html</id>
    <published>2022-10-05T06:36:11.655Z</published>
    <updated>2022-10-24T04:13:33.066Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Eureka"><a href="#Eureka" class="headerlink" title="Eureka"></a>Eureka</h3><p>微服务的注册中心。</p><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><p>1.添加依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.应用启动入口标注@EnableEurekaServer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EurekaServerDemoApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(EurekaServerDemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.在 application.yml 中配置相关信息</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span> </span><br><span class="line">    <span class="attr">name:</span> <span class="string">eurekaServer</span> <span class="comment"># 应用自己的名称，会在eureka中注册后显示</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost/eureka</span> <span class="comment"># eureka的服务端地址</span></span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><p>1.添加依赖(若是依赖管理中没有客户端的版本，则需要像下面这样手动添加，版本最好跟服务端保持一致)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.在 application.yml 中配置相关信息</p><p>修改端口和应用名称，eureka的服务端地址保持不变。</p><h3 id="远程调用"><a href="#远程调用" class="headerlink" title="远程调用"></a>远程调用</h3><p>服务的远程调用包含两个客户端：调用服务的是消费者，被调用服务的是提供者。一个客户端可用同时是消费者和提供者。</p><p>远程调用服务可使用 RestTemplate 类的实例的 getObject 方法。</p><p>比如，我写一个工具类。将构建 RestTemplate 实体的工厂函数注册为 bean。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.imageservice.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在有需要的地方自动装配一个 RestTemplate 对象，调用它的各种请求方法就行了。post示例如下。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.imageservice.controller;</span><br><span class="line"><span class="keyword">import</span> cn.kahvia.imageservice.pojo.UploadResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.FileSystemResource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpEntity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpHeaders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.LinkedMultiValueMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.MultiValueMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/image&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImageController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RestTemplate restTemplate;</span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">uploadImg</span><span class="params">(MultipartFile file, HttpServletRequest request)</span>&#123;</span><br><span class="line">        String path=request.getServletContext().getRealPath(<span class="string">&quot;&quot;</span>);<span class="comment">//获取当前servlet上下文的绝对路径</span></span><br><span class="line"></span><br><span class="line">        File temp=<span class="keyword">new</span> <span class="title class_">File</span>(path,file.getOriginalFilename());<span class="comment">//在这个路径下新建一个临时文件temp</span></span><br><span class="line">        <span class="keyword">try</span> &#123;<span class="comment">//接受用户上传的文件，往temp中输出</span></span><br><span class="line">            InputStream inputStream=file.getInputStream();</span><br><span class="line">            FileOutputStream fileOutputStream=<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(temp);</span><br><span class="line">            BufferedOutputStream bufferedOutputStream=<span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(fileOutputStream);</span><br><span class="line">            <span class="type">int</span> n=<span class="number">0</span>;</span><br><span class="line">            <span class="type">byte</span> b[] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];<span class="comment">//1024个字节，也就1024byte，即1kb</span></span><br><span class="line">            <span class="keyword">while</span> ((n=inputStream.read(b))!=-<span class="number">1</span>)<span class="comment">//read(b)，是说从输入流中读取“b的大小”这么多的数据到b中，并返回读取的字节个数，-1代表读取完了</span></span><br><span class="line">            &#123;</span><br><span class="line">                bufferedOutputStream.write(b);<span class="comment">//把读取到的的，存放在b中的数据写入到输出流指向的文件中</span></span><br><span class="line">            &#125;</span><br><span class="line">            bufferedOutputStream.flush();<span class="comment">//刷新缓存区，刷新后，缓冲输出流指向的底层输入流，即fileOutputStream会立即将缓存的内容写入目的地</span></span><br><span class="line">            bufferedOutputStream.close();<span class="comment">//先关闭上层输出流</span></span><br><span class="line">            inputStream.close();<span class="comment">//再关闭底层输出流。按理说关了上层，底层也会自动关。</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//定义一个空的map，用来存储请求第三方接口所需的数据</span></span><br><span class="line">        MultiValueMap&lt;String,Object&gt; map= <span class="keyword">new</span> <span class="title class_">LinkedMultiValueMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//利用刚刚生成的临时文件，创建文件系统资源</span></span><br><span class="line">        FileSystemResource fileSystemResource=<span class="keyword">new</span> <span class="title class_">FileSystemResource</span>(temp);</span><br><span class="line">        <span class="comment">//添加到数据map中，第三方所需的参数名为image</span></span><br><span class="line">        map.add(<span class="string">&quot;image&quot;</span>,fileSystemResource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置请求头，包括访问的浏览器，和请求体内容固定类型，传输文件要选择表单数据&quot;multipart/form-data&quot;</span></span><br><span class="line">        <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">        headers.add(<span class="string">&quot;user-agent&quot;</span>, <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36&quot;</span>);</span><br><span class="line">        headers.add(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;multipart/form-data&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//生成http请求</span></span><br><span class="line">        HttpEntity&lt;MultiValueMap&lt;String, Object&gt;&gt; entity=<span class="keyword">new</span> <span class="title class_">HttpEntity</span>&lt;&gt;( map,headers);</span><br><span class="line">        <span class="comment">//发送http请求，返回目标对象。返回的json数据会自动封装为目标对象。</span></span><br><span class="line">        UploadResult uploadResult= restTemplate.postForObject(<span class="string">&quot;https://xxxxxx/api/upload&quot;</span>,entity,UploadResult.class);</span><br><span class="line">        temp.delete();<span class="comment">//删除中转文件</span></span><br><span class="line">        System.out.println(uploadResult.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>为 RestTemplate 的工厂函数添加 @LoadBalanced注解</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.kahvia.imageservice.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateUtil</span> &#123;</span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>原理：远程调用其它服务端的接口时，发出的请求会被拦截，然后根据请求的地址获取主机名（如果是eureka服务获取到的就是服务名），获取到服务名后再去eureka注册中心中取得对应服务名的所有服务端地址，根据负载均衡轮询或者随机的规则选取一个合适的地址，替换请求的地址中的服务名后，再放行，从而实现负载均衡。</p><h3 id="负载均衡的策略"><a href="#负载均衡的策略" class="headerlink" title="负载均衡的策略"></a>负载均衡的策略</h3><ul><li>RoundRobinRule：简单的轮询。Ribbon默认策略。</li><li>ZoneAvoidanceRule：以区域为基础，进行服务器的选择。使用Zone进行分类。</li><li>RandomRule：随机。</li><li>RetryRule：重连。</li><li>AvailabilityFilteringRule，BestAvailableRule，WeightedResponseTimeRule等</li></ul><p>全局策略</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局配置，对所有微服务有效</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateUtil</span> &#123;</span><br><span class="line">    <span class="meta">@LoadBalanced</span><span class="comment">//使用负载均衡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> IRule <span class="title function_">setBalanceRule</span><span class="params">()</span>&#123;<span class="comment">//设置策略</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BestAvailableRule</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>局部策略</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">UserService:</span> <span class="comment">#为某个微服务配置负载均衡的规则</span></span><br><span class="line">  <span class="attr">ribbon:</span></span><br><span class="line">    <span class="attr">NFLoadBalancerRuleClassName:</span> <span class="string">com.netflix.loadbalancer.RandomRule</span></span><br></pre></td></tr></table></figure><h3 id="Ribbon修改饥饿加载"><a href="#Ribbon修改饥饿加载" class="headerlink" title="Ribbon修改饥饿加载"></a>Ribbon修改饥饿加载</h3><p>Ribbon默认是懒加载，也就是说，Ribbon提供的负载均衡的服务 LoadBalancerClient 并不会随着服务端启动而启动。第一次请求远程调用时，会初始化负载均衡服务，所以第一次会比较慢。</p><p>如果想要让负载均衡服务随着服务端启动而启动，就需要设置饥饿加载。在 application.yml 文件中配置饥饿加载。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ribbon:</span></span><br><span class="line">  <span class="attr">eager-load:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#开启饥饿加载，减少第一次远程调用的时间</span></span><br><span class="line">    <span class="attr">clients:</span> <span class="string">UserService</span> <span class="comment">#饥饿加载的名称,多个则换行以-开头分隔</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;Eureka&quot;&gt;&lt;a href=&quot;#Eureka&quot; class=&quot;headerlink&quot; title=&quot;Eureka&quot;&gt;&lt;/a&gt;Eureka&lt;/h3&gt;&lt;p&gt;微服务的注册中心。&lt;/p&gt;
&lt;h3 id=&quot;服务端&quot;&gt;&lt;a href=&quot;#服务端&quot; class=&quot;headerlink&quot; title=&quot;服务端&quot;&gt;&lt;/a&gt;服务端&lt;/h3&gt;&lt;p&gt;1.添加依赖&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.cloud&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-cloud-starter-netflix-eureka-server&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;2.应用启动入口标注@EnableEurekaServer&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@EnableEurekaServer&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@SpringBootApplication&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;EurekaServerDemoApplication&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title function_&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String[] args)&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        SpringApplication.run(EurekaServerDemoApplication.class, args);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;3.在 application.yml 中配置相关信息&lt;/p&gt;
&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;server:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;port:&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;spring:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;application:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;name:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;eurekaServer&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# 应用自己的名称，会在eureka中注册后显示&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;eureka:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;client:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;service-url:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;attr&quot;&gt;defaultZone:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;http://localhost/eureka&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# eureka的服务端地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="MicroService" scheme="https://blog.kahvia.cn/tags/MicroService/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-TextFormField</title>
    <link href="https://blog.kahvia.cn/2022/10/01/FlutterTextFormField.html"/>
    <id>https://blog.kahvia.cn/2022/10/01/FlutterTextFormField.html</id>
    <published>2022-10-01T03:01:39.421Z</published>
    <updated>2022-10-24T04:13:33.053Z</updated>
    
    <content type="html"><![CDATA[<h3 id="TextFormField"><a href="#TextFormField" class="headerlink" title="TextFormField"></a>TextFormField</h3><ul><li>decoration：使用 InputDecoration 来创建文本框</li><li>controller：指定 TextEditingController 对象，可以通过这个对象来获取文本框的值</li></ul><h4 id="InputDecoration"><a href="#InputDecoration" class="headerlink" title="InputDecoration"></a>InputDecoration</h4><ul><li>focusedBorder：文本框聚焦的时候的边框样式</li><li>disabledBorder：禁止输入时</li><li>enabledBorder：允许选中时</li><li>contentPadding：文本区实际上是由 InputDecoration 创建的，而此处的 padding 就是设置的这个文本区的 padding</li><li>border：设置为 Border.none 可以不渲染边框。但是常常会造成文本框内容不能居中。</li><li>hintText：输入框的提示字段，类似于 html 中的 placeholder</li></ul><p>ps：想要输入框的内容正常的垂直居中，就需要边框，不想要样式的话，可以设置边框为透明色，宽度为0。除此之外，还需要设置 contentPadding 为0才能保证绝对垂直居中。</p><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">TextFormField(</span><br><span class="line">  decoration: <span class="keyword">const</span> InputDecoration(</span><br><span class="line">    focusedBorder: OutlineInputBorder(</span><br><span class="line">        borderSide: BorderSide(width: <span class="number">0</span>, color: Colors.transparent)),</span><br><span class="line">    disabledBorder: OutlineInputBorder(</span><br><span class="line">        borderSide: BorderSide(width: <span class="number">0</span>, color: Colors.transparent)),</span><br><span class="line">    enabledBorder: OutlineInputBorder(</span><br><span class="line">        borderSide: BorderSide(width: <span class="number">0</span>, color: Colors.transparent)),</span><br><span class="line">    contentPadding: EdgeInsets.symmetric(vertical: <span class="number">0</span>),</span><br><span class="line">    hintText: <span class="string">&quot;消息&quot;</span>,</span><br><span class="line">  ),</span><br><span class="line">  controller: textEditingController,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;TextFormField&quot;&gt;&lt;a href=&quot;#TextFormField&quot; class=&quot;headerlink&quot; title=&quot;TextFormField&quot;&gt;&lt;/a&gt;TextFormField&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;decoration：使用 InputD</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-购物小测试</title>
    <link href="https://blog.kahvia.cn/2022/09/29/FlutterGoodsStoreDemo.html"/>
    <id>https://blog.kahvia.cn/2022/09/29/FlutterGoodsStoreDemo.html</id>
    <published>2022-09-29T11:29:15.301Z</published>
    <updated>2022-10-24T04:13:33.029Z</updated>
    
    <content type="html"><![CDATA[<p> 在学习 Provider 的时候，我在 flutter 的官方小教程中，看到了一个 demo，有关购买商品，加入购物车的。刚学习 Provider 的时候，很多地方不明白，所以那个案例也没有能够理解。</p><p>今天的我已经能使用 Navigator 和 Provider 的知识了。利用我已有的知识，可以大概模仿出官方 demo 的样子了。</p><h3 id="路由分析"><a href="#路由分析" class="headerlink" title="路由分析"></a>路由分析</h3><p>这个 demo 涉及到三个页面，第一个是登录界面，第二个是商品界面，第三个是购物车界面。</p><p>分别命名为：Login, Catalog, Cart</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/Login.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/Catalog.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/Cart.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> routes=&#123;</span><br><span class="line">  <span class="string">&#x27;login&#x27;</span>:(context) =&gt; <span class="keyword">const</span> Login(),</span><br><span class="line">  <span class="string">&quot;catalog&quot;</span>:(context) =&gt; <span class="keyword">const</span> Catalog(),</span><br><span class="line">  <span class="string">&quot;cart&quot;</span>:(context) =&gt; <span class="keyword">const</span> Cart(),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="共享数据"><a href="#共享数据" class="headerlink" title="共享数据"></a>共享数据</h3><p>建立数据模型</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GoodsModel</span> <span class="keyword">extends</span> <span class="title">ChangeNotifier</span></span>&#123;<span class="comment">//共享数据的数据模型</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _itemNames = [<span class="comment">//模拟数据，商品名称</span></span><br><span class="line">    <span class="string">&#x27;Code Smell&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Control Flow&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Interpreter&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Recursion&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sprint&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Heisenbug&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Spaghetti&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Hydra Code&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Off-By-One&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Scope&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Callback&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Closure&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Automata&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Bit Shift&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Currying&#x27;</span>,</span><br><span class="line">  ];</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">bool</span>&gt; _isSelected=<span class="built_in">List</span>.generate(<span class="number">15</span>, (index) =&gt; <span class="keyword">false</span>);<span class="comment">//都设置为未加入购物车</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; _selectedItems=[];<span class="comment">//已选中的商品名称</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">List</span> <span class="keyword">get</span> itemNames=&gt;_itemNames;<span class="comment">//暴露以上私有成员变量</span></span><br><span class="line">  <span class="built_in">List</span> <span class="keyword">get</span> selectedItems=&gt;_selectedItems;</span><br><span class="line">  <span class="built_in">List</span> <span class="keyword">get</span> isSelected=&gt;_isSelected;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> selectItem(<span class="built_in">int</span> id)&#123;<span class="comment">//加入购物车</span></span><br><span class="line">    _selectedItems.add(_itemNames[id]);</span><br><span class="line">    _isSelected[id]=<span class="keyword">true</span>;</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> unselectItem(<span class="built_in">int</span> id)&#123;<span class="comment">//移出购物车</span></span><br><span class="line">    _selectedItems.remove(_itemNames[id]);</span><br><span class="line">    _isSelected[id]=<span class="keyword">false</span>;</span><br><span class="line">    notifyListeners();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将数据模型放置在高级节点上，使其子孙组件都能访问共享数据。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyApp(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ChangeNotifierProvider(<span class="comment">//使用共享数据</span></span><br><span class="line">      create: (context)=&gt;GoodsModel(),</span><br><span class="line">      child: MaterialApp(</span><br><span class="line">        title: <span class="string">&quot;Store&quot;</span>,</span><br><span class="line">        debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">        routes: routes,<span class="comment">//设置路由</span></span><br><span class="line">        initialRoute: <span class="string">&#x27;login&#x27;</span>,<span class="comment">//默认路由，即app首页</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h3><p>简单的登录界面实现。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Login(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(<span class="comment">//标准结构</span></span><br><span class="line">      body: Center(<span class="comment">//整体居中，当然了，只是它的子组件居中，水平和垂直</span></span><br><span class="line">        child: Container(<span class="comment">//有子组件则匹配子组件的大小，没有子组件则看父级有无传递约束，有约束则都尽可能大，如果这个约束是无限，那就尽可能小。自己设定的宽高会覆盖前面所说的大小。</span></span><br><span class="line">          padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">50</span>),<span class="comment">//加个内边距</span></span><br><span class="line">          color: Colors.white70,</span><br><span class="line">          child: Column(<span class="comment">//Column会占满可用空间</span></span><br><span class="line">            mainAxisAlignment: MainAxisAlignment.center,<span class="comment">//想让登录信息的部分居中就要这样做设置，因为上面的Center只是让Column的父级居中了</span></span><br><span class="line">              children: [</span><br><span class="line">                <span class="keyword">const</span> Text(</span><br><span class="line">                  <span class="string">&#x27;Welcome&#x27;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                    color: Colors.black,</span><br><span class="line">                    fontSize: <span class="number">30</span>,</span><br><span class="line">                    fontWeight: FontWeight.bold,<span class="comment">//标题加粗</span></span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                TextFormField(</span><br><span class="line">                  decoration: <span class="keyword">const</span> InputDecoration(</span><br><span class="line">                    hintText: <span class="string">&#x27;Username&#x27;</span>,<span class="comment">//设置占位信息</span></span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                TextFormField(</span><br><span class="line">                  decoration: <span class="keyword">const</span> InputDecoration(</span><br><span class="line">                    hintText: <span class="string">&#x27;Password&#x27;</span>,</span><br><span class="line">                  ),</span><br><span class="line">                  obscureText: <span class="keyword">true</span>,<span class="comment">//模糊文本，也就是隐藏文本信息，密码框嘛</span></span><br><span class="line">                ),</span><br><span class="line">                <span class="keyword">const</span> SizedBox(<span class="comment">//占位的空白组件</span></span><br><span class="line">                  height: <span class="number">24</span>,</span><br><span class="line">                ),</span><br><span class="line">                ElevatedButton(<span class="comment">//普通的按钮</span></span><br><span class="line">                  onPressed: () &#123;</span><br><span class="line">                    Navigator.pushNamed(context, <span class="string">&#x27;catalog&#x27;</span>);<span class="comment">//登录跳转</span></span><br><span class="line">                  &#125;,</span><br><span class="line">                  style: ButtonStyle(</span><br><span class="line">                    backgroundColor: MaterialStateProperty.all(Colors.black)<span class="comment">//设置背景色</span></span><br><span class="line">                  ),</span><br><span class="line">                  child: <span class="keyword">const</span> Text(<span class="string">&#x27;ENTER&#x27;</span>),</span><br><span class="line">                )</span><br><span class="line">              ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/29/iVZdZmjK.png" alt="登录界面"></p><h3 id="Catalog"><a href="#Catalog" class="headerlink" title="Catalog"></a>Catalog</h3><p>商品目录。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/main.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:provider/provider.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Catalog</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Catalog(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; itemNames = context.read&lt;GoodsModel&gt;().itemNames <span class="keyword">as</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;;<span class="comment">//获取共享数据中的商品名称</span></span><br><span class="line">    <span class="comment">//根据商品名称生成每一行的商品信息。包括了商品的图片（这里用随机颜色代替），商品id，商品名称。商品类是自定义的。</span></span><br><span class="line">    <span class="built_in">List</span>&lt;Good&gt; goods=<span class="built_in">List</span>.generate(itemNames.length, (index) =&gt; Good(color: Colors.primaries[index],id: index,name: itemNames[index],));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        backgroundColor: Colors.black,</span><br><span class="line">        title: <span class="keyword">const</span> Text(<span class="string">&quot;Catalog&quot;</span>),</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line">        actions: [IconButton(</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              Navigator.pushNamed(context, <span class="string">&#x27;cart&#x27;</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            icon: <span class="keyword">const</span> Icon(Icons.shopping_cart)</span><br><span class="line">        )],</span><br><span class="line">      ),</span><br><span class="line">      body: GridView(<span class="comment">//这里之所以使用网格列表，是因为网格列表可以滚动，且设置垂直间距更方便</span></span><br><span class="line">        gridDelegate: <span class="keyword">const</span> SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">          crossAxisCount: <span class="number">1</span>,<span class="comment">//一列</span></span><br><span class="line">          mainAxisSpacing: <span class="number">0</span>,<span class="comment">//每一行之间的距离</span></span><br><span class="line">          mainAxisExtent: <span class="number">80</span><span class="comment">//每一行的高度</span></span><br><span class="line">        ),</span><br><span class="line">        children: goods,<span class="comment">//刚刚生成是商品们</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Good</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//自定义的商品组件</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> id;<span class="comment">//商品id</span></span><br><span class="line">  <span class="keyword">final</span> Color color;<span class="comment">//商品图片（颜色替代）</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> name;<span class="comment">//商品名称</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> Good(&#123;Key? key, <span class="keyword">required</span> <span class="keyword">this</span>.color, <span class="keyword">required</span> <span class="keyword">this</span>.id, <span class="keyword">required</span> <span class="keyword">this</span>.name&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">bool</span> selected=context.watch&lt;GoodsModel&gt;().isSelected[id];<span class="comment">//确认商品是否选中再初始化</span></span><br><span class="line">    <span class="keyword">return</span>  Padding(</span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">16</span>,vertical: <span class="number">8</span>),</span><br><span class="line">      child: Row(<span class="comment">//每个商品就是一行</span></span><br><span class="line">        <span class="comment">// mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span></span><br><span class="line">        children: [<span class="comment">//一行中的所有列</span></span><br><span class="line">          Container(<span class="comment">//颜色块</span></span><br><span class="line">            width: <span class="number">50</span>,</span><br><span class="line">            height: <span class="number">50</span>,</span><br><span class="line">            color: color,</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">const</span> SizedBox(width: <span class="number">24</span>),<span class="comment">//空白块分隔</span></span><br><span class="line">           Expanded(<span class="comment">//拓展区，自动占满剩余未分配区域</span></span><br><span class="line">            child: Text(name,style: <span class="keyword">const</span> TextStyle(</span><br><span class="line">                fontSize: <span class="number">24</span></span><br><span class="line">            ),),</span><br><span class="line">          ),</span><br><span class="line">          TextButton(<span class="comment">//添加购物车按钮</span></span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span>(selected==<span class="keyword">true</span>)&#123;<span class="comment">//移出购物车</span></span><br><span class="line">                selected=!selected;</span><br><span class="line">                context.read&lt;GoodsModel&gt;().unselectItem(id);</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span>&#123;<span class="comment">//加入购物车</span></span><br><span class="line">                selected=!selected;</span><br><span class="line">                context.read&lt;GoodsModel&gt;().selectItem(id);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: selected</span><br><span class="line">                ?<span class="keyword">const</span> Icon(Icons.check,size: <span class="number">20</span>,)<span class="comment">//已经选中，则变成勾勾图标</span></span><br><span class="line">                :<span class="keyword">const</span> Text(<span class="comment">//未选中，则文字ADD</span></span><br><span class="line">              <span class="string">&quot;ADD&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.black,</span><br><span class="line">                fontSize: <span class="number">20</span></span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">const</span> SizedBox(width: <span class="number">24</span>),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/29/XUcRuMDR.png" alt="商品界面"></p><h3 id="Cart"><a href="#Cart" class="headerlink" title="Cart"></a>Cart</h3><p>购物车。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:dayly/main.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:flutter/material.dart&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;package:provider/provider.dart&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cart</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Cart(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        backgroundColor: Colors.black,</span><br><span class="line">        title: <span class="keyword">const</span> Text(<span class="string">&quot;Cart&quot;</span>),</span><br><span class="line">        centerTitle: <span class="keyword">true</span>,</span><br><span class="line">      ),</span><br><span class="line">      body: MyCart(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyCart</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyCart(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; texts=context.watch&lt;GoodsModel&gt;().selectedItems <span class="keyword">as</span> <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;;<span class="comment">//获取共享数据中已经选择的商品</span></span><br><span class="line">    <span class="built_in">List</span>&lt;Text&gt; goods=<span class="built_in">List</span>.generate(texts.length, (index) =&gt; Text(<span class="comment">//生成购物车清单</span></span><br><span class="line">        texts[index],</span><br><span class="line">      style: <span class="keyword">const</span> TextStyle(</span><br><span class="line">        fontSize: <span class="number">30</span></span><br><span class="line">      ),</span><br><span class="line">    ));</span><br><span class="line">    <span class="built_in">int</span> price=texts.length*<span class="number">42</span>;<span class="comment">//每件商品按42美元计算</span></span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.orange,</span><br><span class="line">      child: Padding(</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">20</span>,vertical: <span class="number">16</span>),</span><br><span class="line">        child: Column(</span><br><span class="line">          children: [</span><br><span class="line">            Container(</span><br><span class="line">              height: <span class="number">400</span>,</span><br><span class="line">              child: Row(</span><br><span class="line">                children: [</span><br><span class="line">                  Column(</span><br><span class="line">                    mainAxisAlignment: MainAxisAlignment.start,</span><br><span class="line">                    crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">                    children: goods,</span><br><span class="line">                  )</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            Container(</span><br><span class="line">              height: <span class="number">150</span>,</span><br><span class="line">              decoration: <span class="keyword">const</span> BoxDecoration(</span><br><span class="line">                  border: Border.symmetric(horizontal: BorderSide(</span><br><span class="line">                      style: BorderStyle.solid</span><br><span class="line">                  ))</span><br><span class="line">              ),</span><br><span class="line">              child: Row(</span><br><span class="line">                children: [</span><br><span class="line">                  <span class="keyword">const</span> SizedBox(width: <span class="number">40</span>,),</span><br><span class="line">                  <span class="keyword">const</span> Text(<span class="string">&quot;\$&quot;</span>,style: TextStyle(fontSize: <span class="number">50</span>),),</span><br><span class="line">                  Text(<span class="string">&quot;<span class="subst">$price</span>&quot;</span>,style: <span class="keyword">const</span> TextStyle(fontSize: <span class="number">50</span>),),</span><br><span class="line">                  <span class="keyword">const</span> SizedBox(width: <span class="number">50</span>,),</span><br><span class="line">                  TextButton(</span><br><span class="line">                    onPressed: ()&#123;&#125;,</span><br><span class="line">                    style: ButtonStyle(</span><br><span class="line">                      backgroundColor:MaterialStateProperty.all(Colors.white),</span><br><span class="line">                      minimumSize: MaterialStateProperty.all(<span class="keyword">const</span> Size(<span class="number">120</span>, <span class="number">50</span>))</span><br><span class="line">                    ),</span><br><span class="line">                    child: <span class="keyword">const</span> Text(<span class="string">&quot;BUY&quot;</span>),</span><br><span class="line">                  )</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/29/JQ9DN2GD.png" alt="购物车界面"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>难能可贵的综合运用</li><li>布局的思维模式和熟练度有待提升</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt; 在学习 Provider 的时候，我在 flutter 的官方小教程中，看到了一个 demo，有关购买商品，加入购物车的。刚学习 Provider 的时候，很多地方不明白，所以那个案例也没有能够理解。&lt;/p&gt;
&lt;p&gt;今天的我已经能使用 Navigator 和 Provider 的知识了。利用我已有的知识，可以大概模仿出官方 demo 的样子了。&lt;/p&gt;
&lt;h3 id=&quot;路由分析&quot;&gt;&lt;a href=&quot;#路由分析&quot; class=&quot;headerlink&quot; title=&quot;路由分析&quot;&gt;&lt;/a&gt;路由分析&lt;/h3&gt;&lt;p&gt;这个 demo 涉及到三个页面，第一个是登录界面，第二个是商品界面，第三个是购物车界面。&lt;/p&gt;
&lt;p&gt;分别命名为：Login, Catalog, Cart&lt;/p&gt;
&lt;figure class=&quot;highlight dart&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;#x27;package:dayly/Login.dart&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;#x27;package:dayly/Catalog.dart&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;#x27;package:dayly/Cart.dart&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; routes=&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&amp;#x27;login&amp;#x27;&lt;/span&gt;:(context) =&amp;gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Login(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&amp;quot;catalog&amp;quot;&lt;/span&gt;:(context) =&amp;gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Catalog(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&amp;quot;cart&amp;quot;&lt;/span&gt;:(context) =&amp;gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Cart(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="实践" scheme="https://blog.kahvia.cn/categories/%E5%AE%9E%E8%B7%B5/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-BottomNavigatorBar</title>
    <link href="https://blog.kahvia.cn/2022/09/29/FlutterBottomNavigatorBar.html"/>
    <id>https://blog.kahvia.cn/2022/09/29/FlutterBottomNavigatorBar.html</id>
    <published>2022-09-29T04:51:39.100Z</published>
    <updated>2022-10-24T04:13:33.003Z</updated>
    
    <content type="html"><![CDATA[<p>ottomNavigatorBar 是 Scaffold 组件中的，底部的导航栏。</p><h3 id="BottomNavigatorBar"><a href="#BottomNavigatorBar" class="headerlink" title="BottomNavigatorBar"></a>BottomNavigatorBar</h3><ul><li>items：BottomNavigatorBarItem（）<ul><li>label：标签名称</li><li>icon：图标</li><li>backgroundColor：背景颜色，在 BottomNavigatorBar  的type设置为BottomNavigationBarType.shifting时生效</li></ul></li><li>currentIndex：当前选项卡的索引，当前选项卡会高亮</li><li>backgroundColor：导航栏背景图片</li><li>elevation：阴影</li><li>fixedColor：选中的 item 字体颜色和图标颜色</li><li>onTap：点击选项时触发的函数，需要传入 index （点击选项的索引），（index）{xxx}，用于更新当前索引</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ottomNavigatorBar 是 Scaffold 组件中的，底部的导航栏。&lt;/p&gt;
&lt;h3 id=&quot;BottomNavigatorBar&quot;&gt;&lt;a href=&quot;#BottomNavigatorBar&quot; class=&quot;headerlink&quot; title=&quot;BottomN</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-Navigator</title>
    <link href="https://blog.kahvia.cn/2022/09/28/Navigator.html"/>
    <id>https://blog.kahvia.cn/2022/09/28/Navigator.html</id>
    <published>2022-09-28T06:02:17.390Z</published>
    <updated>2022-10-24T04:13:33.071Z</updated>
    
    <content type="html"><![CDATA[<p>Navigator用于管理路由。</p><h3 id="三种路由（省略动态路由）"><a href="#三种路由（省略动态路由）" class="headerlink" title="三种路由（省略动态路由）"></a>三种路由（省略动态路由）</h3><ul><li><p>匿名路由</p><ul><li><pre><code class="dart">Navigator.push(context, MaterialPageRoute(build:(context)=&gt;diyWidget()))<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 命名路由</span><br><span class="line"></span><br><span class="line">  * ``` dart</span><br><span class="line">    Navigator.pushNamed(context, name)</span><br></pre></td></tr></table></figure></code></pre></li><li><p>name 指创建的路由表中的 key，如下所示</p></li><li><pre><code class="dart">var routes=&#123;  &#39;home&#39;:(context)=&gt; const IndexPage(),  &#39;OfficialDemo&#39;:(context)=&gt;const OfficialDemo(),  &#39;Container&#39;:(context)=&gt;const ContainerDemo(),  &#39;ColumnRow&#39;:(context)=&gt;const ColumnAndRow(),  &#39;Flex&#39;:(context)=&gt;const FlexPage(),  &#39;Wrap&#39;:(context)=&gt;const WrapPage(),  &#39;Stack&#39;:(context)=&gt;const StackPage(),  &#39;Card&#39;:(context)=&gt;const CardPage(),  &#39;LayoutTest&#39;:(context)=&gt;const LayoutTest(),  &#39;StatefulWidget&#39;:(context)=&gt;const StatefulWidgetPage(),  &#39;Button&#39;:(context)=&gt;const ButtonPage(),  &#39;SingleChildScrollViewPage&#39;:(context)=&gt;const SingleChildScrollViewPage(),  &#39;ListView&#39;:(context)=&gt;const ListViewPage(),  &#39;GridView&#39;:(context)=&gt;const GridViewPage(),&#125;;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 路由传参</span><br><span class="line"></span><br><span class="line">* 匿名路由</span><br><span class="line"></span><br><span class="line">  * 在要跳转的页面对应的组件中，写上对应的属性，标记为 required，在跳转页面的时候，传递有关参数即可。</span><br><span class="line">  * 简单来说，就是靠页面对应组件自身的属性和构造函数来进行路由传参。</span><br><span class="line"></span><br><span class="line">* 命名路由</span><br><span class="line"></span><br><span class="line">  * ```dart</span><br><span class="line">    Navigator.pushNamed(context, name, &#123;arguments&#125;)//携带参数的路由跳转</span><br></pre></td></tr></table></figure></code></pre></li><li><p>arguments 是一个 map 对象，就像上面的路由表一样。</p></li><li><pre><code class="dart">ModalRoute.of(context).settings.arguments;//获取传递过来的arguments</code></pre></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Navigator用于管理路由。&lt;/p&gt;
&lt;h3 id=&quot;三种路由（省略动态路由）&quot;&gt;&lt;a href=&quot;#三种路由（省略动态路由）&quot; class=&quot;headerlink&quot; title=&quot;三种路由（省略动态路由）&quot;&gt;&lt;/a&gt;三种路由（省略动态路由）&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-InheritedWidget</title>
    <link href="https://blog.kahvia.cn/2022/09/26/InheritedWidget.html"/>
    <id>https://blog.kahvia.cn/2022/09/26/InheritedWidget.html</id>
    <published>2022-09-26T13:58:19.394Z</published>
    <updated>2022-10-24T04:13:33.063Z</updated>
    
    <content type="html"><![CDATA[<h3 id="InheritedWidget"><a href="#InheritedWidget" class="headerlink" title="InheritedWidget"></a>InheritedWidget</h3><ul><li>flutter中用于数据共享的组件。</li><li>创建自定义类，继承 InheritedWidget ，用这个自定义类的组件实例包裹子组件，使得子组件及其后代都可以访问自定义类实例中的共享数据。</li></ul><h3 id="自定义类"><a href="#自定义类" class="headerlink" title="自定义类"></a>自定义类</h3><p>使用 inh 简写快速生成自定义类并继承数据共享组件。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WaitingData</span> <span class="keyword">extends</span> <span class="title">InheritedWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> name; <span class="comment">//自定义共享数据，需要final前缀</span></span><br><span class="line">  <span class="keyword">const</span> WaitingData(&#123;</span><br><span class="line">    Key? key,</span><br><span class="line">    <span class="keyword">required</span> Widget child,</span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">this</span>.name</span><br><span class="line">  &#125;) : <span class="keyword">super</span>(key: key, child: child);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> WaitingData of(BuildContext context) &#123;<span class="comment">//静态方法，简化了获取共享数据的方式。不用这种就用下面这行复杂方式</span></span><br><span class="line">    <span class="keyword">final</span> WaitingData? result = context.dependOnInheritedWidgetOfExactType&lt;WaitingData&gt;();</span><br><span class="line">    <span class="keyword">assert</span>(result != <span class="keyword">null</span>, <span class="string">&#x27;No WaitingData found in context&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> result!;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">bool</span> updateShouldNotify(WaitingData old) &#123;<span class="comment">//指明什么时候重新渲染组件</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;<span class="comment">//true则当数据改变的时候，每次都重新渲染。可以写箭头函数来指明条件。</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><span id="more"></span><h3 id="自定义类实例的使用"><a href="#自定义类实例的使用" class="headerlink" title="自定义类实例的使用"></a>自定义类实例的使用</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;MyPage&gt; createState() =&gt; _MyPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyPage</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  WaitingData(</span><br><span class="line">        name: <span class="string">&quot;Kahvia!&quot;</span>,</span><br><span class="line">        child: Builder(<span class="comment">//用Builder才能获取到上下文</span></span><br><span class="line">            builder: (BuildContext centerContext)&#123;<span class="comment">//这个上下文的内容包括Builder（）外面的东西，即包含了name</span></span><br><span class="line">              <span class="keyword">return</span> Center(</span><br><span class="line">                child: Text(</span><br><span class="line">                    <span class="string">&quot;Hello,<span class="subst">$&#123;WaitingData.of(centerContext).name&#125;</span>&quot;</span>,<span class="comment">//如果用的的context，那context上下文中则没有name，会报错</span></span><br><span class="line">                    style: <span class="keyword">const</span> TextStyle(</span><br><span class="line">                      fontSize: <span class="number">25</span>,</span><br><span class="line">                      color: Colors.blue</span><br><span class="line">                    ),</span><br><span class="line">                ),</span><br><span class="line">              );</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul><li>明确上下文（context），想要获取共享数据，就需要使用<font color=#66AFE)><strong>共享数据组件的子组件的上下文</strong></font></li><li>获取上下文可以用Builder（）</li></ul>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;InheritedWidget&quot;&gt;&lt;a href=&quot;#InheritedWidget&quot; class=&quot;headerlink&quot; title=&quot;InheritedWidget&quot;&gt;&lt;/a&gt;InheritedWidget&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;flutter中用于数据共享的组件。&lt;/li&gt;
&lt;li&gt;创建自定义类，继承 InheritedWidget ，用这个自定义类的组件实例包裹子组件，使得子组件及其后代都可以访问自定义类实例中的共享数据。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;自定义类&quot;&gt;&lt;a href=&quot;#自定义类&quot; class=&quot;headerlink&quot; title=&quot;自定义类&quot;&gt;&lt;/a&gt;自定义类&lt;/h3&gt;&lt;p&gt;使用 inh 简写快速生成自定义类并继承数据共享组件。&lt;/p&gt;
&lt;figure class=&quot;highlight dart&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;WaitingData&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;InheritedWidget&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt; name; &lt;span class=&quot;comment&quot;&gt;//自定义共享数据，需要final前缀&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; WaitingData(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Key? key,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;required&lt;/span&gt; Widget child,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;required&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;) : &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(key: key, child: child);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; WaitingData of(BuildContext context) &amp;#123;&lt;span class=&quot;comment&quot;&gt;//静态方法，简化了获取共享数据的方式。不用这种就用下面这行复杂方式&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; WaitingData? result = context.dependOnInheritedWidgetOfExactType&amp;lt;WaitingData&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;assert&lt;/span&gt;(result != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;#x27;No WaitingData found in context&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result!;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;meta&quot;&gt;@override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;bool&lt;/span&gt; updateShouldNotify(WaitingData old) &amp;#123;&lt;span class=&quot;comment&quot;&gt;//指明什么时候重新渲染组件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;span class=&quot;comment&quot;&gt;//true则当数据改变的时候，每次都重新渲染。可以写箭头函数来指明条件。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-Provider</title>
    <link href="https://blog.kahvia.cn/2022/09/26/FlutterProvider.html"/>
    <id>https://blog.kahvia.cn/2022/09/26/FlutterProvider.html</id>
    <published>2022-09-26T13:57:14.479Z</published>
    <updated>2022-10-24T04:13:33.041Z</updated>
    
    <content type="html"><![CDATA[<p>Provider是第三方状态管理的库。就我目前的水平来看，它貌似能代替 StatefulWidget 和 InheritedWidget 。</p><h3 id="安装（带-表示可以自动更新）"><a href="#安装（带-表示可以自动更新）" class="headerlink" title="安装（带^表示可以自动更新）"></a>安装（带^表示可以自动更新）</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span></span><br><span class="line">  <span class="attr">provider:</span> <span class="string">^6.0.3</span></span><br></pre></td></tr></table></figure><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><ul><li><p>创建数据模型（自定义类），继承 ChangeNotifier ，暴露想要共享的数据, 以及创建可选的修改数据的方法。</p></li><li><p>创建观察者，或者说数据模型的提供者——Provider。</p><ul><li>通过Provider（）提供的数据通常是不可变的。</li><li>通过ChangeNotifierProvider（）提供的数据可以改变，并可以通过调用notifyListeners（）来更新使用到共享数据的组件。<ul><li>和 InheritedWidget 类似，包裹需要使用共享数据的子孙组件。包裹一次，子孙组件都可以作为监听者（listener）使用数据。</li><li>为 create 属性提供构造器，需要传入上下文context</li><li>child 子组件，也就是包裹的子孙组件</li></ul></li></ul></li><li><p>作为 Listener 使用共享数据。因为时常需要响应数据的变化，所以叫监听者。</p><ul><li><p>context.watch &lt; Type &gt;( ).atributeName，通过上下文的注入方法（由provider自动注入，也就是附加方法）来获取数据。</p></li><li><p>Provider.Of&lt; Type &gt;(context).atributeName, 通过Provider的静态方法来获取数据。</p></li><li><p>查看源码发现，第一种方法就是封装后的第二种方法</p></li><li><p>&#96;&#96;&#96;dart<br>T watch<T>() {<br>  return Provider.of<T>(this);<br>}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line"></span><br><span class="line">### 代码区</span><br><span class="line"></span><br><span class="line">#### 数据模型</span><br><span class="line"></span><br><span class="line">```dart</span><br><span class="line">class LikeData extends ChangeNotifier&#123;</span><br><span class="line">  int _number=520;</span><br><span class="line">  bool _liking=true;</span><br><span class="line"></span><br><span class="line">  int get number =&gt; _number;//暴露私有变量，让外部访问。</span><br><span class="line">  bool get liking =&gt; _liking;</span><br><span class="line"></span><br><span class="line">  void changeLikeState()&#123;//改变收藏状态的函数</span><br><span class="line">    if(_liking==true)&#123;</span><br><span class="line">      _liking=false;</span><br><span class="line">      _number--;</span><br><span class="line">      notifyListeners();//数据改变了，通知数据监听者（provider）去改变值</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">      _liking=true;</span><br><span class="line">      _number++;</span><br><span class="line">      notifyListeners();//数据改变了，通知数据监听者（provider）去改变值</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h4 id="观察者"><a href="#观察者" class="headerlink" title="观察者"></a>观察者</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Home(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ChangeNotifierProvider(<span class="comment">//包裹需要数据的子孙组件</span></span><br><span class="line">      create: (BuildContext context)=&gt;LikeData(),<span class="comment">//构造器构造数据模型</span></span><br><span class="line">      child: Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">          title: <span class="keyword">const</span> Text(<span class="string">&#x27;Provider&#x27;</span>),</span><br><span class="line">          leading: <span class="keyword">const</span> Icon(Icons.menu),</span><br><span class="line">          actions: <span class="keyword">const</span>[Icon(Icons.settings)],</span><br><span class="line">        ),</span><br><span class="line">        body:  MyPage(),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="监听者（使用到共享数据的那一部分）"><a href="#监听者（使用到共享数据的那一部分）" class="headerlink" title="监听者（使用到共享数据的那一部分）"></a>监听者（使用到共享数据的那一部分）</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Widget titleSection = Builder(</span><br><span class="line">    builder: (BuildContext context)=&gt;Container(<span class="comment">//自定义组件，标题部分，即头部部分</span></span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">32</span>),</span><br><span class="line">      child: Row(<span class="comment">//一行</span></span><br><span class="line">        children: [<span class="comment">//三列</span></span><br><span class="line">          Expanded(<span class="comment">//第一列，标题和副标题</span></span><br><span class="line">            child: Column(<span class="comment">//第一列有两行</span></span><br><span class="line">              crossAxisAlignment: CrossAxisAlignment.start,<span class="comment">//交叉轴方向，此处即水平方向对齐方式，在起点处对齐，即左对齐</span></span><br><span class="line">              children: [</span><br><span class="line">                <span class="keyword">const</span> Text(<span class="comment">//第一行</span></span><br><span class="line">                  <span class="string">&quot;Hello,this is Alice!&quot;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                    fontWeight: FontWeight.bold,<span class="comment">//加粗，表明主体</span></span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                Text(<span class="comment">//第二行</span></span><br><span class="line">                  <span class="string">&quot;Good evening!&quot;</span>,</span><br><span class="line">                  style: TextStyle(</span><br><span class="line">                    color: Colors.grey[<span class="number">500</span>],<span class="comment">//灰色</span></span><br><span class="line">                  ),</span><br><span class="line">                )</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">           IconButton(<span class="comment">//第二列，收藏图标</span></span><br><span class="line">             icon: Icon(context.watch&lt;LikeData&gt;().liking?Icons.star:Icons.star_border),<span class="comment">//获取共享数据的第一种方法</span></span><br><span class="line">             color: Colors.red,</span><br><span class="line">             onPressed: context.watch&lt;LikeData&gt;().changeLikeState,</span><br><span class="line">          ),</span><br><span class="line">           Text(<span class="comment">//第三列，收藏数</span></span><br><span class="line">            <span class="string">&quot;<span class="subst">$&#123;Provider.of&lt;LikeData&gt;(context).number&#125;</span>&quot;</span>,<span class="comment">//获取共享数据的第二种方法</span></span><br><span class="line">            <span class="comment">//   &quot;520&quot;</span></span><br><span class="line">          )</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h3><p>代码实现的功能和之前测试的“有状态组件”一样，都是实现收藏功能和它的收藏数变化。</p><p>不同的地方是，使用provider后，没有使用状态组件进行状态管理。但是很显然，这种共享数据的模式在多重嵌套组件下，可以更好的实现状态管理，而不用通过构造函数传递所需数据，也不需要通过手动调用 setState（）进行组件的重新渲染。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Provider是第三方状态管理的库。就我目前的水平来看，它貌似能代替 StatefulWidget 和 InheritedWidget 。&lt;/p&gt;
&lt;h3 id=&quot;安装（带-表示可以自动更新）&quot;&gt;&lt;a href=&quot;#安装（带-表示可以自动更新）&quot; class=&quot;heade</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-DataTable</title>
    <link href="https://blog.kahvia.cn/2022/09/24/DataTable.html"/>
    <id>https://blog.kahvia.cn/2022/09/24/DataTable.html</id>
    <published>2022-09-24T07:21:42.784Z</published>
    <updated>2022-10-24T04:13:32.984Z</updated>
    
    <content type="html"><![CDATA[<h3 id="DataTable"><a href="#DataTable" class="headerlink" title="DataTable"></a>DataTable</h3><ul><li>sortColumnIndex：排序的列号</li><li>sortAscending：排序方式，true为升序，false为降序，决定了排序箭头的上下，也决定了排序事件的传入值</li><li>columns：表格头部们</li><li>rows：各行数据，通常是动态生成的</li><li>详情用法见代码部分，我相信未来的我看到代码一定能秒懂。</li></ul><span id="more"></span><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span>&#123;</span><br><span class="line">  <span class="built_in">String</span> name;</span><br><span class="line">  <span class="built_in">int</span> age;</span><br><span class="line">  <span class="built_in">String</span> school;</span><br><span class="line">  <span class="built_in">bool</span> selected;</span><br><span class="line">  <span class="comment">//学生类和它的构造函数</span></span><br><span class="line">  Student(<span class="keyword">this</span>.name,<span class="keyword">this</span>.age,<span class="keyword">this</span>.school,&#123;<span class="keyword">this</span>.selected=<span class="keyword">false</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;MyPage&gt; createState() =&gt; _MyPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">bool</span> asc=<span class="keyword">true</span>;<span class="comment">//定义排序的方式，定义true为升序，false为降序</span></span><br><span class="line">  <span class="comment">//模仿接收后台的数据</span></span><br><span class="line">  <span class="built_in">List</span>&lt;Student&gt; students=[</span><br><span class="line">    Student(<span class="string">&quot;阿东&quot;</span>, <span class="number">21</span>, <span class="string">&quot;Three Gorges&quot;</span>),</span><br><span class="line">    Student(<span class="string">&quot;阿叶&quot;</span>, <span class="number">20</span>, <span class="string">&quot;Three Gorges&quot;</span>)</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  getStudentsData()&#123;<span class="comment">//生成表单数据</span></span><br><span class="line">    <span class="built_in">List</span>&lt;DataRow&gt; dataRows=[];<span class="comment">//生成空行们</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> element <span class="keyword">in</span> students) &#123;<span class="comment">//for循环添加数据</span></span><br><span class="line">      dataRows.add(DataRow(</span><br><span class="line">          selected: element.selected,<span class="comment">//这一行默认的选中状态</span></span><br><span class="line">          onSelectChanged: (selected)&#123;<span class="comment">//单击行时调用的函数，selected是当前行点击后的状态</span></span><br><span class="line">            setState(() &#123;<span class="comment">//使用setState是为了重新渲染组件</span></span><br><span class="line">              element.selected=selected!;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          cells: [<span class="comment">//cell，也就是单元格，一行数据中固定最小单位</span></span><br><span class="line">            DataCell(Text(element.name)),</span><br><span class="line">            DataCell(Text(<span class="string">&quot;<span class="subst">$&#123;element.age&#125;</span>&quot;</span>)),<span class="comment">//因为Student定义的年龄是int类型，所以要加双引号变成字符串才能作为Text的内容</span></span><br><span class="line">            DataCell(Text(element.school))</span><br><span class="line">          ]</span><br><span class="line">      ));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dataRows;<span class="comment">//返回生成好的表单数据</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> SingleChildScrollView(</span><br><span class="line">      physics: <span class="keyword">const</span> BouncingScrollPhysics(),</span><br><span class="line">      child: DataTable(</span><br><span class="line">        sortColumnIndex: <span class="number">1</span>,<span class="comment">//指定需要排序的列号，这里的1为年龄那一列。复选框的那一列不计入。</span></span><br><span class="line">        sortAscending: asc,<span class="comment">//指定排序方式，asc为上面定义的布尔值，同时它决定了排序箭头的方向，也决定了下方点击排序后产生的toBeAsc的值</span></span><br><span class="line">        columns:  [</span><br><span class="line">          <span class="keyword">const</span> DataColumn(label: Text(<span class="string">&quot;name&quot;</span>)),</span><br><span class="line">          DataColumn(</span><br><span class="line">            label: <span class="keyword">const</span> Text(<span class="string">&quot;age&quot;</span>),</span><br><span class="line">            numeric: <span class="keyword">true</span>,<span class="comment">//需要排序的列，要把列设置为数字型的列。</span></span><br><span class="line">            onSort: (<span class="built_in">int</span> index,<span class="built_in">bool</span> toBeAsc)&#123;<span class="comment">//然后定义它的排序方式，传入的是一个匿名函数，index为列号？toBeAsc是点击排序后，传入的布尔值，即是否是升序（ASC）</span></span><br><span class="line">                setState(() &#123;<span class="comment">//自然要用到setState来重新渲染组件</span></span><br><span class="line">                  asc=toBeAsc;<span class="comment">//toBeAsc是点击排序箭头后的值。如果点击前是向上的箭头，即升序(true)，那点击后这个toBeAsc的值，就是false</span></span><br><span class="line">                  <span class="keyword">if</span>(toBeAsc)&#123;<span class="comment">//排序可以看源码注释，就是给sort函数传入一个匿名函数，自己决定如何定义它们的大小。这里是compare年龄来决定大小</span></span><br><span class="line">                    students.sort((a,b) =&gt; a.age.compareTo(b.age));</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="keyword">else</span> &#123;</span><br><span class="line">                    students.sort((a,b) =&gt; b.age.compareTo(a.age));</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          ),</span><br><span class="line">          <span class="keyword">const</span> DataColumn(label: Text(<span class="string">&quot;school&quot;</span>))</span><br><span class="line">        ],</span><br><span class="line">        rows: getStudentsData(),<span class="comment">//调用函数，获取表单数据</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/24/eeefH0CF.png" alt="效果图"></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;DataTable&quot;&gt;&lt;a href=&quot;#DataTable&quot; class=&quot;headerlink&quot; title=&quot;DataTable&quot;&gt;&lt;/a&gt;DataTable&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;sortColumnIndex：排序的列号&lt;/li&gt;
&lt;li&gt;sortAscending：排序方式，true为升序，false为降序，决定了排序箭头的上下，也决定了排序事件的传入值&lt;/li&gt;
&lt;li&gt;columns：表格头部们&lt;/li&gt;
&lt;li&gt;rows：各行数据，通常是动态生成的&lt;/li&gt;
&lt;li&gt;详情用法见代码部分，我相信未来的我看到代码一定能秒懂。&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-ThirdPackage</title>
    <link href="https://blog.kahvia.cn/2022/09/18/ThirdPackage.html"/>
    <id>https://blog.kahvia.cn/2022/09/18/ThirdPackage.html</id>
    <published>2022-09-18T05:43:42.646Z</published>
    <updated>2022-10-24T04:13:33.082Z</updated>
    
    <content type="html"><![CDATA[<p> 在开发中经常要用到第三方库，而 Flutter 开发经常用的第三方库可以在<a href="https://pub.dev/">pub.dev</a>中寻找。</p><p>使用方法：</p><ol><li><p>在库存中寻找想要的包</p></li><li><p>在项目的 pubspec.yaml 中添加依赖</p></li><li><p>&#96;&#96;&#96;bash<br>flutter pub get </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. 有的时候添加依赖后保存了，就自动下载了。用不到上述命令。</span><br><span class="line"></span><br><span class="line">### dio</span><br><span class="line"></span><br><span class="line">dio，跟 Axois 差不多的东西。</span><br><span class="line"></span><br><span class="line">### card_swiper</span><br><span class="line"></span><br><span class="line">做轮播图的。</span><br><span class="line"></span><br><span class="line">```dart</span><br><span class="line">class MyPage extends StatelessWidget &#123;</span><br><span class="line">   MyPage(&#123;Key? key&#125;) : super(key: key);</span><br><span class="line">  final List&lt;String&gt; pics=[</span><br><span class="line">    &quot;images/Alice.jpg&quot;,</span><br><span class="line">    &quot;images/everyone.jpg&quot;,</span><br><span class="line">    &quot;images/dawn.jpg&quot;</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return  ListView(</span><br><span class="line">      children: [</span><br><span class="line">        Container(</span><br><span class="line">          color: Colors.black,</span><br><span class="line">          height: 300,</span><br><span class="line">          child: Swiper(</span><br><span class="line">            // itemHeight: 10,//这两个属性对于默认的轮播图布局似乎没啥用</span><br><span class="line">            // itemWidth: 10,</span><br><span class="line">            itemCount: pics.length,</span><br><span class="line">            autoplay: true,</span><br><span class="line">            pagination: SwiperPagination(),//小圆点</span><br><span class="line">            // control: SwiperControl(),//手动点击的按钮</span><br><span class="line">            viewportFraction: 0.7,</span><br><span class="line">            scale: 0.6,</span><br><span class="line">            itemBuilder: (context,index)&#123;</span><br><span class="line">              return Image.asset(pics[index],fit: BoxFit.cover,);</span><br><span class="line">            &#125;,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        Container(</span><br><span class="line">          color: Colors.black,</span><br><span class="line">          height: 300,</span><br><span class="line">          child: Swiper(</span><br><span class="line">            itemCount: pics.length,</span><br><span class="line">            pagination:const SwiperPagination(),//小圆点</span><br><span class="line">            itemWidth: 300,</span><br><span class="line">            layout: SwiperLayout.STACK,//轮播图使用stack布局的时候，itemWidth不能为空</span><br><span class="line">            itemBuilder: (context,index)&#123;</span><br><span class="line">              return Image.asset(pics[index],fit: BoxFit.cover,);</span><br><span class="line">            &#125;,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        Container(</span><br><span class="line">          color: Colors.black,</span><br><span class="line">          height: 300,</span><br><span class="line">          child: Swiper(//垂直轮播图</span><br><span class="line">            itemCount: pics.length,</span><br><span class="line">            scrollDirection: Axis.vertical,//垂直</span><br><span class="line">            pagination:const SwiperPagination(),//小圆点</span><br><span class="line">            // itemWidth: 300,</span><br><span class="line">            // layout: SwiperLayout.STACK,//垂直轮播图似乎只能用默认布局</span><br><span class="line">            itemBuilder: (context,index)&#123;</span><br><span class="line">              return Image.asset(pics[index],fit: BoxFit.cover,);</span><br><span class="line">            &#125;,</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://img1.imgtp.com/2022/09/18/qFXxXuZW.png" alt="效果图"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; 在开发中经常要用到第三方库，而 Flutter 开发经常用的第三方库可以在&lt;a href=&quot;https://pub.dev/&quot;&gt;pub.dev&lt;/a&gt;中寻找。&lt;/p&gt;
&lt;p&gt;使用方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;在库存中寻找想要的包&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-列表</title>
    <link href="https://blog.kahvia.cn/2022/09/13/FlutterList.html"/>
    <id>https://blog.kahvia.cn/2022/09/13/FlutterList.html</id>
    <published>2022-09-13T08:51:05.930Z</published>
    <updated>2022-10-24T04:13:33.038Z</updated>
    
    <content type="html"><![CDATA[<h3 id="SingleChildScrollView"><a href="#SingleChildScrollView" class="headerlink" title="SingleChildScrollView"></a>SingleChildScrollView</h3><ul><li>child</li><li>padding</li><li>scrollDirection ：滚动方向，水平（Axis.horizontal）或垂直（Axis.vertical）</li><li>reverse ：是否翻转，默认第一个组件作为滚动视图的起点</li><li>physics<ul><li>ClampingScrollPhysics ：安卓的微光效果</li><li>BouncingScrollPhysics ：ios的弹性效果</li></ul></li></ul><span id="more"></span><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Stack(</span><br><span class="line">      children: [</span><br><span class="line">        SingleChildScrollView(</span><br><span class="line">          physics: <span class="keyword">const</span> BouncingScrollPhysics(),</span><br><span class="line">          child: Column(</span><br><span class="line">            children: [</span><br><span class="line">              Card(),<span class="comment">//card中代码省略</span></span><br><span class="line">              Card(),</span><br><span class="line">              Card()</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/13/jlsFe5YR.png" alt="效果图"></p><h3 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h3><p>三种构造方法，常用的子组件有 ListTile</p><ul><li>ListView( )</li><li>ListView.builder( ) <ul><li>itemCount</li><li>itemExtent</li><li>itemBuilder</li></ul></li><li>ListView.separated( ) <ul><li>separatorBuilder ：分割线构造器</li></ul></li></ul><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Column(</span><br><span class="line">      children: [</span><br><span class="line">        demo1(),</span><br><span class="line">        demo2(),</span><br><span class="line">        demo3()</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demo1</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//默认的ListView构造</span></span><br><span class="line">  <span class="comment">// demo1(&#123;Key? key&#125;) : super(key: key);</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; tiles=<span class="built_in">List</span>.generate(<span class="number">10</span>, (index) =&gt;  ListTile(</span><br><span class="line">    title: Text(<span class="string">&quot;tile<span class="subst">$index</span>&quot;</span>),</span><br><span class="line">    subtitle: <span class="keyword">const</span> Text(<span class="string">&quot;subtitle&quot;</span>),</span><br><span class="line">    leading: <span class="keyword">const</span> Icon(Icons.account_box,size: <span class="number">40</span>,),</span><br><span class="line">    trailing: <span class="keyword">const</span> Icon(Icons.arrow_left,size: <span class="number">40</span>,),</span><br><span class="line">  ));</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.red,</span><br><span class="line">      height: <span class="number">200</span>,</span><br><span class="line">      child: ListView(</span><br><span class="line">        scrollDirection: Axis.vertical,</span><br><span class="line">        physics: <span class="keyword">const</span> BouncingScrollPhysics(),</span><br><span class="line">        children: tiles,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demo2</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//ListView的builder构造</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; tiles=<span class="built_in">List</span>.generate(<span class="number">10</span>, (index) =&gt;  ListTile(</span><br><span class="line">    title: Text(<span class="string">&quot;tile<span class="subst">$index</span>&quot;</span>),</span><br><span class="line">    subtitle: <span class="keyword">const</span> Text(<span class="string">&quot;subtitle&quot;</span>),</span><br><span class="line">    leading: <span class="keyword">const</span> Icon(Icons.account_box,size: <span class="number">40</span>,),</span><br><span class="line">    trailing: <span class="keyword">const</span> Icon(Icons.arrow_left,size: <span class="number">40</span>,),</span><br><span class="line">  ));</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.orange,</span><br><span class="line">      height: <span class="number">200</span>,</span><br><span class="line">      child: ListView.builder(</span><br><span class="line">        itemCount: <span class="number">5</span>,<span class="comment">//指定需要多少个item，按需取得</span></span><br><span class="line">        itemExtent: <span class="number">50</span>,<span class="comment">//指定item的大小，或许是高度？固定的大小会处理的更有效。</span></span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">10</span>),</span><br><span class="line">        itemBuilder: (context,index)&#123;<span class="comment">//返回单个</span></span><br><span class="line">          <span class="keyword">return</span> tiles[index];</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">demo3</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;<span class="comment">//ListView的separated构造</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; tiles=<span class="built_in">List</span>.generate(<span class="number">10</span>, (index) =&gt;  ListTile(</span><br><span class="line">    title: Text(<span class="string">&quot;tile<span class="subst">$index</span>&quot;</span>),</span><br><span class="line">    subtitle: <span class="keyword">const</span> Text(<span class="string">&quot;subtitle&quot;</span>),</span><br><span class="line">    leading: <span class="keyword">const</span> Icon(Icons.account_box,size: <span class="number">40</span>,),</span><br><span class="line">    trailing: <span class="keyword">const</span> Icon(Icons.arrow_left,size: <span class="number">40</span>,),</span><br><span class="line">  ));</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: Colors.green,</span><br><span class="line">      height: <span class="number">200</span>,</span><br><span class="line">      child: ListView.separated(</span><br><span class="line">        itemCount: tiles.length,</span><br><span class="line">        itemBuilder: (context,index)&#123;</span><br><span class="line">          <span class="keyword">return</span> tiles[index];</span><br><span class="line">        &#125;,</span><br><span class="line">        separatorBuilder: (context,index)&#123;<span class="comment">//分割线构造器</span></span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">const</span> Divider(</span><br><span class="line">            color:  Colors.red,</span><br><span class="line">            height: <span class="number">30</span>,<span class="comment">//分割线的高度，也就是两个item之间的距离</span></span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/14/bmNcz0ry.png" alt="效果图"></p><h3 id="GridView"><a href="#GridView" class="headerlink" title="GridView"></a>GridView</h3><p>三种构造方法</p><ul><li>GridView（默认）<ul><li>children（子组件）</li><li>scrollDirection（滚动方向）</li><li>gridDelegate（网格代表？或许可以理解为网格的总设置）<ul><li>SliverGridDelegateWithFixedCrossAxisCount（指定列数，子组件的宽度自适应）</li><li>SliverGridDelegateWithMaxCrossAxisExtent（指定子组件交叉轴方向的大小，列数自适应）</li></ul></li><li>各轴spacing（调整子组件之间的距离）</li></ul></li><li>GridView.count（列数固定）</li><li>GridView.extend（子组件宽度固定）</li><li>GridView.builder（动态网格布局）</li></ul><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  GridView(<span class="comment">//网格列表</span></span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">10</span>),<span class="comment">//内边距</span></span><br><span class="line">      scrollDirection: Axis.vertical,<span class="comment">//垂直滚动</span></span><br><span class="line">      physics: <span class="keyword">const</span> BouncingScrollPhysics(),<span class="comment">//弹性滚动</span></span><br><span class="line">      gridDelegate: <span class="keyword">const</span> SliverGridDelegateWithFixedCrossAxisCount(<span class="comment">//固定交叉轴方向组件数量</span></span><br><span class="line">        crossAxisCount: <span class="number">2</span>,<span class="comment">//数量</span></span><br><span class="line">        mainAxisSpacing: <span class="number">10</span>,<span class="comment">//主轴方向间距</span></span><br><span class="line">        crossAxisSpacing: <span class="number">10</span>,<span class="comment">//交叉轴方向间距</span></span><br><span class="line">        <span class="comment">// mainAxisExtent: 30//子组件主轴方向的大小</span></span><br><span class="line">        childAspectRatio: <span class="number">0.5</span><span class="comment">//子组件交叉轴方向和主轴方向的大小比例</span></span><br><span class="line">      ),</span><br><span class="line">      children: [</span><br><span class="line">        Container(color: Colors.red,),</span><br><span class="line">        Container(color: Colors.black,),</span><br><span class="line">        Container(color: Colors.green,),</span><br><span class="line">        Container(color: Colors.yellow,),</span><br><span class="line">        Container(color: Colors.orange,),</span><br><span class="line">        Container(color: Colors.grey,),</span><br><span class="line">        Container(color: Colors.red,),</span><br><span class="line">        Container(color: Colors.black,),</span><br><span class="line">        Container(color: Colors.green,),</span><br><span class="line">        Container(color: Colors.yellow,),</span><br><span class="line">        Container(color: Colors.orange,),</span><br><span class="line">        Container(color: Colors.grey,)</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/18/PnvONuDb.png" alt="效果图"></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;SingleChildScrollView&quot;&gt;&lt;a href=&quot;#SingleChildScrollView&quot; class=&quot;headerlink&quot; title=&quot;SingleChildScrollView&quot;&gt;&lt;/a&gt;SingleChildScrollView&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;child&lt;/li&gt;
&lt;li&gt;padding&lt;/li&gt;
&lt;li&gt;scrollDirection ：滚动方向，水平（Axis.horizontal）或垂直（Axis.vertical）&lt;/li&gt;
&lt;li&gt;reverse ：是否翻转，默认第一个组件作为滚动视图的起点&lt;/li&gt;
&lt;li&gt;physics&lt;ul&gt;
&lt;li&gt;ClampingScrollPhysics ：安卓的微光效果&lt;/li&gt;
&lt;li&gt;BouncingScrollPhysics ：ios的弹性效果&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-图片</title>
    <link href="https://blog.kahvia.cn/2022/09/13/FlutterPicture.html"/>
    <id>https://blog.kahvia.cn/2022/09/13/FlutterPicture.html</id>
    <published>2022-09-13T08:35:26.028Z</published>
    <updated>2022-10-24T04:13:33.045Z</updated>
    
    <content type="html"><![CDATA[<h3 id="本地图片"><a href="#本地图片" class="headerlink" title="本地图片"></a>本地图片</h3><ul><li>Image.asset（）<ul><li>Flutter项目目录下创建存储目录，比如images</li><li>在 pubspec.yaml 中按照注释进行规范配置</li><li>在代码中引用</li></ul></li></ul><h3 id="网络图片"><a href="#网络图片" class="headerlink" title="网络图片"></a>网络图片</h3><ul><li>Image.network</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;本地图片&quot;&gt;&lt;a href=&quot;#本地图片&quot; class=&quot;headerlink&quot; title=&quot;本地图片&quot;&gt;&lt;/a&gt;本地图片&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Image.asset（）&lt;ul&gt;
&lt;li&gt;Flutter项目目录下创建存储目录，比如images&lt;/li&gt;
&lt;</summary>
      
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter-Button</title>
    <link href="https://blog.kahvia.cn/2022/09/12/FlutterButton.html"/>
    <id>https://blog.kahvia.cn/2022/09/12/FlutterButton.html</id>
    <published>2022-09-12T14:49:19.415Z</published>
    <updated>2022-10-24T04:13:33.010Z</updated>
    
    <content type="html"><![CDATA[<h3 id="普通按钮（共同的属性见代码区）"><a href="#普通按钮（共同的属性见代码区）" class="headerlink" title="普通按钮（共同的属性见代码区）"></a>普通按钮（共同的属性见代码区）</h3><ul><li>TextButton（文本按钮）</li><li>ElevatedButton（凸起按钮）</li><li>OutlinedButton（轮廓按钮）</li></ul><h3 id="图标按钮"><a href="#图标按钮" class="headerlink" title="图标按钮"></a>图标按钮</h3><ul><li>IconButton<ul><li>tooltip:长按提示</li></ul></li><li>TextButton.icon()</li><li>ElevatedButton.icon()</li><li>OutlinedButton.icon()</li></ul><span id="more"></span><h3 id="按钮组"><a href="#按钮组" class="headerlink" title="按钮组"></a>按钮组</h3><ul><li>ButtonBar</li></ul><h3 id="浮动按钮"><a href="#浮动按钮" class="headerlink" title="浮动按钮"></a>浮动按钮</h3><ul><li>FloatingActionButton：要放在scaffold中，与appbar和body同级</li></ul><h3 id="回退按钮"><a href="#回退按钮" class="headerlink" title="回退按钮"></a>回退按钮</h3><ul><li>BackButton</li></ul><h3 id="关闭按钮"><a href="#关闭按钮" class="headerlink" title="关闭按钮"></a>关闭按钮</h3><ul><li>CloseButton</li></ul><p>代码区</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> Home(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: <span class="keyword">const</span> Text(<span class="string">&#x27;Work&#x27;</span>),</span><br><span class="line">        leading: <span class="keyword">const</span> Icon(Icons.menu),</span><br><span class="line">        actions: <span class="keyword">const</span>[Icon(Icons.settings)],</span><br><span class="line">      ),</span><br><span class="line">      body: <span class="keyword">const</span> MyPage(),</span><br><span class="line">      floatingActionButton: FloatingActionButton(<span class="comment">//悬浮按钮要放在Scaffold中，与appbar和body同级</span></span><br><span class="line">        tooltip: <span class="string">&quot;挖草&quot;</span>,</span><br><span class="line">        backgroundColor: Colors.orange,</span><br><span class="line">        onPressed: ()&#123;</span><br><span class="line">          <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;FloatingActionButton&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        child: <span class="keyword">const</span> Icon(Icons.live_tv),<span class="comment">//悬浮按钮中的子组件，放个icon图片</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span>  Container(</span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">2</span>),</span><br><span class="line">      child: Wrap(</span><br><span class="line">        children: [</span><br><span class="line">          TextButton(</span><br><span class="line">            style: <span class="keyword">const</span> ButtonStyle(</span><br><span class="line">            ),</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span> (kDebugMode) &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;TextButton&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: <span class="keyword">const</span> Text(</span><br><span class="line">              <span class="string">&quot;TextButton&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                  fontSize: <span class="number">25</span></span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          ElevatedButton(</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;ElevatedButton&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: <span class="keyword">const</span> Text(<span class="string">&quot;ElevatedButton&quot;</span>),</span><br><span class="line">          ),</span><br><span class="line">          OutlinedButton(</span><br><span class="line">            style:  ButtonStyle(<span class="comment">//按钮的样式</span></span><br><span class="line">              minimumSize: MaterialStateProperty.all(<span class="keyword">const</span> Size(<span class="number">400</span>,<span class="number">40</span>)),<span class="comment">//按钮最小的尺寸，按钮通常根据内容决定尺寸，故可以设定最小尺寸来决定按钮大小</span></span><br><span class="line">              foregroundColor: MaterialStateProperty.resolveWith((states)&#123;</span><br><span class="line">                <span class="keyword">if</span>(states.contains(MaterialState.pressed))&#123;<span class="comment">//当按钮的状态处于按压时</span></span><br><span class="line">                  <span class="keyword">return</span> Colors.red;<span class="comment">//前景色给出红色</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;),</span><br><span class="line">              backgroundColor: MaterialStateProperty.all(Colors.orange),</span><br><span class="line">              side: MaterialStateProperty.all(<span class="keyword">const</span> BorderSide(</span><br><span class="line">                width: <span class="number">3</span>,</span><br><span class="line">                color: Colors.green</span><br><span class="line">              )),</span><br><span class="line">              shape: MaterialStateProperty.all(<span class="keyword">const</span> StadiumBorder()),<span class="comment">//给个形状就行了，边框的颜色和宽度由side来决定</span></span><br><span class="line">              <span class="comment">// overlayColor: MaterialStateProperty.all(Colors.brown),</span></span><br><span class="line">            ),</span><br><span class="line">            onPressed: ()&#123;</span><br><span class="line">              <span class="keyword">if</span>(kDebugMode) &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;OutlinedButton&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            child: <span class="keyword">const</span> Text(</span><br><span class="line">                <span class="string">&quot;OutlinedButton&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  color: Colors.white</span><br><span class="line">                ),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">          IconButton(</span><br><span class="line">            tooltip: <span class="string">&quot;小辣鸡&quot;</span>,<span class="comment">//长按提示</span></span><br><span class="line">              onPressed: ()&#123;</span><br><span class="line">                <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">                  <span class="built_in">print</span>(<span class="string">&quot;IconButton&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              icon: <span class="keyword">const</span> Icon(Icons.favorite,color: Colors.red,)</span><br><span class="line">          ),</span><br><span class="line">          TextButton.icon(</span><br><span class="line">              onPressed: ()&#123;</span><br><span class="line">                <span class="keyword">if</span>(kDebugMode)&#123;</span><br><span class="line">                  <span class="built_in">print</span>(<span class="string">&quot;TextButton.icon&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              icon: <span class="keyword">const</span> Icon(Icons.person),</span><br><span class="line">              label: <span class="keyword">const</span> Text(<span class="string">&quot;Khvia&quot;</span>)),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img1.imgtp.com/2022/09/13/FTl5CnY0.png" alt="效果图"></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;普通按钮（共同的属性见代码区）&quot;&gt;&lt;a href=&quot;#普通按钮（共同的属性见代码区）&quot; class=&quot;headerlink&quot; title=&quot;普通按钮（共同的属性见代码区）&quot;&gt;&lt;/a&gt;普通按钮（共同的属性见代码区）&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;TextButton（文本按钮）&lt;/li&gt;
&lt;li&gt;ElevatedButton（凸起按钮）&lt;/li&gt;
&lt;li&gt;OutlinedButton（轮廓按钮）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;图标按钮&quot;&gt;&lt;a href=&quot;#图标按钮&quot; class=&quot;headerlink&quot; title=&quot;图标按钮&quot;&gt;&lt;/a&gt;图标按钮&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;IconButton&lt;ul&gt;
&lt;li&gt;tooltip:长按提示&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TextButton.icon()&lt;/li&gt;
&lt;li&gt;ElevatedButton.icon()&lt;/li&gt;
&lt;li&gt;OutlinedButton.icon()&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="知识" scheme="https://blog.kahvia.cn/categories/%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter交互实践</title>
    <link href="https://blog.kahvia.cn/2022/09/11/Flutter-test2.html"/>
    <id>https://blog.kahvia.cn/2022/09/11/Flutter-test2.html</id>
    <published>2022-09-11T12:17:07.916Z</published>
    <updated>2022-10-24T04:13:33.007Z</updated>
    
    <content type="html"><![CDATA[<h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h3><p><img src="https://img1.imgtp.com/2022/09/11/6uhrySvk.png" alt="image-20220911202033301"></p><span id="more"></span><h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  Widget titleSection = Container(<span class="comment">//自定义组件，标题部分，即头部部分</span></span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">32</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行</span></span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Expanded(<span class="comment">//第一列，标题和副标题</span></span><br><span class="line">          child: Column(<span class="comment">//第一列有两行</span></span><br><span class="line">            crossAxisAlignment: CrossAxisAlignment.start,<span class="comment">//交叉轴方向，此处即水平方向对齐方式，在起点处对齐，即左对齐</span></span><br><span class="line">            children: [</span><br><span class="line">              <span class="keyword">const</span> Text(<span class="comment">//第一行</span></span><br><span class="line">                <span class="string">&quot;Hello,this is Alice!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  fontWeight: FontWeight.bold,<span class="comment">//加粗，表明主体</span></span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              Text(<span class="comment">//第二行</span></span><br><span class="line">                <span class="string">&quot;Good evening!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  color: Colors.grey[<span class="number">500</span>],<span class="comment">//灰色</span></span><br><span class="line">                ),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">const</span> LikeWidget(),<span class="comment">//这是下面写的自定义有状态组件</span></span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget options=Container(<span class="comment">//自定义组件，操作栏部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行三列</span></span><br><span class="line">      mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Column(<span class="comment">//第一列，图标加文字描述，下同</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.call,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;CALL&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第二列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.route,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;ROUTE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第三列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.share,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;SHARE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget text=Container(<span class="comment">//自定义组件，文本区域部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">30</span>),<span class="comment">//内边距30，即四周留空</span></span><br><span class="line">    child: <span class="keyword">const</span> Text(</span><br><span class="line">      <span class="string">&quot;Something exciting happened when I got up this day. Maybe, but I am not sure about the time.&quot;</span></span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Column(</span><br><span class="line">      children: [</span><br><span class="line">        Image.asset(<span class="comment">//预设图片</span></span><br><span class="line">          <span class="string">&#x27;images/Alice.jpg&#x27;</span>,</span><br><span class="line">          <span class="comment">// width: 100,</span></span><br><span class="line">          height: <span class="number">300</span>,</span><br><span class="line">          fit: BoxFit.cover,<span class="comment">//填充方式，覆盖。</span></span><br><span class="line">        ),</span><br><span class="line">        titleSection,</span><br><span class="line">        options,</span><br><span class="line">        text</span><br><span class="line">      ],</span><br><span class="line">    ) ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LikeWidget</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;<span class="comment">//这个是有状态组件的显示部分</span></span><br><span class="line">  <span class="keyword">const</span> LikeWidget(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State&lt;LikeWidget&gt; createState() =&gt; _LikeWidgetState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_LikeWidgetState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">LikeWidget</span>&gt; </span>&#123;<span class="comment">//这个是有状态组件的状态部分</span></span><br><span class="line">  <span class="built_in">bool</span> _like=<span class="keyword">true</span>;</span><br><span class="line">  <span class="built_in">int</span> _count=<span class="number">41</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _clickLike()&#123;</span><br><span class="line">    setState(() &#123;<span class="comment">//有状态组件通过执行setState（）执行组件的重新渲染，传入的参数是一个自定义函数</span></span><br><span class="line">      <span class="keyword">if</span>(_like)&#123;</span><br><span class="line">        _like=<span class="keyword">false</span>;</span><br><span class="line">        _count--;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        _like=<span class="keyword">true</span>;</span><br><span class="line">        _count++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;<span class="comment">//写组件的内容，该咋写咋写，值换动态的就行了</span></span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      children: [</span><br><span class="line">        IconButton(</span><br><span class="line">          icon: _like?<span class="keyword">const</span> Icon(Icons.star,color: Colors.red,):<span class="keyword">const</span> Icon(Icons.star_border,color: Colors.red,),</span><br><span class="line">          onPressed: _clickLike,</span><br><span class="line">        ),</span><br><span class="line">        Text(</span><br><span class="line">          <span class="string">&quot;<span class="subst">$_count</span>&quot;</span></span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>无状态组件自身无法改变，根据我的理解，它是那种事先就决定好的内容，无法在程序运行时做更改，比如Text，Icon，IconButton</li><li>有状态组件自身可以更改，通过提前设定状态量，就可以在用户交互的时候，改变状态量，重新渲染组件，比如CheckBox，Radio</li><li>有状态组件的显示部分和状态部分是分开的，build在状态部分中</li><li>有状态组件通过setState（）函数来重新渲染组件</li></ul>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;效果图&quot;&gt;&lt;a href=&quot;#效果图&quot; class=&quot;headerlink&quot; title=&quot;效果图&quot;&gt;&lt;/a&gt;效果图&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://img1.imgtp.com/2022/09/11/6uhrySvk.png&quot; alt=&quot;image-20220911202033301&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="实践" scheme="https://blog.kahvia.cn/categories/%E5%AE%9E%E8%B7%B5/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutter布局实践</title>
    <link href="https://blog.kahvia.cn/2022/09/11/Flutter-test1.html"/>
    <id>https://blog.kahvia.cn/2022/09/11/Flutter-test1.html</id>
    <published>2022-09-11T08:56:36.347Z</published>
    <updated>2022-10-24T04:13:32.999Z</updated>
    
    <content type="html"><![CDATA[<h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h3><p><img src="https://img1.imgtp.com/2022/09/11/6moImF8u.png" alt="效果图"></p><span id="more"></span><h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  MyPage(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  Widget titleSection = Container(<span class="comment">//自定义组件，标题部分，即头部部分</span></span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">32</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行</span></span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Expanded(<span class="comment">//第一列，标题和副标题</span></span><br><span class="line">          child: Column(<span class="comment">//第一列有两行</span></span><br><span class="line">            crossAxisAlignment: CrossAxisAlignment.start,<span class="comment">//交叉轴方向，此处即水平方向对齐方式，在起点处对齐，即左对齐</span></span><br><span class="line">            children: [</span><br><span class="line">              <span class="keyword">const</span> Text(<span class="comment">//第一行</span></span><br><span class="line">                <span class="string">&quot;Hello,this is Alice!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  fontWeight: FontWeight.bold,<span class="comment">//加粗，表明主体</span></span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              Text(<span class="comment">//第二行</span></span><br><span class="line">                <span class="string">&quot;Good evening!&quot;</span>,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  color: Colors.grey[<span class="number">500</span>],<span class="comment">//灰色</span></span><br><span class="line">                ),</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">const</span> Icon(<span class="comment">//第二列，收藏图标</span></span><br><span class="line">          Icons.star,</span><br><span class="line">          color: Colors.red,</span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">const</span> Text(<span class="comment">//第三列，收藏数</span></span><br><span class="line">          <span class="string">&quot;520&quot;</span>,</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget options=Container(<span class="comment">//自定义组件，操作栏部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    child: Row(<span class="comment">//一行三列</span></span><br><span class="line">      mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">      children: [<span class="comment">//三列</span></span><br><span class="line">        Column(<span class="comment">//第一列，图标加文字描述，下同</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.call,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;CALL&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第二列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.route,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;ROUTE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        Column(<span class="comment">//第三列</span></span><br><span class="line">          children: <span class="keyword">const</span> [</span><br><span class="line">            Icon(</span><br><span class="line">              Icons.share,</span><br><span class="line">              color: Colors.blue,</span><br><span class="line">            ),</span><br><span class="line">            Text(</span><br><span class="line">              <span class="string">&quot;SHARE&quot;</span>,</span><br><span class="line">              style: TextStyle(</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">              ),</span><br><span class="line">            )</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  Widget text=Container(<span class="comment">//自定义组件，文本区域部分</span></span><br><span class="line">    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">10</span>),</span><br><span class="line">    padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">30</span>),<span class="comment">//内边距30，即四周留空</span></span><br><span class="line">    child: <span class="keyword">const</span> Text(</span><br><span class="line">      <span class="string">&quot;Something exciting happened when I got up this day. Maybe, but I am not sure about the time.&quot;</span></span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Column(</span><br><span class="line">      children: [</span><br><span class="line">        Image.asset(<span class="comment">//预设图片</span></span><br><span class="line">          <span class="string">&#x27;images/Alice.jpg&#x27;</span>,</span><br><span class="line">          <span class="comment">// width: 100,</span></span><br><span class="line">          height: <span class="number">300</span>,</span><br><span class="line">          fit: BoxFit.cover,<span class="comment">//填充方式，覆盖。</span></span><br><span class="line">        ),</span><br><span class="line">        titleSection,</span><br><span class="line">        options,</span><br><span class="line">        text</span><br><span class="line">      ],</span><br><span class="line">    ) ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li>Flutter 的布局用熟悉了感觉很舒服</li><li>使用预设图片需要存放在项目的images文件夹中，然后在 pubsepc.yaml 中进行相关的设置。最后在代码中用<code>Image.asset</code>进行引用</li><li>布局前要好好思考才是</li></ul>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;效果图&quot;&gt;&lt;a href=&quot;#效果图&quot; class=&quot;headerlink&quot; title=&quot;效果图&quot;&gt;&lt;/a&gt;效果图&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://img1.imgtp.com/2022/09/11/6moImF8u.png&quot; alt=&quot;效果图&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="实践" scheme="https://blog.kahvia.cn/categories/%E5%AE%9E%E8%B7%B5/"/>
    
    
    <category term="Flutter" scheme="https://blog.kahvia.cn/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>自动连接校园网（三峡大学）</title>
    <link href="https://blog.kahvia.cn/2022/09/09/AutoConnectCTGUweb.html"/>
    <id>https://blog.kahvia.cn/2022/09/09/AutoConnectCTGUweb.html</id>
    <published>2022-09-09T13:01:53.974Z</published>
    <updated>2022-10-24T04:13:32.974Z</updated>
    
    <content type="html"><![CDATA[<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>一切参数内容由抓包获得。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 三大校园网登录地址</span></span><br><span class="line">url = <span class="string">&#x27;http://10.170.1.2:9090/zportal/login/do&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 三大校园网是表单提交</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="comment">#校园网账号</span></span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&#x27;xxxxxxxxxx&#x27;</span>,</span><br><span class="line">    <span class="comment">#密码</span></span><br><span class="line">    <span class="string">&quot;pwd&quot;</span>: <span class="string">&#x27;xxxxxx&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;validCode&quot;</span>: <span class="string">&quot;验证码&quot;</span>,</span><br><span class="line">    <span class="string">&quot;validCodeFlag&quot;</span>: <span class="string">&quot;false&quot;</span>,</span><br><span class="line">    <span class="comment"># &quot;ssid&quot;: &quot;c24e36c874328833576d4435928a84c5&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;mac&quot;: &quot;c087135cd61a85a7cf6c99c7315776e0&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;t&quot;: &quot;wireless-v2&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;wlanacname&quot;: &quot;b0e16546b46125bff4a79cfb309fda7f&quot;,</span></span><br><span class="line">    <span class="comment"># &quot;url&quot;: &quot;416bc8fc444bf6a0acf42dbf654ac97bb8da2acbab589e29d1bbccb6c3dd8740a89fd1d25528f66848d484798c2c5e4b&quot;,</span></span><br><span class="line">    <span class="string">&quot;nasip&quot;</span>: <span class="string">&quot;aa97548fee0077ad407c5fe8d3a7645b&quot;</span>,</span><br><span class="line">    <span class="comment"># nasip是web认证接入设备,不可省略</span></span><br><span class="line">    <span class="string">&quot;wlanuserip&quot;</span>: <span class="string">&quot;48d7f194ecf5eec0d07b001069ded8e7&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 请求登录的请求头</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Length&quot;</span>: <span class="string">&quot;461&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;10.170.1.2:9090&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://10.170.1.2:9090&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://10.170.1.2:9090/zportal/loginForWeb?wlanuserip=48d7f194ecf5eec0d07b001069ded8e7&amp;wlanacname=b0e16546b46125bff4a79cfb309fda7f&amp;ssid=c24e36c874328833576d4435928a84c5&amp;nasip=aa97548fee0077ad407c5fe8d3a7645b&amp;snmpagentip=&amp;mac=c087135cd61a85a7cf6c99c7315776e0&amp;t=wireless-v2&amp;url=416bc8fc444bf6a0acf42dbf654ac97bb8da2acbab589e29d1bbccb6c3dd8740a89fd1d25528f66848d484798c2c5e4b&amp;apmac=&amp;nasid=b0e16546b46125bff4a79cfb309fda7f&amp;vid=b02b05371bcbc4cb&amp;port=3f21ae5e15ce190e&amp;nasportid=b9d2866090de456862a975341d6574397ab2778f3751241f5ea58c9d8660fa0d52aff7761e572a00&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">    <span class="string">&quot;X-Requested-With&quot;</span>: <span class="string">&quot;XMLHttpRequest&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 查看结果</span></span><br><span class="line">response = requests.post(url, data, headers=header)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;请求结果:&quot;</span>, response.text)</span><br></pre></td></tr></table></figure><blockquote><p>参考博客：<a href="https://blog.csdn.net/winter2121/article/details/122633696">开机自动登录校园网（西安电子科技大学）</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;代码实现&quot;&gt;&lt;a href=&quot;#代码实现&quot; class=&quot;headerlink&quot; title=&quot;代码实现&quot;&gt;&lt;/a&gt;代码实现&lt;/h3&gt;&lt;p&gt;一切参数内容由抓包获得。&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;</summary>
      
    
    
    
    <category term="小工具" scheme="https://blog.kahvia.cn/categories/%E5%B0%8F%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="Python" scheme="https://blog.kahvia.cn/tags/Python/"/>
    
  </entry>
  
</feed>
